* Advent of Code 2021
** day 1
#+NAME: day1-input
#+BEGIN_SRC emacs-lisp :session "day1"
(defconst advent/day1input '(119 121 129 128 130 134 138 143 113 114
      129 103 90 98 91 96 101 90 73 66 74 82 80 91 92 93 96 101
      102 115 122 114 119 120 108 104 109 135 123 133 134 133 138
      144 151 158 159 162 166 146 137 124 153 150 153 162 169 167
      169 168 162 165 138 112 111 121 122 123 130 127 135 138 136
      138 141 139 144 169 174 180 183 207 210 227 224 235 239 228
      232 231 238 250 260 262 264 267 276 277 283 284 285 283 280
      260 259 261 260 263 270 275 278 281 282 287 286 285 286 290
      298 299 291 294 295 305 310 313 287 271 272 274 276 275 290
      307 305 307 312 314 313 315 323 319 332 333 334 335 352 353
      358 359 362 352 377 374 383 391 395 397 391 399 400 402 406
      413 414 417 412 421 422 420 421 418 383 387 388 395 397 398
      401 403 415 416 419 447 449 451 467 468 479 484 487 494 519
      546 566 570 582 586 587 611 613 647 641 640 663 670 671 681
      682 683 685 688 664 676 677 678 702 703 724 734 739 742 768
      771 774 784 792 787 764 773 783 790 787 788 798 797 796 802
      810 837 839 840 841 842 845 852 853 856 855 858 862 868 869
      868 852 851 852 856 857 869 883 884 886 893 896 904 905 939
      938 945 953 962 957 956 959 961 962 963 954 960 961 965 966
      967 958 959 957 960 967 968 971 972 983 994 991 1007 1022
      1034 1043 1038 1039 1028 1034 1036 1037 1039 1049 1028 1049
      1050 1052 1053 1054 1059 1060 1066 1078 1075 1083 1084 1077
      1075 1105 1108 1111 1113 1114 1127 1124 1127 1131 1138 1128
      1123 1109 1108 1112 1116 1117 1139 1145 1152 1133 1134 1133
      1147 1148 1143 1142 1157 1163 1164 1160 1162 1167 1152 1157
      1180 1182 1187 1188 1190 1201 1196 1199 1192 1203 1207 1212
      1213 1230 1231 1233 1237 1239 1245 1241 1239 1246 1249 1247
      1251 1271 1269 1273 1281 1282 1286 1287 1288 1290 1292 1294
      1291 1289 1298 1300 1301 1289 1286 1284 1288 1290 1293 1297
      1299 1294 1298 1301 1288 1294 1305 1291 1312 1310 1309 1310
      1307 1309 1310 1312 1313 1317 1316 1301 1304 1337 1342 1341
      1346 1347 1352 1353 1340 1345 1362 1354 1364 1367 1370 1366
      1368 1369 1370 1371 1372 1368 1380 1384 1386 1406 1407 1413
      1414 1417 1418 1396 1395 1401 1398 1408 1415 1403 1402 1394
      1380 1388 1391 1398 1396 1399 1397 1402 1410 1436 1438 1443
      1449 1450 1470 1451 1448 1439 1440 1437 1439 1445 1447 1448
      1449 1456 1460 1466 1495 1497 1506 1530 1519 1521 1523 1522
      1509 1526 1537 1539 1540 1542 1540 1538 1543 1546 1522 1523
      1540 1536 1548 1550 1554 1559 1575 1576 1556 1567 1566 1583
      1575 1579 1578 1561 1564 1562 1560 1577 1591 1592 1612 1603
      1607 1600 1613 1620 1621 1620 1625 1624 1623 1642 1647 1651
      1655 1657 1662 1669 1692 1683 1690 1684 1686 1689 1683 1711
      1709 1712 1714 1715 1710 1711 1702 1703 1719 1720 1722 1734
      1748 1749 1752 1754 1760 1758 1760 1763 1780 1788 1791 1802
      1795 1793 1795 1798 1801 1788 1815 1816 1825 1850 1858 1859
      1858 1859 1860 1862 1864 1868 1865 1866 1867 1869 1876 1875
      1872 1877 1897 1911 1909 1912 1911 1913 1914 1915 1913 1910
      1912 1903 1906 1909 1912 1915 1914 1921 1940 1938 1940 1941
      1954 1955 1959 1980 1999 2000 2007 2014 2038 2036 2042 2045
      2053 2065 2066 2087 2079 2099 2091 2092 2095 2094 2096 2108
      2113 2126 2148 2164 2168 2173 2177 2185 2189 2181 2182 2172
      2171 2170 2177 2178 2180 2193 2194 2200 2181 2169 2178 2179
      2193 2195 2198 2222 2225 2214 2213 2214 2196 2224 2240 2245
      2244 2273 2274 2276 2277 2266 2261 2262 2259 2262 2263 2271
      2272 2273 2277 2276 2256 2255 2251 2253 2240 2246 2256 2257
      2298 2299 2294 2295 2300 2299 2312 2308 2318 2320 2324 2321
      2336 2352 2351 2358 2360 2337 2343 2356 2354 2344 2340 2348
      2343 2349 2350 2362 2363 2381 2380 2382 2383 2385 2395 2372
      2368 2363 2362 2363 2364 2372 2391 2382 2360 2362 2363 2389
      2393 2401 2400 2410 2404 2403 2402 2416 2424 2420 2415 2440
      2454 2457 2456 2446 2448 2453 2460 2463 2472 2473 2474 2475
      2474 2471 2472 2481 2503 2475 2477 2485 2491 2506 2507 2504
      2506 2518 2508 2507 2521 2524 2511 2533 2545 2555 2563 2564
      2567 2558 2561 2588 2568 2566 2575 2590 2588 2589 2598 2590
      2601 2607 2606 2616 2624 2615 2621 2628 2627 2634 2650 2667
      2671 2686 2687 2692 2712 2716 2717 2715 2717 2718 2720 2721
      2738 2733 2730 2734 2742 2747 2748 2755 2767 2761 2778 2772
      2773 2780 2783 2784 2779 2790 2782 2787 2786 2793 2797 2806
      2807 2809 2808 2809 2810 2811 2807 2808 2804 2815 2848 2850
      2867 2849 2872 2873 2874 2883 2885 2894 2895 2914 2917 2910
      2895 2896 2899 2877 2883 2880 2890 2918 2921 2923 2928 2926
      2925 2932 2919 2921 2928 2929 2935 2936 2918 2921 2935 2937
      2946 2948 2936 2934 2949 2944 2940 2941 2945 2985 2986 2987
      2990 3001 3008 3010 3021 3023 3022 3025 3029 3030 3033 3012
      3020 3008 3011 3006 2999 2998 3007 3008 3009 3010 3012 3018
      3025 3050 3049 3063 3068 3064 3070 3071 3069 3076 3082 3095
      3103 3105 3107 3108 3113 3110 3111 3102 3103 3107 3140 3164
      3162 3163 3166 3168 3164 3163 3173 3190 3195 3196 3202 3204
      3218 3228 3227 3247 3249 3251 3260 3247 3258 3265 3266 3290
      3306 3298 3301 3302 3303 3289 3302 3298 3299 3302 3300 3289
      3288 3285 3286 3320 3329 3338 3328 3324 3334 3329 3333 3334
      3336 3338 3341 3324 3331 3329 3330 3347 3373 3380 3383 3382
      3385 3372 3379 3369 3370 3381 3390 3391 3392 3393 3402 3414
      3435 3459 3454 3456 3453 3460 3472 3473 3472 3473 3482 3483
      3486 3495 3521 3534 3535 3536 3539 3573 3568 3575 3571 3573
      3588 3575 3576 3578 3579 3577 3582 3603 3606 3607 3609 3622
      3629 3648 3656 3655 3658 3657 3644 3643 3610 3605 3606 3607
      3609 3607 3580 3571 3570 3573 3580 3581 3563 3566 3575 3567
      3566 3568 3570 3572 3590 3584 3578 3572 3571 3576 3571 3578
      3545 3534 3543 3549 3551 3556 3557 3571 3576 3565 3563 3562
      3568 3569 3571 3572 3573 3574 3576 3577 3584 3564 3577 3583
      3584 3593 3599 3610 3613 3622 3635 3639 3646 3643 3606 3599
      3602 3604 3617 3618 3626 3647 3635 3655 3657 3658 3657 3656
      3655 3648 3650 3651 3655 3659 3661 3671 3665 3668 3674 3671
      3667 3668 3665 3667 3665 3667 3669 3668 3677 3683 3684 3689
      3709 3717 3711 3710 3713 3721 3736 3734 3736 3740 3746 3754
      3753 3754 3768 3796 3780 3762 3765 3767 3773 3800 3806 3823
      3827 3828 3841 3848 3850 3853 3855 3845 3847 3854 3864 3849
      3857 3841 3850 3851 3856 3854 3861 3858 3861 3871 3878 3887
      3881 3882 3883 3885 3882 3885 3900 3905 3903 3906 3910 3940
      3925 3926 3950 3951 3952 3954 3965 3962 3963 3957 3944 3953
      3957 3964 3965 3973 3983 3989 3991 4010 4009 3997 3999 4006
      4008 4009 4010 4006 4018 4020 4028 4003 4004 4013 4018 4024
      4037 4039 4036 4041 4040 4036 4038 4039 4040 4044 4045 4075
      4092 4088 4086 4083 4086 4087 4096 4088 4089 4080 4085 4088
      4087 4090 4088 4094 4107 4106 4107 4115 4121 4136 4153 4161
      4163 4170 4173 4169 4172 4174 4180 4166 4183 4188 4198 4207
      4220 4221 4225 4242 4224 4228 4226 4227 4225 4233 4242 4252
      4249 4250 4215 4216 4217 4236 4245 4246 4248 4249 4250 4251
      4254 4252 4254 4257 4268 4272 4273 4278 4282 4290 4298 4303
      4307 4285 4286 4290 4289 4283 4285 4286 4313 4322 4327 4329
      4330 4333 4335 4334 4309 4314 4316 4320 4335 4339 4348 4347
      4362 4358 4361 4350 4349 4356 4358 4359 4370 4383 4387 4378
      4383 4380 4379 4395 4387 4394 4381 4385 4386 4390 4389 4394
      4396 4410 4412 4407 4408 4416 4417 4421 4428 4423 4420 4422
      4421 4425 4426 4423 4437 4438 4440 4441 4446 4451 4456 4451
      4455 4470 4493 4494 4486 4489 4500 4501 4485 4496 4499 4505
      4507 4500 4516 4518 4535 4532 4544 4541 4562 4564 4550 4551
      4553 4584 4588 4598 4599 4608 4623 4621 4628 4650 4655 4657
      4658 4653 4658 4670 4685 4686 4714 4708 4709 4710 4718 4720
      4719 4738 4730 4719 4722 4736 4737 4739 4750 4751 4754 4755
      4758 4759 4764 4767 4774 4770 4768 4773 4760 4763 4762 4764
      4765 4767 4778 4777 4795 4792 4793 4796 4797 4800 4779 4782
      4794 4795 4785 4786 4788 4789 4798 4800 4802 4803 4814 4831
      4830 4849 4852 4854 4860 4861 4860 4862 4860 4834 4835 4858
      4859 4863 4864 4873 4874 4875 4880 4881 4882 4902 4899 4900
      4904 4903 4900 4916 4917 4921 4924 4910 4917 4918 4919 4920
      4910 4913 4932 4941 4959 4976 4978 5000 4999 4982 4973 4977
      5002 5000 5001 5000 5003 5004 5005 5015 5004 4994 4992 4982
      4991 4993 4996 4994 5000 5004 5013 5038 5054 5062 5051 5054
      5044 5020 5008 5030 5033 5007 5004 5005 5012 5022 5032 5035
      5040 5042 5059 5058 5088 5096 5099 5107 5126 5137 5134 5148
      5151 5150 5152 5158 5163 5167 5166 5150 5149 5132 5136 5149
      5150 5157 5145 5165 5163 5171 5168 5177 5174 5142 5145 5160
      5180 5202 5222 5226 5239 5240 5261 5262 5263 5274 5276 5277
      5285 5286 5284 5296 5324 5303 5313 5314 5324 5339 5340 5343
      5344 5343 5344 5356 5345 5344 5345 5343 5350 5353 5355 5358
      5359 5363 5364 5368 5370 5397 5398 5393 5394 5395 5401 5408
      5417 5418 5419 5422 5424 5430 5433 5435 5439 5447 5449 5448
      5466 5457 5461 5473 5477 5478 5480 5481 5480 5498 5511 5536
      5543 5544 5556 5557 5594 5601 5582 5583 5584 5593 5611 5614
      5613 5626 5624 5614 5610 5611 5605 5608 5609 5611 5632 5637
      5639 5667 5682 5685 5686 5687 5688 5690 5670 5673 5674 5680
      5673 5674 5694 5704 5698 5702 5703 5696 5697 5695 5728 5733
      5735 5739 5727 5728 5732 5733 5732 5741 5754 5755 5757 5733
      5734 5735 5737 5738 5750 5773 5775 5787 5800 5818 5819 5820
      5826 5830 5831 5833 5841 5832 5835 5839 5840 5835 5836 5841
      5838 5841 5837 5843 5842 5837 5843 5845 5846 5884 5888 5891
      5893 5924 5934 5939 5940 5907 5888 5889 5892 5893 5884 5898
      5900 5901 5884 5893 5894 5895 5909 5911 5915 5918 5922 5931
      5935 5939 5934 5944 5943 5965 5967 5970 5971 5941 5942 5943
      5942 5943 5946 5945 5923 5918 5921 5931 5940 5915 5931 5930
      5937 5909 5908 5911 5909 5912 5911 5912 5910 5921 5929 5931
      5929 5925 5907 5909 5910 5913 5910 5908 5921 5927 5943 5941
      5971 5972 5977 5979 5984 6002 6007 6009 6010 6011 6026 6034
      6027 6026 6035 6033 6032 6033 6034 6040 6042 6045 6044 6052
      6053 6043 6036 6024 6026 6033 6034 6037 6040 6048 6069 6072
      6076 6074 6081 6080 6078 6089 6092 6090 6091 6096 6107 6109
      6108 6113 6138 6120 6122 6112 6122 6119 6129 6123 6124 6135
      6136 6157 6159 6161 6162 6161 6179 6180 6187 6188 6189 6193
      6196 6195 6192 6195 6197 6196 6197 6199 6200 6198 6214 6216
      6217 6218 6217 6236 6239 6209 6214 6208 6210 6212 6217))

(defconst advent/day1test '(199 200 208 210 200 207 240 269 260 263))
#+END_SRC

#+NAME: day1-solution
#+BEGIN_SRC emacs-lisp :session "day1"
(setq advent/day1result ())

(defun advent/find-ascending (list)
  "Find ascending elements.
Find in LIST how many elements are larger from their previous
element."
  (let ((value 0))
    (while list
      (if (> (length list) 1)
          (if (< (car list) (cadr list))
              (setq value (+ 1 value))
            )
        )
      (setq list (cdr list)))
    value))

(advent/find-ascending advent/day1test) ;; correct 7

(setq advent/day1result
      (cons (advent/find-ascending advent/day1input) advent/day1result))

(defun advent/find-sum-ascending (list)
  "Find ascending sums.
Find in LIST how many times a three element window sum is
larger than the previous one."
  (let ((value 0))
    (while (> (length list) 3)
      (if (< (+ (car list) (cadr list) (caddr list))
             (+ (cadr list) (caddr list) (cadddr list)))
          (setq value (+ 1 value)))
      (setq list (cdr list)))
    value))

(advent/find-sum-ascending advent/day1test) ;; correct 5

(setq advent/day1result
      (reverse
       (cons (advent/find-sum-ascending advent/day1input) advent/day1result)))

advent/day1result
#+END_SRC

#+RESULTS: day1-solution
: [24000 71506 45000 209603]
** day 2
#+NAME: day2-input
#+BEGIN_SRC emacs-lisp :session "day2"
(defconst advent/day2-input '("forward" 2 "down" 9 "up" 6 "forward" 1 "down" 5
"down" 7 "down" 9 "forward" 9 "down" 8 "up" 7 "forward" 2 "up" 6 "forward" 4 "down"
5 "down" 9 "up" 1 "down" 9 "forward" 8 "forward" 6 "forward" 6 "forward" 5
"forward" 9 "up" 3 "up" 5 "forward" 1 "down" 4 "down" 7 "forward" 2 "up" 3 "down" 8
"forward" 1 "down" 2 "forward" 3 "up" 1 "up" 1 "up" 7 "forward" 5 "up" 8 "forward"
8 "forward" 8 "down" 6 "forward" 1 "forward" 5 "forward" 4 "forward" 6
"forward" 5 "down" 6 "down" 9 "forward" 9 "down" 8 "forward" 6 "down" 5 "forward"
9 "up" 3 "up" 1 "down" 8 "down" 7 "down" 9 "forward" 7 "down" 8 "down" 9 "down" 5
"down" 3 "forward" 1 "forward" 6 "down" 1 "forward" 9 "down" 5 "forward" 7 "up" 2
"down" 8 "forward" 1 "down" 4 "down" 9 "down" 4 "up" 5 "forward" 4 "forward" 6
"forward" 1 "down" 3 "forward" 1 "down" 6 "up" 5 "up" 4 "forward" 6 "forward" 1
"forward" 1 "down" 2 "up" 4 "up" 3 "up" 2 "up" 6 "down" 6 "forward" 1 "down" 8
"forward" 1 "up" 6 "forward" 7 "down" 5 "forward" 4 "forward" 6 "down" 4
"forward" 4 "down" 4 "down" 4 "forward" 2 "forward" 8 "down" 5 "down" 1 "down" 8
"up" 5 "up" 8 "down" 5 "forward" 4 "down" 6 "up" 7 "forward" 2 "down" 3 "forward" 2
"forward" 2 "down" 9 "down" 3 "up" 6 "forward" 8 "up" 2 "up" 9 "forward" 4 "down" 1
"down" 5 "forward" 4 "down" 2 "down" 3 "forward" 5 "down" 4 "forward" 7 "up" 4
"forward" 6 "up" 8 "forward" 1 "up" 9 "down" 4 "forward" 2 "down" 1 "forward" 7
"down" 3 "down" 2 "forward" 5 "down" 3 "down" 9 "down" 9 "up" 5 "forward" 2 "down"
8 "up" 9 "forward" 4 "down" 3 "forward" 3 "forward" 6 "up" 2 "forward" 3 "down" 1
"down" 1 "down" 1 "forward" 7 "forward" 4 "forward" 7 "down" 5 "down" 6 "down" 2
"forward" 6 "down" 3 "up" 6 "forward" 4 "down" 8 "up" 1 "forward" 8 "down" 2 "down"
5 "forward" 4 "down" 9 "forward" 2 "forward" 2 "down" 3 "forward" 3 "down" 1
"forward" 2 "down" 7 "forward" 3 "forward" 9 "up" 9 "forward" 6 "forward" 2
"down" 1 "down" 5 "forward" 6 "forward" 6 "down" 3 "up" 3 "forward" 9 "down" 7
"down" 2 "down" 4 "down" 7 "forward" 5 "up" 4 "forward" 8 "down" 5 "forward" 7
"down" 7 "up" 7 "down" 8 "forward" 9 "up" 5 "forward" 1 "down" 2 "forward" 5 "down"
9 "forward" 3 "down" 5 "forward" 8 "forward" 3 "up" 5 "down" 2 "up" 3 "forward" 2
"up" 1 "up" 5 "down" 8 "forward" 2 "down" 5 "up" 4 "up" 5 "up" 2 "forward" 9
"forward" 6 "down" 9 "up" 9 "forward" 6 "forward" 4 "forward" 3 "forward" 7 "up"
1 "down" 2 "down" 6 "down" 1 "forward" 8 "down" 1 "forward" 6 "down" 8 "forward"
8 "down" 7 "down" 6 "down" 5 "forward" 2 "up" 8 "up" 6 "up" 5 "down" 1 "forward" 1
"down" 1 "down" 5 "forward" 7 "forward" 3 "down" 1 "forward" 5 "forward" 5
"forward" 8 "down" 1 "up" 2 "down" 6 "up" 6 "forward" 6 "forward" 6 "down" 3
"forward" 9 "up" 4 "forward" 4 "down" 6 "up" 1 "forward" 6 "down" 2 "down" 5 "down"
2 "down" 6 "up" 5 "down" 1 "down" 1 "forward" 3 "forward" 7 "forward" 3 "up" 2
"down" 8 "down" 4 "down" 1 "down" 5 "down" 1 "down" 9 "forward" 6 "down" 6 "down" 4
"down" 6 "down" 8 "forward" 4 "down" 6 "down" 7 "forward" 8 "down" 4 "up" 4 "down"
1 "forward" 1 "forward" 4 "forward" 1 "up" 9 "down" 7 "forward" 7 "down" 4
"forward" 1 "up" 4 "forward" 4 "down" 5 "down" 7 "forward" 5 "forward" 7
"forward" 1 "forward" 1 "forward" 9 "forward" 9 "up" 3 "forward" 4 "down" 2
"forward" 9 "up" 8 "forward" 3 "up" 5 "down" 3 "down" 8 "forward" 8 "down" 6
"forward" 1 "down" 6 "down" 6 "up" 9 "down" 2 "forward" 8 "up" 9 "down" 7 "up" 9 "up"
8 "up" 1 "forward" 6 "forward" 9 "down" 2 "forward" 8 "down" 1 "up" 4 "forward" 4
"forward" 7 "up" 2 "forward" 4 "down" 5 "forward" 3 "down" 2 "down" 7 "down" 4
"down" 2 "up" 5 "down" 5 "down" 5 "down" 4 "up" 1 "forward" 7 "down" 6 "forward" 5
"forward" 1 "down" 4 "up" 9 "down" 5 "forward" 7 "forward" 5 "down" 6 "down" 3
"down" 9 "down" 1 "forward" 6 "up" 2 "down" 7 "down" 3 "down" 6 "up" 3 "down" 4
"down" 4 "forward" 9 "down" 3 "forward" 2 "down" 9 "down" 8 "up" 4 "down" 2
"forward" 2 "down" 5 "down" 4 "down" 4 "down" 2 "forward" 6 "down" 3 "forward" 1
"down" 4 "forward" 7 "down" 5 "up" 4 "down" 6 "forward" 8 "down" 6 "forward" 2
"forward" 4 "forward" 5 "forward" 7 "forward" 4 "forward" 5 "down" 8 "down" 7
"forward" 3 "forward" 5 "up" 7 "forward" 1 "down" 4 "forward" 5 "forward" 4
"forward" 4 "down" 5 "down" 8 "forward" 8 "down" 1 "down" 1 "down" 5 "up" 5
"forward" 6 "down" 6 "forward" 3 "forward" 4 "forward" 7 "forward" 4 "down" 8
"forward" 2 "down" 4 "forward" 4 "down" 1 "up" 2 "forward" 6 "up" 1 "down" 7 "down"
9 "forward" 7 "forward" 2 "up" 3 "down" 2 "down" 9 "down" 5 "up" 7 "forward" 1
"forward" 8 "down" 8 "up" 3 "down" 3 "forward" 9 "up" 4 "down" 5 "up" 5 "down" 1 "up"
8 "forward" 9 "down" 3 "up" 6 "forward" 6 "forward" 1 "down" 1 "forward" 9 "down"
8 "forward" 8 "down" 6 "up" 9 "down" 4 "up" 3 "up" 9 "forward" 2 "down" 2 "down" 2
"forward" 3 "down" 2 "forward" 5 "forward" 4 "up" 8 "forward" 9 "up" 7 "forward"
2 "down" 5 "down" 6 "forward" 8 "up" 7 "forward" 4 "forward" 3 "up" 5 "down" 8
"forward" 3 "up" 2 "down" 3 "forward" 6 "down" 9 "down" 2 "down" 6 "down" 2
"forward" 7 "forward" 5 "forward" 7 "down" 8 "forward" 2 "down" 2 "forward" 8
"up" 8 "forward" 4 "forward" 3 "up" 5 "down" 3 "forward" 3 "up" 8 "up" 7 "down" 4
"down" 1 "forward" 2 "down" 1 "up" 6 "up" 4 "down" 3 "up" 1 "forward" 7 "forward" 7
"forward" 7 "forward" 8 "down" 1 "forward" 5 "down" 6 "forward" 9 "forward" 7
"forward" 7 "down" 4 "up" 4 "down" 6 "down" 9 "up" 4 "up" 2 "up" 6 "forward" 4 "up" 4
"up" 6 "down" 2 "forward" 4 "down" 9 "forward" 9 "forward" 9 "down" 1 "forward" 7
"down" 2 "down" 7 "down" 8 "down" 8 "down" 9 "up" 9 "down" 5 "forward" 5 "forward"
7 "forward" 4 "down" 7 "forward" 8 "forward" 1 "down" 8 "up" 9 "down" 7 "forward"
9 "forward" 4 "forward" 8 "down" 9 "forward" 4 "down" 3 "forward" 3 "down" 1
"down" 1 "down" 2 "up" 5 "down" 2 "down" 1 "down" 8 "forward" 3 "up" 2 "forward" 7
"down" 3 "down" 8 "down" 1 "forward" 4 "forward" 7 "down" 5 "forward" 6 "down" 6
"down" 2 "forward" 6 "down" 3 "up" 4 "down" 7 "forward" 7 "up" 1 "up" 9 "down" 1
"down" 2 "down" 8 "down" 7 "up" 1 "forward" 7 "down" 2 "forward" 4 "forward" 6
"forward" 9 "down" 6 "forward" 2 "up" 8 "down" 2 "up" 2 "up" 5 "down" 8 "up" 6 "down"
9 "forward" 6 "down" 8 "down" 6 "down" 1 "up" 7 "up" 6 "down" 8 "forward" 2 "up" 7
"forward" 5 "forward" 7 "forward" 7 "up" 5 "forward" 2 "down" 9 "up" 2 "up" 8 "up"
2 "down" 3 "down" 7 "forward" 9 "down" 3 "up" 9 "forward" 8 "up" 8 "forward" 4
"forward" 8 "forward" 6 "up" 1 "down" 3 "up" 1 "down" 1 "forward" 2 "forward" 1
"forward" 4 "forward" 7 "up" 8 "down" 9 "up" 2 "down" 7 "forward" 4 "down" 3
"forward" 4 "forward" 2 "down" 9 "forward" 8 "forward" 5 "forward" 3 "down" 6
"forward" 4 "forward" 4 "forward" 9 "forward" 4 "up" 5 "down" 7 "up" 6 "forward"
5 "down" 5 "forward" 4 "down" 5 "forward" 7 "forward" 3 "forward" 5 "down" 5
"forward" 4 "down" 5 "up" 4 "down" 8 "up" 3 "down" 3 "up" 5 "forward" 4 "forward" 5
"down" 6 "forward" 6 "forward" 1 "forward" 8 "down" 6 "down" 9 "up" 5 "forward" 2
"forward" 8 "up" 6 "down" 6 "forward" 2 "down" 8 "forward" 7 "forward" 7 "down" 5
"forward" 5 "forward" 8 "forward" 1 "down" 4 "down" 2 "down" 5 "up" 4 "forward" 3
"forward" 5 "down" 4 "down" 7 "down" 4 "up" 9 "up" 6 "forward" 1 "down" 8 "up" 8 "up"
9 "forward" 2 "forward" 1 "down" 6 "forward" 6 "down" 4 "forward" 7 "up" 2 "up" 1
"forward" 4 "down" 1 "forward" 8 "forward" 3 "up" 7 "up" 5 "down" 1 "forward" 8
"forward" 6 "up" 6 "forward" 9 "down" 5 "down" 9 "forward" 2 "down" 3 "up" 1 "up" 7
"down" 1 "forward" 8 "up" 9 "down" 1 "down" 5 "down" 7 "down" 5 "down" 5 "down" 5
"up" 9 "forward" 9 "forward" 7 "forward" 4 "forward" 6 "down" 5 "down" 3
"forward" 9 "forward" 1 "down" 1 "down" 8 "up" 4 "down" 9 "forward" 9 "up" 1 "down"
5 "forward" 8 "up" 6 "forward" 3 "down" 6 "up" 8 "down" 7 "forward" 3 "forward" 6
"down" 7 "forward" 6 "forward" 4 "forward" 4 "down" 4 "forward" 6 "forward" 5
"down" 6 "forward" 6 "down" 7 "forward" 6 "forward" 3 "up" 4 "up" 2 "up" 6 "down" 2
"down" 8 "forward" 5 "forward" 1 "up" 4 "forward" 7 "forward" 9 "up" 6 "down" 7
"down" 3 "up" 5 "forward" 5 "down" 8 "up" 1 "down" 1 "down" 3 "down" 2 "down" 1
"forward" 5 "down" 3 "down" 5 "forward" 7 "forward" 9 "down" 3 "forward" 7
"forward" 5 "forward" 4 "forward" 2 "forward" 7 "forward" 8 "forward" 6 "down"
8 "forward" 5 "forward" 6 "forward" 6 "down" 8 "down" 2 "forward" 4 "down" 7
"forward" 6 "down" 7 "down" 4 "forward" 6 "up" 6 "forward" 4 "forward" 9
"forward" 2 "forward" 3 "forward" 1 "down" 8 "down" 3 "forward" 4 "up" 3
"forward" 7 "forward" 1 "down" 7 "down" 8 "forward" 1 "up" 8 "forward" 8 "up" 8
"down" 5 "forward" 6 "down" 8 "down" 4 "down" 9 "up" 1 "down" 3 "forward" 6 "down"
6 "forward" 7 "forward" 3 "down" 6 "down" 6 "forward" 4 "down" 4 "down" 1 "down"
8 "forward" 2 "forward" 8 "forward" 8 "down" 6 "forward" 9 "down" 9 "down" 5
"down" 5 "forward" 7 "down" 1 "forward" 1 "down" 1 "down" 6 "down" 1 "forward" 1
"up" 6 "up" 9 "forward" 5 "down" 6 "forward" 8 "forward" 6 "down" 7 "forward" 1
"forward" 4 "forward" 9 "forward" 2 "forward" 4 "down" 2 "forward" 1 "forward"
8 "down" 1 "down" 1 "forward" 4 "down" 5 "down" 3 "down" 9 "down" 2 "up" 8 "down" 7
"down" 1 "down" 9 "forward" 2 "forward" 2 "up" 3 "forward" 3 "down" 3 "forward" 5
"forward" 9 "down" 7 "up" 7 "down" 9 "forward" 3 "forward" 7 "down" 1 "forward" 8
"down" 8 "forward" 1 "down" 8 "down" 6 "forward" 2 "down" 3 "down" 1 "down" 8
"forward" 3 "up" 5 "down" 7 "up" 2 "up" 8 "forward" 5 "up" 7 "down" 6 "up" 7 "down" 9
"forward" 5 "up" 4 "forward" 9 "down" 5 "up" 7 "down" 2 "up" 2 "up" 7 "forward" 5
"down" 6 "forward" 4 "down" 4 "down" 3 "forward" 2 "up" 2 "down" 5 "forward" 8
"down" 3 "up" 7 "down" 1 "down" 7 "forward" 7 "forward"
4 "forward" 7 "down" 2
"down" 9 "down" 6 "down" 9 "down" 2 "down" 9 "down" 7 "down" 5 "forward" 4 "up" 5
"up" 7 "forward" 2 "forward" 7 "down" 3 "down" 3 "forward" 4))

(defconst advent/day2-test '("forward" 5 "down" 5 "forward" 8 "up"
3 "down" 8 "forward" 2))
#+END_SRC

#+NAME: day2-solution
#+BEGIN_SRC emacs-lisp :session "day2"
(defun advent/find-position (list)
  "Find submarine position with instructions from LIST."
  (let ((position 0)
        (depth 0)
        instruction
        value)
    (while list
      (setq instruction (pop list))
      (setq value (pop list))
      (cond
       ((equal instruction "forward")
        (setq position (+ position value)))
       ((equal instruction "down")
        (setq depth (+ depth value)))
       ((equal instruction "up")
        (setq depth (- depth value)))
       )
      )
    (* position depth)))

(advent/find-position advent/day2-test) ;; -> 150 OK

(defun advent/find-position-aim (list)
  "Find submarine position with instructions from LIST.
Now it takes into account the aim of the submarine."
  (let ((position 0)
        (depth 0)
        (aim 0))
    (while list
      (setq instruction (pop list))
      (setq value (pop list))
      (cond
       ((equal instruction "forward")
        (setq position (+ position value))
        (setq depth (+ depth (* aim value))))
       ((equal instruction "down")
        (setq aim (+ aim value)))
       ((equal instruction "up")
        (setq aim (- aim value)))
       )
      )
    (* position depth)))

(advent/find-position-aim advent/day2-test) ;; -> 900 OK

(list (advent/find-position advent/day2-input)
      (advent/find-position-aim advent/day2-input))
#+END_SRC

#+RESULTS: day2-solution
: [15 12740 12 11980]
** day 3
#+NAME: day3-input
#+BEGIN_SRC emacs-lisp :session day3
  (defconst advent/day3-input '( "011110011110" "101101001111"
  "000000010101" "100111001010" "110000011010" "011101010101"
  "011110001100" "010111111001" "111011100101" "011110000110"
  "010100001111" "000001001100" "110001001000" "001000100101"
  "010100011110" "010111011110" "110101001111" "011010111011"
  "000011010101" "100111011100" "010010100011" "010010011001"
  "000111010011" "111001000111" "100101111111" "011001101110"
  "110010101100" "001000010001" "110101100011" "101110001011"
  "010100000110" "001110011110" "011101100110" "001111101101"
  "000101101000" "100110000111" "000001010100" "111100010110"
  "000100100100" "001000110001" "101000001011" "101000100110"
  "110000101010" "010111110000" "111110010110" "011011111111"
  "111010100000" "100001000111" "011000001010" "011000010001"
  "101101100001" "011001101011" "111001001010" "000010110101"
  "101110100010" "001111111101" "011110001001" "000111100011"
  "010101001001" "111110111111" "111000111010" "001001111100"
  "000011000001" "011100010110" "110010000111" "000010010101"
  "110000001110" "010011111011" "001010100100" "111001010101"
  "001101000011" "110100110011" "110010100101" "001000001011"
  "111110011000" "110111011011" "110110101001" "010010100100"
  "111100001100" "100100001100" "110001111010" "111011001011"
  "010000010001" "110010100000" "010100011100" "000110001001"
  "010011000001" "111011010001" "010011111101" "111101110100"
  "110110101100" "010100111110" "100011001101" "000010000010"
  "011111100001" "100000101100" "100001110011" "100101100100"
  "000100001001" "101000000011" "110111101100" "100100101001"
  "001001101001" "000001010000" "001001111110" "111011111010"
  "001000011110" "110000100111" "010010010101" "011010001011"
  "100010010101" "010110101010" "011111001011" "110010011100"
  "111110101010" "000001111010" "111101110101" "101010110111"
  "100010101111" "000110101110" "000000010000" "000010100110"
  "111110010001" "000100110000" "110010011011" "101001000010"
  "010110000101" "100011100100" "110000110100" "110011000001"
  "101110001000" "010100011111" "111000100111" "110001100010"
  "100001101000" "101001000111" "111110100000" "000011000010"
  "110000000001" "111010000111" "100100111011" "101101110001"
  "111100110100" "100110010000" "001001001110" "100010001001"
  "101000110100" "011100001111" "001110100110" "110100001100"
  "101101001011" "000011111110" "101101010100" "000110110001"
  "011100011001" "111000111111" "011010101100" "111000100101"
  "100111011110" "011010100110" "110000101111" "110010000001"
  "100001110101" "110101011111" "111111000011" "101010010010"
  "000111111111" "000001001111" "101101010010" "111111001000"
  "001001110000" "110010011110" "110011001111" "100111101011"
  "011111000111" "110010111100" "010110000000" "110001100011"
  "111000100001" "011000101000" "100110001100" "001101011011"
  "011001111110" "011101000110" "110110111001" "110101001010"
  "111000111011" "100111010001" "100110000011" "010001000100"
  "001001001000" "010010001010" "010101101101" "001110001001"
  "101110011111" "010111001111" "110111001110" "100000101011"
  "010000111111" "101000101011" "101011010111" "000101110001"
  "100100010010" "100111011101" "111100000100" "100110000001"
  "000001000101" "101100001111" "100000101001" "010101010110"
  "000110010111" "011101001100" "000111111011" "000001100101"
  "100001011011" "111000101110" "111101100111" "011010010100"
  "101001001010" "110100110001" "111101011101" "000011101110"
  "011000100100" "101110000111" "011101110110" "111001010001"
  "011110000100" "011110001101" "100111100001" "010011100001"
  "001001101101" "001111111010" "010101000101" "011100000110"
  "100010001101" "011011101011" "110111001010" "101000010010"
  "111111100011" "000101111011" "001101010011" "100101000001"
  "101101100011" "101110010011" "011001100000" "110001111111"
  "011100101100" "010010001110" "111110101101" "010110001000"
  "000011000110" "101010011011" "000100111011" "001000111101"
  "010011111111" "011101100111" "111111011111" "001100000000"
  "101100001110" "101100001000" "100001011111" "100001000101"
  "000101011001" "010100111100" "110000111011" "010000111100"
  "011100110000" "101111110010" "100011110101" "100100110101"
  "100001100000" "101000100101" "111000001100" "010000001011"
  "110101010111" "011011001000" "100111000101" "011000000100"
  "110110011000" "101101101101" "100101110010" "001100001010"
  "010111000011" "111111100001" "100010111011" "110011001001"
  "000011011101" "001100101101" "010110011001" "111100110010"
  "011111001110" "100110001111" "000111101111" "011000110001"
  "001010001010" "000111010100" "010011110101" "011111000010"
  "000101000010" "111101011010" "110011111100" "100000001000"
  "100001000110" "101010100001" "000101000101" "100100011111"
  "110000101110" "000110000101" "001001011111" "100010011100"
  "000001110001" "110000010100" "011111010100" "001000001111"
  "000111000001" "110010001000" "001001111101" "111000001001"
  "001011000001" "111110010100" "110010001100" "010110110000"
  "011100100010" "011000101011" "001001000001" "011001001110"
  "111000010100" "000110000110" "011011000100" "011000010111"
  "110001011000" "010111011000" "000101110100" "000000011111"
  "001100111100" "000010100101" "000111110000" "000110000001"
  "000100101001" "101111110100" "010010000001" "001100010001"
  "101111001101" "111011111101" "000011110011" "111001011100"
  "010110110110" "000000001101" "010010000000" "000001010011"
  "101000010000" "101000001110" "010001000111" "111010011011"
  "101001111110" "000110101100" "100110101001" "100111111111"
  "101001101001" "110010010011" "011001011111" "111111110110"
  "101110010110" "100100001101" "010001111110" "111111101000"
  "100010100001" "011110010100" "101000110011" "010110110011"
  "011111001000" "100010100101" "110010010110" "111011001000"
  "101110001101" "000010110011" "001110100100" "100000011101"
  "011001100001" "011001101010" "001100011101" "000111101100"
  "001010001001" "111001101110" "110110001111" "001111001010"
  "001001000011" "001000010000" "000001111110" "000101101111"
  "001001000110" "100001101110" "101111011100" "111110010010"
  "010001100011" "101000100111" "001101000111" "111011110011"
  "000011000101" "111101001110" "110111111111" "011100010100"
  "110011110001" "001011011001" "000011010111" "011000001110"
  "000101010111" "110101110001" "001100001111" "110111010111"
  "110010010101" "100111100111" "101000000111" "101111000100"
  "100011100010" "000100100101" "111011110110" "001111100110"
  "011011000010" "100010010100" "010111110010" "100010110011"
  "111111111000" "011010101111" "101110111011" "101110101010"
  "001011001000" "110110001011" "110100101111" "001011001011"
  "110011010000" "000000100000" "100000110000" "101110011011"
  "100101101111" "010110100010" "000010100011" "000110110000"
  "111101000001" "011001010011" "000000001110" "000100110101"
  "111111111110" "001010101001" "001101100111" "010100000101"
  "000111001001" "101100101110" "011011110111" "011010000011"
  "000100101011" "100001100110" "000111011101" "000100011100"
  "000101100101" "011111111110" "111010111011" "100000100101"
  "011001011110" "010101100010" "010101111101" "100001000001"
  "001000100001" "010010111110" "100011001011" "011011000111"
  "110011010101" "111101100100" "001110001010" "110011111101"
  "111011011101" "001101000001" "101011011011" "100000111010"
  "010101110101" "000101011100" "011000011001" "111001010011"
  "100100010110" "111101010001" "110110011011" "011110110100"
  "101000110101" "101110111101" "011011011110" "000100110110"
  "100011011111" "111010101001" "011111011000" "101000101110"
  "110010111001" "111010000010" "110011011001" "110110010100"
  "111010011010" "000010110001" "011101100010" "110010110111"
  "010101001111" "011011001101" "101111000110" "010111010010"
  "101111011011" "100111101100" "001000001101" "010110100000"
  "001010100110" "111111000111" "100101000100" "100101001100"
  "110111010110" "101000101000" "100001001111" "110011110010"
  "111111101111" "110001111000" "010001110110" "101100000010"
  "000110000111" "001011100101" "101010100101" "110110001001"
  "000011011111" "110110101110" "101100110010" "101110101110"
  "101010110101" "000111000011" "101000011111" "001100000111"
  "101001111111" "100100011101" "111100011011" "000010111010"
  "111010101010" "101001010010" "101100010011" "010000110110"
  "011110110011" "001101110111" "110111110110" "001011000100"
  "101111100010" "011010011100" "110100001010" "100100110111"
  "000011010011" "000110111010" "001100100000" "100111011011"
  "001101101011" "101011101111" "001101100100" "111010010111"
  "100111111100" "101101000100" "000011111100" "011111001101"
  "110101001101" "011100100110" "101011000000" "100001010011"
  "011110111110" "011011100110" "110001011010" "111111110101"
  "001111111000" "100010011011" "100001101100" "110011010100"
  "100011000001" "011110111001" "010111110110" "100110001010"
  "100000000011" "001001101111" "101111011010" "010000110100"
  "101001011110" "100100011000" "101101000111" "011101001001"
  "010101110010" "000110000000" "000100111000" "010110111010"
  "110000011111" "011001011100" "010100110110" "011111110011"
  "111011011010" "001000101011" "000010110100" "011100101000"
  "111111100110" "011001110100" "000100011000" "010101010111"
  "001011101000" "001000011100" "110101101100" "010001000010"
  "001010010000" "111000110001" "101111111111" "011101011110"
  "001001111010" "001000100110" "000011011001" "100101100001"
  "110111000000" "100111011111" "111000110000" "110010111111"
  "000010010011" "100001100111" "010110100100" "001101001010"
  "101001100110" "010001110101" "001011000010" "010111110101"
  "000001001110" "010010100110" "111011001110" "101011111001"
  "000100000000" "111101001100" "100111011010" "000010010001"
  "100000010000" "101101000010" "110100010100" "111011111000"
  "101001100100" "001110101011" "000111001010" "111110000011"
  "001110100101" "101010000101" "010101010011" "110000111100"
  "101011001010" "010001011011" "010000011010" "000010101011"
  "100110110101" "100111011001" "100111010111" "000101100000"
  "101110000001" "100100001000" "010111000010" "000101001010"
  "001110010010" "111011000111" "001110110010" "111010000001"
  "011000100101" "000111100101" "100000100111" "100110011011"
  "001011100001" "101010100111" "011001111000" "000011011010"
  "001011101100" "010011011001" "000111111100" "010001011110"
  "111111011010" "111010010101" "110000010011" "001001101010"
  "000101011011" "100111111110" "110010101001" "111000011000"
  "011100101110" "011100010001" "001101110010" "101000111111"
  "101011011001" "110111000110" "001000010100" "000111000100"
  "010000101110" "001100100001" "111100000011" "111011101010"
  "000001111000" "100100010000" "110110000110" "000010111100"
  "110110110111" "010000011011" "101110000100" "011100100100"
  "010111001011" "001011010000" "000111010001" "110010111000"
  "001011011110" "000001100111" "010000101111" "110001100100"
  "111000001101" "000110011001" "010000010110" "101010001110"
  "111000111000" "011111011100" "111001110110" "111100010001"
  "110101111001" "001001010011" "010001111001" "001101101110"
  "010011000010" "000100011011" "000001101000" "001110100001"
  "100011010011" "100000011100" "011001010111" "110011011010"
  "100110001011" "011001110111" "001010001100" "000111010111"
  "110111111101" "111001101010" "001110001000" "011100001010"
  "010011101010" "111011010011" "000011001010" "100101000110"
  "100101010111" "110010100010" "010100101111" "111011011100"
  "100011100101" "101111111101" "001001110011" "110111101001"
  "100100010101" "010101100001" "100011000011" "001010010111"
  "011001001001" "110001101001" "010011100010" "111000001111"
  "010101111111" "001001001011" "000111110111" "100110111101"
  "011011110000" "001001011110" "011010101101" "111011101011"
  "010001100111" "110100001111" "100010110111" "000000010100"
  "100000010001" "010011010101" "010011100110" "100011111011"
  "110110100001" "110000100110" "110101100000" "110001101011"
  "110110100110" "101111101110" "011010101011" "101001010101"
  "110110111101" "100111100010" "101100100010" "101011101101"
  "010011010011" "001111011100" "100101010100" "101010101010"
  "010000011101" "011100000010" "100111101000" "111111010101"
  "011010101000" "001010110010" "111110010011" "110111011010"
  "010010111111" "111001100111" "010101111000" "000111110011"
  "111101000110" "001011000000" "110100100110" "101001110010"
  "101111011001" "111110000001" "011101110010" "011000010110"
  "101011010010" "100110011101" "000010011101" "001111110100"
  "110011001100" "111110111100" "011001011000" "001110000011"
  "110001001101" "111110111011" "110000000000" "010000110001"
  "000100110001" "001000101101" "001100110111" "101011001111"
  "110011110011" "010011100101" "001001000000" "011110100000"
  "001010110111" "110101111101" "001111000000" "100011011001"
  "100000001001" "000010101010" "110000100000" "111111101001"
  "111010101100" "101100110111" "110100011000" "010011000111"
  "010010001000" "001011001111" "001001001100" "100010110110"
  "111100111011" "111100101100" "000111111101" "101110000011"
  "100001011101" "111101110011" "100100000011" "111110011001"
  "100010111101" "110001001010" "111111100100" "010000110101"
  "001100001101" "001001110111" "110110101010" "011110010010"
  "101011010000" "101101110010" "010010110000" "011110100111"
  "010111000100" "010100000010" "000011110100" "111001011101"
  "010111100101" "110010101101" "011100010010" "001110111100"
  "011111110110" "001110100010" "000001100001" "011011110010"
  "000010111101" "001011111110" "111110111010" "001010101101"
  "100011110010" "001111110010" "011001110010" "100110101100"
  "010111010011" "001000010011" "111110110010" "011000000110"
  "011111111100" "000111110110" "110001110100" "101110010101"
  "010000111101" "011011101110" "011010100111" "001010000010"
  "100001100011" "110001000000" "101111100111" "101111110011"
  "001101110011" "110001110101" "100101010010" "010101011110"
  "000011111000" "000100001000" "101001110011" "011100110001"
  "000000011100" "111110010111" "101011101100" "110011101100"
  "110101011000" "010111001000" "111100001010" "001000011111"
  "010100111011" "101010101011" "001110001110" "100011000110"
  "000101101011" "110011010111" "111001011110" "111010100110"
  "010001110001" "011010101110" "101011110000" "001101010010"
  "001010000011" "011001000111" "010001000110" "010110011111"
  "001111011000" "000010010111" "100011110111" "111100111100"
  "010101010001" "100011101111" "011101011001" "001011001100"
  "001111000101" "110111011000" "011001001010" "010000000100"
  "100110111010" "000000111110" "011100100011" "100100111110"
  "000010011010" "111000000100" "001110001111" "011000101010"
  "011100110010" "110101000111" "110110111111" "101110110010"
  "000110100000" "110100001101" "000111101110" "111000111001"
  "000111111010" "010110111011" "000101110111" "111000011011"
  "010110001010" "001011111011" "100100100011" "011110110010"
  "000111110101" "110110011101" "000011000011" "110011001010"
  "000100101100" "101100100011" "010111000001" "110101100001"
  "011110111010" "111100101000" "010000100010" "110011000111"
  "010011011100" "100110101011" "000100001011" "101111000010"
  "010000010000" "111110000100" "111100011110" "010100111001"
  "100000011111" "010111110100" "100100110011" "111101111001"
  "100010011000" "111110101111" "010111001010" "110000101000"
  "001111111111" "000111100110" "000011101100" "011010001000"
  "001011010011" "110011111011" ))

  (defconst advent/day3-test '("00100" "11110" "10110" "10111" "10101"
  "01111" "00111" "11100" "10000" "11001" "00010" "01010"))


#+END_SRC

#+NAME: day3-solution
#+BEGIN_SRC emacs-lisp :session day 3
  ;;; package -- Solve the advent of code
  ;;; Commentary:
  ;;; Nothing to comment on!
  ;;; Code:
  (require 'cl-lib)
  (defun advent/find-submarine-consumption (list)
    "Find the consumption of the submarine from the LIST data.
  The data are binary numbers, in the format of strings.  I don't
  know why but using the binary format of Lisp like #b101010101
  doesn't seem to work!)"
    (let* ((bits (length (elt list 0)))
           (consumption (make-vector bits 0))
           (cutoff (/ (length list) 2))
           value)
      (while list
        (setq value (pop list))
        (dotimes (index bits)
          (if (equal (substring value index (+ index 1)) "1")
              (aset consumption index (1+ (aref consumption index)))
            )
          )
        )
      (let ((result "")
            (invers ""))
        (dotimes (index bits)
          (cond
           ((> (elt consumption index) cutoff)
            (setq result (concat result "1"))
            (setq invers (concat invers "0")))
           (t
            (setq result (concat result "0"))
            (setq invers (concat invers "1"))))
          )
        (* (string-to-number result 2) (string-to-number invers 2))
        )
      )
    )

  (defun advent/find-submarine-life-support-rating (list)
    "Find the life support rating of the submarine using the LIST."
    (let (oxygen co2)
      (let* ((bits (length (elt list 0)))
             (position 0)
             (current-list (copy-sequence list))
             ones-list
             zeros-list)
        (while (> (length current-list) 1)
          (setq ones-list
                (seq-filter (lambda (elem)
                              (equal (substring elem position (+ 1 position)) "1"))
                            current-list))
          (setq zeros-list
                (seq-filter (lambda (elet)
                              (equal (substring elet position (+ 1 position)) "0"))
                            current-list))
          (if (> (length zeros-list) (length ones-list))
              (setq current-list (copy-sequence zeros-list))
            (setq current-list (copy-sequence ones-list)))
          (setq position (+ 1 position)))
        (setq oxygen (car current-list))
        )
      (let* ((bits (length (elt list 0)))
             (position 0)
             (current-list (copy-sequence list))
             ones-list
             zeros-list)
        (while (> (length current-list) 1)
          (setq ones-list
                (seq-filter (lambda (elem)
                              (equal (substring elem position (+ 1 position)) "1"))
                            current-list))
          (setq zeros-list
                (seq-filter (lambda (elet)
                              (equal (substring elet position (+ 1 position)) "0"))
                            current-list))
          (if (< (length ones-list) (length zeros-list))
              (setq current-list (copy-sequence ones-list))
            (setq current-list (copy-sequence zeros-list)))
          (setq position (+ 1 position)))
        (setq co2 (car current-list))
        )
      (* (string-to-number oxygen 2) (string-to-number co2 2))
      )
    )
  (advent/find-submarine-life-support-rating advent/day3-input)

  ;;; adventofcode ends here
#+END_SRC

#+RESULTS: day3-solution
: 1370737
** day 4
#+NAME: day4-input
#+BEGIN_SRC emacs-lisp :session day4
  (defconst advent/day4-input-random '(67 31 58 8 79 18 19 45 38 13
  40 62 85 10 21 96 56 55 4 36 76 42 32 34 39 89 6 12 24 57 93 47
  41 52 83 61 5 37 28 15 86 23 69 92 70 27 25 53 44 80 65 22 99 43
  66 26 11 72 2 98 14 82 87 20 73 46 35 7 1 84 95 74 81 63 78 94 16
  60 29 97 91 30 17 54 68 90 71 88 77 9 64 50 0 49 48 75 3 59 51
  33))

  (defconst advent/day4-input-boards
'([12 75 58 21 87
55 80 14 63 17
37 35 76 92 56
72 68 51 19 38
91 60 34 30 88]

[ 0 66  5 51  8
45 57 31  3 62
 7 60 40 29 90
80 19 47 86 81
95 69 68 53 93]

[30 99 16 34 42
94 39 83 78 49
57 81 97 77 52
 9 61 98 11 89
85  1 60 90 55]

[87 49 12 85 88
67 89  7 35 70
37 45 93 84  9
80 58 54 13 22
 8 71 48 15 39]

[40 79 34 18 42
35  8 64  5 63
93 57 16 10 96
22 20 23  0 86
61 78 68 83 12]

[43 78 64 70 49
60 54 31 82  9
10 69  2  1 50
37 12 16 77 25
18 14 57 13 91]

[42 85 53 57 52
19 41 84 68 28
39 22 55 51 87
49 23  5 66 71
72 83 86 35 50]

[91 75  9 62 82
47 37 94  6 55
96 38  8 19 22
46 66 54 43 59
 1  0 26 36 74]

[19 78 25 10 80
23 88 95 42 11
54 85 52 92 31
73 87  9 17 93
 2 46 12 24 83]

[84 73 85 51 89
41 26 98 11 29
81  6 35 39 76
27 10 49  4 92
55 43 28 45 88]

[23  0 19 26 73
72 42 40 58 38
36 46 18 89 52
85 35 50 13  1
66 57 45 81 25]

[11 71 35  0 95
45 16 78 33 31
30 34 25 91 36
83 58  8  3 62
67 14 72 93 28]

[63 41 19 80 27
69 15 99 75 95
47 86 52 22 12
66 43 37  6 97
13  1  5 71 83]

[19 42 85 53 31
36 14 75 39 74
70 86 97 72 69
15 20 41  6 21
26 33 48 98 34]

[ 1 79 21 38 44
63 71 14 17 87
41 76 56 49 59
 3 18  6  4 77
34 19 88 24 10]

[78 20 30 54 92
25 63 81  0 69
46 87 26 56 40
90 82 50 84 66
96 41 18 29 23]

[34  1 59 55 30
97 19 82 23 77
21 52 56 48 24
29 43 28 99 69
 4 37 84 76 58]

[96 10 11 79 40
90 29 59 73 84
16 62 74 42 92
43 32 58 46 34
75 12 57 22 15]

[29 82 47 16 12
78 84 83  0 77
51 64  5 37  7
49 70 19 69  8
67 63  6 43 79]

[87 67 52 64  8
55 43 82 50 13
 3 19 94 54 83
80 59 15 32 37
 0 58 12 89 96]

[95 31 14 77 83
26 68 33 39 85
71 56 45 46 30
44 93 16 17 52
86  8 27  3 25]

[27 67 81 30 95
48 89  7  4  3
82 90 78 85 44
22 16 97 92 11
15 87 47 79 62]

[49 51 35 87 75
 3 70  8 43  5
77 88 73 81 29
42 62 50 37 85
26 86 14 38 65]

[81  9 84  3 37
33 32  1 54 45
39 83 82 36  2
56 28 76 85 40
96 69 43 24 71]

[83 72 50 46 34
15 51 87 44 71
 8 78 10 94 11
67 40 85 93 35
17 23 24  0 61]

[62 55 47 77 95
81 20 35  8 78
 7  9 89 27 51
80 39 33 63 50
67 34  4 87 57]

[72 88 74 46 91
67 66 32  0  9
 3 69 94  6 81
40 95 29 83 20
80 68 55 54  2]

[72 68 65 91 81
52 34 88 46 48
66  4 54 27 62
83 60 69 26 56
19 11 35 22 84]

[72 69 92 87 83
55 95 85 66  1
16  3 86  5 99
24 22 29 53 90
76 73 48 80 42]

[38 22 94 50 20
40 52 61 39 62
 7 35 95 54 66
37 59 84 76  2
81 85  0 48  6]

[90 95 34 93  8
46 13  6 58 85
91 89 83 80 18
56 57 44 99 17
21 42 12 74 38]

[28 61 78 99 23
75 64 37 66 50
53 70 89 17 63
43 38 71 26 85
 4 13  2 27 18]

[35 12 60  7 29
87 65 17 81 10
42 62 99 38 51
 2 57 92 27 89
82 58 97 36 72]

[43 45  5 99 51
88  4 13 39 95
44 56 31 33 94
37 57 12  3 91
50 74  6 76 30]

[67 85 56 69 84
74 65 61 66  8
43 50 55 25 97
78 15 49 73 27
71 44 93 23 64]

[83 38 97 85 76
55 90 46 34 12
 1 52 18 59 48
62 63 30 82 92
68 95  0 72 84]

[40 10 62 77 75
93 94 32 27 60
26 12 14 35 57
88 53 97 95 24
66 46 33  3 63]

[25 44 90 34 17
91 93 42 37 86
95 41 82 92 31
65 35 52 40 84
85 57 71 19 29]

[77 38 15 12  9
65 78 39 81 33
35 64 96 76 71
68 93 79 22 40
88 87 27  7 29]

[10 81  7 92 64
60 25 11  6 87
34 49 20 13  0
48 38 14 61 75
71 86 39 37 22]

[63 67 82 98 18
11 95  4 55 44
42 10 84 73 19
17 57 53 61 49
 7 32 24 75 58]

[50 90  1 98 41
77  4 87 69 19
48 44 68 10 17
96 66 71 61 45
18 86 26 73 16]

[ 5 58 68 34 85
44 89 72 21 27
 0 50 39 94 82
23 13 41 81  6
83 60 61 22 40]

[59 41 63 92 69
10 58 29 60  4
76 15 46 34 85
13 17 88 86 24
62 73 19 67 98]

[96 69 70 87 80
28 27 40 77  9
23 52 99  3 60
81 53 26 45 35
82 33 71 43 67]

[30  8 41 71 26
97 96  0 45 11
61 12 91  7 50
22 40 74 55 29
53 78 43 15  5]

[93 25 12 62 84
95 31 87 83 23
29 41  6 55 17
33 85 42 20 56
57  1 65 45 16]

[76 86 27 75 96
56 63 45 25 77
54 44 64 41 13
60 46 66 12 67
84 59 39 24  5]

[79 39 22 84 66
76 38 99 21 47
52 73  7 45 94
70 78 24 16 40
48 57  9 13 64]

[17 80 28 51 94
52 56 24 65 82
38 96 21 70 23
60 50 40 32 91
45 77 37 44 89]

[18  3 42 68 66
22 35 95 29 65
 8 99 72 19  5
44 80 11 60 76
59 90 64 57 94]

[66 97 62 49 89
 4 41  5  2 23
54 48 43 45 76
68 35 14  1 86
34 47 26 92 95]

[57 36 52 42 11
49 83 94 72 26
91 48 50 88 80
70 23 81 33 15
64 90  2 47 18]

[68 11 16 77 28
29 56 81 21 63
 2 88 54 82 40
69 93 92 55 70
57 51 25 80  3]

[10 73  8 27 61
74 66 47 54  1
52 17 76  5 20
70 44 92 59 34
26 16 11 81 46]

[10 31 95 17 44
76 67 19 69 33
36 70 25 71 99
56 42 53 46 40
90 85 81  6 26]

[17 32 74 57 64
37 82 92 54 59
56 87 41 68 73
44 98 58 95 53
47 29 71 52 31]

[19 58 84 14 91
75 89 18 67  3
11  5  2 24 37
62 35 48 56 81
54 77 16 70 45]

[ 7 20 41 87 74
17 47 45 96 49
 4 33 89 31 77
79 42 52 29 85
88 27 63 11 75]

[61 87 90 15 17
22 82 28 21 93
65 98 12 23 24
73 70 42  1 94
83 79  5 18 55]

[78 67 22 88 18
 2 43 14 56 92
61 32 87 20  8
28 11  7 12 70
21 72 36 74 77]

[27  6 97 66  7
30 67 12 70 40
18 61 78 36 23
44 24 85 74 82
55 42 51 90 34]

[98  9 39 42 44
50 54 43 66 57
85 58 91 13 11
67  5 23 59 70
45 41 87 29 20]

[97 57 48 42 73
37 29 50 49 83
55 38 69 13 44
52 14 54 94 56
24 77 16 39 66]

[31 61 44 38 80
11  3  0 56  8
94 81  1 25 19
71 23 36 66 41
70 35 77 79 46]

[17 96 13 25 48
65 28 41 24 81
39 87 74 42  5
36 35 21 60 40
 3 83 11  1 34]

[50 52 84 38 57
15 20 26  3 72
48 85  4 88 63
39 34 32 42  7
86 77 71 94 23]

[28 60 13 25  0
22 74 20 75 30
97  5 21  2 73
 7 44 14 77 16
43 68 76 24  1]

[99 85  4 62 67
46 86 43 45 77
42 21 81 47 57
71 35 23 10 29
58 60 79 61 48]

[33 10  7 61 17
97 91 70 75 48
81 80 78 34 36
26 55 73 77 14
85 84 62  9 16]

[17 41  3 82 86
58  0 51 79 29
60 70 61 95 46
98 85  1 72 93
 4 42 89 88 84]

[95 16 26 32 29
27 37 51 23 55
36 10 50 70 57
60 79 96 40  9
 3 43 74 94 31]

[15 56 51 72 62
 8 63 23 90 67
93 85 28 70 82
33 65 89  4 64
19 58 37 88 75]

[34 71 60 84 85
64 87 92 67  8
42 58  4  9 75
49 95 26 91 12
27 56 74 90 20]

[13 46 27 12 97
90 25 87 73 41
50 66 34 15 94
45 99 88 86 21
56 37 62 44 29]

[77 31 59 94 74
19 15 11 23 68
 0 36  2 98 30
44 49 90 83  9
13 88 69 66 81]

[31 71 58 11 47
42 41 10 83 21
38  9 51 17 64
37 13 93 81 39
33 22 98 26 43]

[60 89 20 94  2
45 34 93 15 30
 4 16 49 92 28
67 75 27 61 70
25 84 55 91 88]

[85 22 41 43  0
21 77 12 64 34
30 39 97 36 72
56  8 65 82 84
76  3  4 17 49]

[16 61 63 41 47
48 46 37 70 87
57 31 36 83  1
71  3 93 24 80
51 78 91 17 86]

[87 72 70 97 58
54 16  1 43 46
49 28 59 38 51
24 15 10 84 94
76 86 55 83 26]

[93 10  5  1 92
99  6 45 79 76
74 87 47 25 24
50 43  4 21 67
81 39 49 12 86]

[49 35 22 27 37
90 80 68 52 59
78 53 23 65 46
30 61 75 97 31
 1 76 66 26 48]

[37 11 88 20 99
45 96 95 81 39
60 55 80 58 53
 6 23  8  1 46
98 89 16 73 78]

[ 0 58 88 69 66
82  9 31 97 55
22 37 90 79 14
44 45 49 43 60
93 62 36 57 30]

[ 1 34 89 90 46
81 26  5  6 14
75 74 62 55 37
96 58 78 93 73
35 40 13 95 45]

[22 57 46 99 42
65 39 38  7 81
 4  1 76 59  8
84 60 37 55 40
49 31  5 80 30]

[29  4 96 50 24
61 77 70 88 93
12 64 52 25 90
67 34 59 95 16
79 21 82  6 63]

[26 41 52 91 57
92 95 33  1 62
45 31 87 29 59
44 86 99 81  5
36 20 58 73 30]

[55 96 28 26 17
62 51 64 43 49
37 41 36 75 42
11 94 87 27 63
35 23 21 29  4]

[99 54 74 83 92
27 53 15  8 85
94 36 63 29 91
58 10 45 38 79
 9 95 23 98 33]

[52 14 99 30 50
29 81 41 28 15
43 51 61 56 62
68 67 93 45 13
23  6 70  8  7]

[73 78 47  2  7
45 16 46 65 21
60 54 43 12  1
20 23 42 56 81
89 80 52 26 32]

[79  5 10 11  7
87 36  2 70 16
99 44 49 43 19
46 25  1 18 78
55 76  3 73 15]

[18 49 71 59 90
97 37 23 68 62
48  8 14 81 26
88  4 22 76 12
60 99 64 17 46]

[99 25 79 42 33
 5 28 38 15 11
 8 78 51 40 65
47  0 12 48 67
14 98 53 43 86]

[74 46 42 86 44
83 96 61 38 70
97  7 49  9 22
65 34 66 90 51
 0 36 13 85 53]

[43 21 64 86 20
 8 55 85 48 15
58 49 87 29 35
74  4 37 12 99
98 69 75 39 71]

[58 65 63 41 87
19 49 91 34 37
95 10 55 94 82
78 71 66 60 96
27 11 29 48 72]

[ 9 78 51 18 93
71 55  0  5 37
24 98  2 70 92
85 15 46 91 99
60 68 41 86 96]))

  (defconst advent/day4-test-random '( 7 4 9 5 11 17 23 2 0 14 21
                                      24 10 16 13 6 15 25 12 22 18
                                      20 8 19 3 26 1))

  (defconst advent/day4-test-boards '( [22 13 17 11 0 8 2 23 4 24
                                      21 9 14 16 7 6 10 3 18 5 1 12
                                      20 15 19]

                                      [ 3 15 0 2 22 9 18 13 17 5 19
                                           8 7 25 23 20 11 10 24 4
                                           14 21 16 12 6]

                                      [ 14 21 17 24 4 10 16 15 9 19
                                           18 8 23 26 20 22 11 13 6
                                           5 2 0 12 3 7] ))
#+END_SRC

#+RESULTS: day4-input
: advent/day4-test-boards

#+NAME: day4-solution
#+BEGIN_SRC emacs-lisp :session day4 :lexical yes
  ;;; advent/day4 --- Solution of day 4 in Adventofcode
  ;;; Commentary:
  ;; Just the code
  ;;; Code:
  (require 'generator)
  (require 'cl-lib)

  (iter-defun advent/bingo-numbers (numbers)
    (dolist (number numbers)
      (iter-yield number)))

  (defun advent/play-bingo (numbers inboards)
    "Play bingo with NUMBERS and INBOARDS, in advent of code."
    (let* ((number (advent/bingo-numbers numbers))
           (boards (mapcar #'copy-sequence inboards))
           (hit nil)
           (bingo nil)
           draw)
      (while (not bingo)
        (setq draw (iter-next number))
        (dolist (board boards)
          (setq hit (seq-position board draw))
          (if hit
              (progn
                (aset board hit (+ 100 (aref board hit)))
                (block checkrow
                  (let ((start (* 5 (/ hit 5))))
                    (dotimes (i 5)
                      (if (< (aref board (+ start i)) 100)
                          (return-from checkrow)))
                    (setq bingo (advent/compute-bingo draw board))
                    ))
                (block checkcolumn
                  (let ((start (mod hit 5)))
                    (dotimes (i 5)
                      (if (< (aref board (+ start (* i 5))) 100)
                          (return-from checkcolumn)))
                    (setq bingo (advent/compute-bingo draw board))))))))
      bingo))

  (defun advent/play-last-bingo (numbers inboards)
    "Play bingo with NUMBERS and INBOARDS, in advent of code."
    (let* ((number (advent/bingo-numbers numbers))
           (boards (mapcar #'copy-sequence inboards))
           (hit nil)
           (bingo nil)
           draw)
      (while (> (length boards) 1)
        (setq draw (iter-next number))
        (dolist (board boards)
          (setq hit (seq-position board draw))
          (if hit
              (progn
                (aset board hit (+ 100 (aref board hit)))))
          )
        (dolist (board boards)
          (setq hit (seq-position board (+ draw 100)))
          (if hit
              (progn
                (block checkrow
                  (let ((start (* 5 (/ hit 5))))
                    (dotimes (i 5)
                      (if (< (aref board (+ start i)) 100)
                          (return-from checkrow)))
                    (delete board boards)))
                (block checkcolumn
                  (let ((start (mod hit 5)))
                    (dotimes (i 5)
                      (if (< (aref board (+ start (* i 5))) 100)
                          (return-from checkcolumn)))
                    (delete board boards)))))))
      (print draw (get-buffer "output"))
      (print boards (get-buffer "output"))
      (advent/play-bingo advent/day4-input-random boards)))

  (defun advent/compute-bingo (draw board)
    "Compute the bingo score of BOARD with the last DRAW."
    (* draw
       (seq-reduce
        #'+
        (seq-filter (lambda (element) (< element 100)) board)
        0)))

  (advent/play-last-bingo advent/day4-input-random advent/day4-input-boards)
  ;;; advent/day4 ends here
#+END_SRC

#+RESULTS: day4-solution
: 11088
** day 5
#+NAME: day5-input
#+BEGIN_SRC emacs-lisp :session day5
  (defconst advent/day5-test '("0,9 -> 5,9"
                               "8,0 -> 0,8"
                               "9,4 -> 3,4"
                               "2,2 -> 2,1"
                               "7,0 -> 7,4"
                               "6,4 -> 2,0"
                               "0,9 -> 2,9"
                               "3,4 -> 1,4"
                               "0,0 -> 8,8"
                               "5,5 -> 8,2"))

  (defconst advent/day5-input '(
"959,103 -> 139,923"
"899,63 -> 899,53"
"591,871 -> 364,644"
"739,913 -> 310,484"
"460,309 -> 460,705"
"351,389 -> 351,837"
"420,55 -> 420,541"
"916,520 -> 382,520"
"136,604 -> 295,604"
"343,59 -> 142,59"
"951,206 -> 806,206"
"984,950 -> 61,27"
"739,388 -> 988,388"
"374,370 -> 644,370"
"403,504 -> 798,899"
"943,535 -> 229,535"
"149,227 -> 583,661"
"62,126 -> 62,352"
"131,391 -> 131,717"
"254,944 -> 254,220"
"572,111 -> 572,47"
"336,249 -> 830,743"
"898,858 -> 203,163"
"203,320 -> 825,942"
"19,318 -> 19,120"
"740,432 -> 740,39"
"591,383 -> 220,754"
"445,592 -> 19,592"
"202,370 -> 837,370"
"473,916 -> 600,789"
"118,955 -> 884,189"
"377,376 -> 533,532"
"160,264 -> 160,62"
"627,572 -> 627,679"
"217,690 -> 217,629"
"685,323 -> 866,504"
"391,309 -> 493,207"
"872,776 -> 357,776"
"116,326 -> 116,426"
"82,900 -> 832,900"
"594,862 -> 594,593"
"802,636 -> 802,223"
"862,226 -> 862,787"
"313,573 -> 834,573"
"145,631 -> 13,499"
"545,433 -> 420,308"
"427,623 -> 427,808"
"898,120 -> 511,120"
"859,811 -> 859,28"
"715,958 -> 715,893"
"115,234 -> 484,234"
"125,253 -> 50,253"
"737,265 -> 158,265"
"523,965 -> 523,983"
"118,51 -> 118,766"
"455,774 -> 455,357"
"680,881 -> 925,881"
"191,186 -> 187,186"
"821,629 -> 792,658"
"397,906 -> 397,962"
"988,811 -> 988,427"
"91,733 -> 519,733"
"46,172 -> 566,172"
"740,619 -> 880,759"
"609,465 -> 609,702"
"289,211 -> 289,620"
"622,135 -> 622,929"
"113,53 -> 872,53"
"559,713 -> 559,132"
"894,237 -> 211,920"
"237,259 -> 237,39"
"738,542 -> 976,542"
"163,34 -> 525,34"
"681,672 -> 264,255"
"37,827 -> 722,827"
"60,803 -> 514,349"
"433,866 -> 433,257"
"379,493 -> 379,643"
"697,588 -> 192,83"
"875,646 -> 318,89"
"634,983 -> 634,111"
"636,69 -> 636,41"
"911,780 -> 701,570"
"792,71 -> 956,71"
"682,338 -> 608,412"
"257,768 -> 450,575"
"112,25 -> 795,708"
"730,86 -> 730,65"
"966,785 -> 789,608"
"390,263 -> 483,356"
"90,852 -> 90,471"
"507,914 -> 769,914"
"803,535 -> 803,245"
"710,787 -> 570,787"
"138,842 -> 270,710"
"862,988 -> 862,656"
"56,408 -> 849,408"
"16,10 -> 979,973"
"982,14 -> 12,984"
"647,915 -> 38,306"
"797,487 -> 19,487"
"539,933 -> 924,933"
"509,734 -> 176,734"
"813,505 -> 976,505"
"474,987 -> 474,896"
"21,200 -> 164,200"
"986,973 -> 31,18"
"919,830 -> 111,22"
"32,574 -> 456,150"
"743,595 -> 842,595"
"623,306 -> 722,306"
"878,367 -> 519,367"
"924,221 -> 924,231"
"86,950 -> 773,263"
"950,248 -> 537,248"
"149,155 -> 962,968"
"449,568 -> 179,568"
"186,304 -> 868,986"
"921,320 -> 639,602"
"602,262 -> 602,500"
"602,33 -> 602,248"
"380,731 -> 423,774"
"535,110 -> 638,110"
"552,317 -> 552,75"
"173,667 -> 173,847"
"707,480 -> 195,480"
"833,398 -> 267,964"
"276,716 -> 413,716"
"342,816 -> 922,816"
"24,184 -> 715,875"
"762,330 -> 717,285"
"718,886 -> 718,551"
"707,834 -> 707,704"
"479,578 -> 161,896"
"145,297 -> 145,435"
"760,651 -> 536,875"
"954,629 -> 954,816"
"305,949 -> 305,919"
"55,132 -> 55,233"
"469,85 -> 439,85"
"653,990 -> 536,990"
"876,531 -> 432,87"
"698,207 -> 698,672"
"11,70 -> 766,825"
"591,357 -> 30,918"
"697,987 -> 697,823"
"610,903 -> 370,663"
"319,678 -> 319,504"
"337,150 -> 309,150"
"876,57 -> 311,57"
"673,268 -> 345,596"
"895,364 -> 518,741"
"327,662 -> 941,48"
"77,709 -> 110,742"
"194,78 -> 661,78"
"587,24 -> 825,24"
"503,317 -> 719,317"
"459,632 -> 704,387"
"717,292 -> 835,292"
"912,927 -> 72,87"
"510,527 -> 146,527"
"336,771 -> 336,266"
"566,961 -> 496,961"
"969,335 -> 122,335"
"925,443 -> 925,397"
"316,812 -> 606,812"
"815,795 -> 116,795"
"169,36 -> 354,36"
"358,274 -> 389,274"
"302,147 -> 839,684"
"762,372 -> 972,372"
"172,721 -> 682,211"
"265,150 -> 248,167"
"753,559 -> 307,559"
"823,121 -> 823,126"
"498,856 -> 498,135"
"75,977 -> 75,381"
"541,297 -> 541,320"
"735,108 -> 866,108"
"434,907 -> 868,907"
"915,959 -> 255,959"
"967,666 -> 967,209"
"361,600 -> 361,222"
"314,580 -> 314,497"
"175,989 -> 523,641"
"957,97 -> 311,743"
"956,227 -> 12,227"
"95,364 -> 95,742"
"857,141 -> 193,805"
"388,651 -> 468,731"
"582,177 -> 324,177"
"68,272 -> 68,720"
"543,490 -> 910,490"
"508,281 -> 902,281"
"823,380 -> 823,296"
"23,10 -> 946,933"
"813,70 -> 813,450"
"881,893 -> 598,893"
"535,781 -> 973,781"
"80,890 -> 909,61"
"604,630 -> 307,927"
"836,917 -> 184,917"
"76,727 -> 10,727"
"727,235 -> 727,578"
"629,80 -> 892,80"
"110,655 -> 663,102"
"985,12 -> 11,986"
"830,656 -> 830,761"
"660,869 -> 660,543"
"381,340 -> 381,562"
"392,735 -> 417,735"
"855,24 -> 320,24"
"801,669 -> 278,146"
"730,964 -> 107,964"
"523,158 -> 385,20"
"27,833 -> 27,987"
"569,707 -> 500,707"
"527,732 -> 527,424"
"74,88 -> 273,287"
"143,974 -> 143,735"
"247,388 -> 813,954"
"577,14 -> 945,382"
"49,43 -> 953,947"
"332,210 -> 332,143"
"69,280 -> 949,280"
"25,923 -> 904,44"
"306,569 -> 306,470"
"158,273 -> 113,228"
"771,355 -> 694,278"
"515,115 -> 245,385"
"427,381 -> 427,729"
"16,987 -> 987,16"
"319,463 -> 319,234"
"854,977 -> 66,189"
"794,194 -> 794,183"
"576,65 -> 576,843"
"37,964 -> 734,964"
"740,920 -> 740,877"
"245,487 -> 245,957"
"404,794 -> 853,794"
"660,656 -> 660,756"
"921,605 -> 127,605"
"650,894 -> 916,894"
"968,893 -> 481,406"
"986,979 -> 21,14"
"154,303 -> 498,647"
"720,338 -> 229,338"
"62,936 -> 62,897"
"55,820 -> 55,923"
"812,31 -> 551,31"
"338,466 -> 951,466"
"663,492 -> 775,604"
"449,602 -> 39,602"
"44,403 -> 44,144"
"58,62 -> 339,62"
"713,730 -> 713,502"
"704,525 -> 976,797"
"372,709 -> 372,680"
"709,387 -> 153,387"
"922,103 -> 615,103"
"629,839 -> 121,839"
"206,722 -> 529,722"
"232,556 -> 422,746"
"300,470 -> 300,726"
"376,820 -> 622,574"
"834,25 -> 255,604"
"271,200 -> 271,875"
"804,934 -> 872,934"
"900,753 -> 900,632"
"604,323 -> 604,70"
"890,911 -> 890,41"
"464,169 -> 812,169"
"850,196 -> 850,903"
"34,574 -> 34,54"
"718,59 -> 462,315"
"431,923 -> 737,923"
"433,573 -> 433,420"
"297,478 -> 297,775"
"756,545 -> 544,545"
"247,708 -> 247,702"
"736,835 -> 173,272"
"319,85 -> 319,827"
"931,775 -> 683,775"
"292,315 -> 451,315"
"397,435 -> 380,435"
"987,978 -> 82,73"
"227,349 -> 227,724"
"349,741 -> 899,191"
"965,325 -> 765,125"
"849,306 -> 88,306"
"516,548 -> 516,902"
"919,395 -> 568,395"
"736,507 -> 192,507"
"960,782 -> 196,18"
"431,413 -> 510,492"
"911,696 -> 911,830"
"888,225 -> 174,225"
"57,790 -> 57,953"
"858,399 -> 119,399"
"59,302 -> 290,302"
"456,907 -> 456,599"
"374,743 -> 374,565"
"183,107 -> 183,171"
"58,699 -> 288,699"
"886,970 -> 109,193"
"940,395 -> 806,261"
"781,480 -> 596,665"
"456,724 -> 265,724"
"414,406 -> 299,521"
"115,898 -> 115,863"
"34,543 -> 34,496"
"900,843 -> 900,457"
"165,209 -> 189,209"
"976,627 -> 539,190"
"252,202 -> 137,202"
"584,339 -> 550,373"
"580,153 -> 380,353"
"232,412 -> 650,830"
"910,833 -> 88,11"
"418,245 -> 829,245"
"298,823 -> 907,214"
"91,876 -> 495,876"
"315,874 -> 650,539"
"907,635 -> 365,635"
"339,313 -> 320,313"
"362,435 -> 362,938"
"152,664 -> 152,391"
"253,210 -> 272,210"
"216,396 -> 216,726"
"852,912 -> 15,75"
"882,828 -> 689,828"
"674,533 -> 674,523"
"469,719 -> 469,79"
"733,169 -> 665,101"
"734,632 -> 717,632"
"615,565 -> 615,114"
"979,720 -> 243,720"
"827,125 -> 827,919"
"605,419 -> 601,419"
"749,13 -> 433,329"
"990,902 -> 990,843"
"186,679 -> 186,457"
"374,796 -> 736,796"
"133,867 -> 133,801"
"757,622 -> 812,567"
"351,179 -> 351,509"
"214,748 -> 575,748"
"177,903 -> 861,219"
"747,981 -> 747,64"
"588,125 -> 588,557"
"464,338 -> 769,338"
"645,669 -> 125,149"
"579,352 -> 138,352"
"77,605 -> 520,605"
"698,816 -> 698,917"
"112,943 -> 112,834"
"731,720 -> 724,720"
"887,440 -> 976,351"
"676,301 -> 676,741"
"870,732 -> 870,648"
"250,826 -> 413,826"
"399,720 -> 543,864"
"834,93 -> 468,459"
"415,475 -> 415,641"
"793,415 -> 47,415"
"365,476 -> 365,31"
"195,154 -> 813,154"
"503,605 -> 773,605"
"553,121 -> 851,121"
"25,420 -> 423,818"
"943,110 -> 258,110"
"775,436 -> 826,436"
"16,161 -> 16,889"
"702,555 -> 920,555"
"589,858 -> 533,802"
"932,404 -> 932,539"
"647,275 -> 647,962"
"87,179 -> 326,179"
"931,588 -> 931,287"
"868,96 -> 557,96"
"879,28 -> 875,28"
"375,132 -> 287,44"
"484,352 -> 644,512"
"448,566 -> 448,214"
"734,460 -> 717,460"
"550,379 -> 550,674"
"964,184 -> 820,328"
"167,504 -> 387,504"
"594,777 -> 952,777"
"328,712 -> 837,712"
"600,773 -> 546,773"
"955,954 -> 82,81"
"863,790 -> 863,86"
"831,773 -> 32,773"
"987,11 -> 19,979"
"901,878 -> 901,177"
"427,341 -> 721,635"
"690,835 -> 567,835"
"557,724 -> 14,181"
"591,20 -> 205,406"
"846,865 -> 846,859"
"644,646 -> 742,548"
"187,376 -> 187,563"
"367,806 -> 250,923"
"332,731 -> 468,731"
"378,431 -> 469,431"
"844,949 -> 844,452"
"172,320 -> 735,320"
"597,639 -> 633,639"
"353,831 -> 353,307"
"355,392 -> 465,392"
"624,179 -> 548,255"
"441,928 -> 401,888"
"442,680 -> 442,569"
"567,385 -> 908,44"
"10,561 -> 603,561"
"851,289 -> 13,289"
"832,143 -> 832,64"
"366,851 -> 67,851"
"890,404 -> 333,961"
"83,22 -> 963,902"
"10,783 -> 821,783"
"369,481 -> 369,611"
"943,356 -> 846,356"
"675,95 -> 335,435"
"442,928 -> 442,764"
"500,643 -> 334,643"
"90,207 -> 620,207"
"520,412 -> 745,187"
"586,89 -> 613,89"
"411,424 -> 595,424"
"938,650 -> 232,650"
"216,773 -> 76,773"
"895,690 -> 895,294"
"250,886 -> 250,605"
"296,422 -> 863,989"
"534,626 -> 534,707"
"577,608 -> 52,83"
"61,674 -> 714,21"
"844,126 -> 844,694"
"565,541 -> 253,229"
"62,24 -> 986,948"
"588,901 -> 588,212"
"541,508 -> 541,141"
"516,376 -> 589,449"
"390,215 -> 749,215"
"324,878 -> 296,850"
"592,408 -> 592,158"
"433,207 -> 172,207"
"139,72 -> 139,121"
"471,676 -> 268,676"
"374,433 -> 374,95"
"672,459 -> 640,427"
"348,577 -> 843,82"
"903,466 -> 903,348"
"437,759 -> 726,470"
"152,101 -> 325,274"
"933,897 -> 335,897"
"516,877 -> 505,866"
"890,715 -> 570,715"
"78,124 -> 871,917"
"360,645 -> 967,645"
"645,271 -> 645,57"
"693,878 -> 693,159"
"49,77 -> 49,744"
"935,914 -> 97,76"
"941,726 -> 941,464"
"756,985 -> 756,480"
"887,378 -> 887,529"
"405,925 -> 405,533"
"533,156 -> 201,156"
"565,535 -> 120,90"
"51,15 -> 967,931"
"660,218 -> 660,339"
"522,682 -> 571,682"
"958,899 -> 729,899"
"521,687 -> 288,687"
"643,148 -> 468,323"
"989,971 -> 68,50"
"729,273 -> 311,691"
"245,205 -> 305,205"
"634,747 -> 634,605"
"280,407 -> 488,199"
"109,931 -> 706,334"
"849,694 -> 615,928"
"794,84 -> 218,84"
"669,184 -> 865,184"
"936,834 -> 234,132"
"691,445 -> 914,668"
"423,161 -> 515,69"
"81,674 -> 37,674"
"292,423 -> 292,741"
"188,306 -> 844,962"
"204,309 -> 204,705"
"961,652 -> 746,652"
"985,987 -> 11,13"
"139,153 -> 936,950"
"436,978 -> 244,978"
"921,633 -> 921,340"
"872,63 -> 233,63"))
#+END_SRC

#+RESULTS: day5-input
: advent/day5-input

#+NAME: day5-solution
#+BEGIN_SRC emacs-lisp :session day5
  (defun advent/find-overlaps-hv (coordinates dimension)
    "Find the overlapping points of horizontal and vertical lines.
  Given the COORDINATES find horizontal or vertical lines that
  intersect in a table of maximum DIMENSION x DIMENSION dimension."
    (setq field (make-vector dimension nil))
    (dotimes (i dimension)
      (setf (aref field i) (make-vector dimension 0)))
    (dolist (coordinate coordinates)
      (let* ((points (split-string coordinate " -> "))
             (start (split-string (car points) ","))
             (x1 (string-to-number (car start)))
             (y1 (string-to-number (cadr start)))
             (end (split-string (cadr points) ","))
             (x2 (string-to-number (car end)))
             (y2 (string-to-number (cadr end))))
        (if (= y1 y2)
            (let ((begin (min x1 x2))
                  (finish (max x1 x2)))
              (while (<= begin finish)
                (aset (aref field y1) begin (1+ (aref (aref field y1) begin)))
                (setq begin (1+ begin)))))
        (if (= x1 x2)
            (let ((top (min y1 y2))
                  (bottom (max y1 y2)))
              (while (<= top bottom)
                (aset (aref field top) x1 (1+ (aref (aref field top) x1)))
                (setq top (1+ top)))))))
    (let ((summ 0))
      (dotimes (i dimension)
        (setq summ (+ summ
                      (length
                       (seq-filter (lambda (elem) (> elem 1))
                                   (aref field i))))))
      summ))

  (defun advent/find-overlaps-hvd (coordinates dimension)
    "Find the overlapping points of horizontal, vertical and diagonal lines.
  Given the COORDINATES find horizontal, vertical or diagonal lines
  that intersect in a table of maximum DIMENSION x DIMENSION,
  dimension."
    (setq field (make-vector dimension nil))
    (dotimes (i dimension)
      (setf (aref field i) (make-vector dimension 0)))
    (dolist (coordinate coordinates)
      (let* ((points (split-string coordinate " -> "))
             (start (split-string (car points) ","))
             (x1 (string-to-number (car start)))
             (y1 (string-to-number (cadr start)))
             (end (split-string (cadr points) ","))
             (x2 (string-to-number (car end)))
             (y2 (string-to-number (cadr end))))
        (cond
         ((= y1 y2)
          (let ((begin (min x1 x2))
                (finish (max x1 x2)))
            (while (<= begin finish)
              (aset (aref field y1) begin (1+ (aref (aref field y1) begin)))
              (setq begin (1+ begin)))))
         ((= x1 x2)
          (let ((top (min y1 y2))
                (bottom (max y1 y2)))
            (while (<= top bottom)
              (aset (aref field top) x1 (1+ (aref (aref field top) x1)))
              (setq top (1+ top)))))
         (t
          (let ((dist (abs (- x2 x1)))
                (dirx (signum (- x2 x1)))
                (diry (signum (- y2 y1))))
            (dotimes (i (1+ dist))
              (aset (aref field y1) x1 (1+ (aref (aref field y1) x1)))
              (setq x1 (+ x1 dirx))
              (setq y1 (+ y1 diry))))))))
    (let ((summ 0))
      (dotimes (i dimension)
        (setq summ (+ summ
                      (length
                       (seq-filter (lambda (elem) (> elem 1))
                                   (aref field i))))))
      summ))

  (advent/find-overlaps-hvd advent/day5-input 1000)
#+END_SRC

#+RESULTS: day5-solution
: 19939
** day 6
#+NAME: day6-input
#+BEGIN_SRC emacs-lisp :session day6
  (defconst advent/day6-test '(3 4 3 1 2))

  (defconst advent/day6-input '(4 1 4 1 3 3 1 4 3 3 2 1 1 3 5 1 3 5
  2 5 1 5 5 1 3 2 5 3 1 3 4 2 3 2 3 3 2 1 5 4 1 1 1 2 1 4 4 4 2 1 2
  1 5 1 5 1 2 1 4 4 5 3 3 4 1 4 4 2 1 4 4 3 5 2 5 4 1 5 1 1 1 4 5 3
  4 3 4 2 2 2 2 4 5 3 5 2 4 2 3 4 1 4 4 1 4 5 3 4 2 2 2 4 3 3 3 3 4
  2 1 2 5 5 3 2 3 5 5 5 4 4 5 5 4 3 4 1 5 1 3 4 4 1 3 1 3 1 1 2 4 5
  3 1 2 4 3 3 5 4 4 5 4 1 3 1 1 4 4 4 4 3 4 3 1 4 5 1 2 4 3 5 1 1 2
  1 1 5 4 2 1 5 4 5 2 4 4 1 5 2 2 5 3 3 2 3 1 5 5 5 4 3 1 1 5 1 4 5
  2 1 3 1 2 4 4 1 1 2 5 3 1 5 2 4 5 1 2 3 1 2 2 1 2 2 1 4 1 3 4 2 1
  1 5 4 1 5 4 4 3 1 3 3 1 1 3 3 4 2 3 4 2 3 1 4 1 5 3 1 1 5 3 2 3 5
  1 3 1 1 3 5 1 5 1 1 3 1 1 1 1 3 3 1))
#+END_SRC

#+RESULTS: day6-input
: advent/day6-input

#+NAME: day6-solution
#+BEGIN_SRC emacs-lisp :session day6
  (defun advent/breed-lanternfish (school days)
  "Find how many lanternfish will be in the SCHOOL after DAYS days.
  This works for small numbers, since memory consumption grows
  exponentially with this, so for bigger DAYS, a different
  algorithm is needed."
    (dotimes (iter days)
      (let ((spawns 0))
        (setq school
              (mapcar
               (lambda (x)
                 (if (>= (1- x) 0)
                     (1- x)
                   (progn
                     (setq spawns (1+ spawns))
                     6)))
               school))
        (if (> spawns 0)
            (setq school (append (make-list spawns 8) school)
                  spawns 0))))
    (length school))

  (defun advent/breed-lanternfish-long (school days)
    (let ((schools '(0 0)))
      (dotimes (index 7)
        (setq schools
              (append
               (list (length (seq-filter (lambda (x) (= x (- 6 index))) school)))
               schools)))
      (dotimes (index days)
        (let (spawn)
          (setq spawn (pop schools))
          (setq schools (append schools (list spawn)))
          (setf (nth 6 schools) (+ spawn (nth 6 schools)))))
      (cl-reduce #'+ schools)))

  (advent/breed-lanternfish-long advent/day6-input 256)
#+END_SRC

#+RESULTS: day6-solution
: 1590327954513
** day 7
#+NAME: day7-input
#+BEGIN_SRC emacs-lisp :session day7
  (defconst advent/day7-test '(16 1 2 0 4 2 7 1 2 14))

  (defconst advent/day7-input '(1101 1 29 67 1102 0 1 65 1008 65 35
  66 1005 66 28 1 67 65 20 4 0 1001 65 1 65 1106 0 8 99 35 67 101
  99 105 32 110 39 101 115 116 32 112 97 115 32 117 110 101 32 105
  110 116 99 111 100 101 32 112 114 111 103 114 97 109 10 602 216
  979 1851 549 9 38 931 28 9 303 933 1262 265 81 291 1447 737 379
  456 1236 604 393 438 260 242 421 549 390 372 366 717 927 94 146
  603 557 676 1729 4 1027 26 671 213 286 948 142 97 1087 210 72 949
  947 1251 414 968 1300 42 814 1036 610 214 1536 210 108 545 375
  1248 647 233 406 1502 433 243 13 836 815 73 525 129 323 912 671
  270 635 501 110 128 113 147 534 894 883 318 205 453 264 259 1039
  759 439 918 1647 493 1 422 503 583 1591 254 267 1213 604 145 242
  795 278 181 12 236 1122 1002 235 965 73 228 755 562 91 4 205 1669
  25 297 744 36 861 19 875 878 118 147 397 171 199 1286 72 942 200
  991 8 496 631 214 668 79 1582 426 240 146 1153 88 1582 204 1254
  527 19 358 444 944 84 1573 466 532 118 285 293 126 43 1348 837
  326 154 412 153 861 1378 138 730 484 157 42 17 43 553 468 1668 16
  301 612 65 293 383 95 260 1219 13 29 322 1043 1303 43 1147 1505
  816 836 43 339 825 703 371 289 290 1060 492 661 667 818 178 114
  1042 244 383 127 280 500 291 141 2 806 911 252 282 38 348 155 84
  138 563 11 304 1216 1312 560 266 328 1570 1330 136 292 25 414 75
  1172 387 291 279 12 405 169 661 102 24 66 1149 83 161 120 310
  1041 686 149 328 345 1143 190 111 155 183 1210 619 40 431 9 470
  731 453 1195 415 641 393 81 234 157 42 911 1365 292 163 388 204
  1160 971 13 980 535 285 1504 454 461 518 242 974 798 93 80 720
  234 378 1355 351 160 228 407 494 1650 629 621 965 686 341 273 252
  66 189 526 15 273 389 1033 126 89 731 1254 1109 83 1660 682 700
  712 140 105 929 62 623 476 918 15 568 406 346 720 402 1421 468
  702 1090 159 794 14 59 863 393 540 1367 785 824 1016 857 488 515
  539 109 12 53 371 13 483 930 112 666 30 664 768 699 1247 449 6
  132 61 688 356 46 42 375 1320 606 62 14 233 161 497 150 1084 517
  7 128 379 412 264 826 962 101 909 9 1624 77 307 485 106 103 4
  1239 173 711 1533 99 762 100 382 876 26 305 218 27 41 1126 11 477
  60 1187 201 541 102 571 227 60 118 1561 269 388 233 828 382 195
  186 199 1552 444 605 22 78 159 386 1076 813 160 355 860 675 1139
  437 71 1605 1 450 163 125 1245 778 10 375 348 18 174 223 367 342
  697 257 317 454 242 99 1243 876 719 641 1097 538 444 280 33 99 0
  492 194 458 983 42 651 454 1171 621 198 1152 31 410 3 247 977 338
  220 830 580 1021 1238 401 536 124 1605 1461 1785 644 837 492 473
  1073 1166 78 565 1018 155 156 948 942 368 1140 893 1059 501 46
  383 752 373 236 1138 1279 450 104 502 229 783 241 186 46 919 514
  371 18 578 428 1205 317 945 71 741 125 1155 680 1081 436 525 1396
  171 942 225 403 564 365 372 167 599 955 1442 1672 258 717 922 219
  1044 216 224 417 149 510 332 236 533 28 391 39 857 842 601 1216
  151 538 900 481 39 363 400 78 1006 384 957 626 1503 269 429 259
  755 1140 537 45 1 243 194 815 346 376 304 1167 423 822 166 282 20
  200 133 892 140 1073 639 409 1644 105 828 881 1155 41 1590 647
  449 89 845 554 411 260 837 237 377 154 49 36 687 62 230 14 11 26
  853 497 48 130 17 1817 131 433 106 414 1034 146 977 565 670 581
  999 4 164 706 58 212 554 101 64 123 219 154 28 531 626 64 782 505
  364 281 1084 1414 27 226 736 507 837 142 434 319 409 819 48 23
  820 454 1080 567 783 201 53 1153 404 187 814 28 898 309 380 295
  437 366 1226 861 100 550 119 8 233 1452 30 753 381 365 683 474
  227 155 1795 1093 208 159 121 1547 942 194 139 325 838 901 597
  805 486 1499 597 405 1042 41 222 740 478 884 165 62 547 15 20 309
  454 132 5 136 972 45 65 267 463 581 244 51 981 1120 75 410 1310
  991 607 1801 950 913 98 769 81 322 19 459 1210 617 48 1163 1243
  332 92 1713 120 269 20 246 323 1365 80 1165 1344 236 750 269 62
  375 143 163 1444 172 789 521 105 369 1 40 341 625 674 1073 1376
  108 391 277 122 181 134 78 1058 103 300 30 848 708 59 93 204 263
  32 951 1884 23 488 258 1156 838 72 310 29 209 908 39 119 119 352
  70 139 3 884 86 57 541 1553 5 105 710 29 335 1197 1152 144 696
  685 948 563))
#+END_SRC

#+RESULTS: day7-input
: advent/day7-input

#+NAME: day7-solution
#+BEGIN_SRC emacs-lisp :session day7
  (defun advent/minimize-fuel-cost (positions)
    "Compute the least fuel consumption for given POSITIONS.
  This point will lie inside the space that POSITIONS occupy."
    (let ((greatest (seq-max positions))
          (current-pos 0)
          (min-pos 0))
      (setq min-pos (seq-reduce (lambda (init x) (+ init (abs (- x 0)))) positions 0))
      (dotimes (i (1- greatest))
        (setq current-pos (seq-reduce (lambda (init x) (+ init (abs (- x i)))) positions 0))
        (if (< current-pos min-pos)
            (setq min-pos current-pos)))
      min-pos))

  (defun advent/minimize-fuel-cost-augmented (positions)
    "Compute the least fuel consumption for given POSITIONS.
  But this time the fuel consumption increases with an arithmetic progressions."
    (let ((greatest (seq-max positions))
          (current-pos 0)
          (min-pos 0))
      (setq min-pos (seq-reduce
                     (lambda (init x)
                       (let ((dist (abs (- x 0))))
                         (+ init (/ (* dist (1+ dist)) 2))))
                     positions 0))
      (dotimes (i (1- greatest))
        (setq current-pos (seq-reduce
                           (lambda (init x)
                             (let ((dist (abs (- x i))))
                               (+ init
                                  (/ (* dist (1+ dist)) 2))))
                           positions 0))
        (if (< current-pos min-pos)
            (setq min-pos current-pos)))
      min-pos))

  (advent/minimize-fuel-cost-augmented advent/day7-input)
#+END_SRC

#+RESULTS: day7-solution
: 93214037
** Day 8
#+NAME: day8-input
#+BEGIN_SRC emacs-lisp :session day8

  (defconst advent/day8-test
    '(
"be cfbegad cbdgef fgaecd cgeb fdcge agebfd fecdb fabcd edb | fdgacbe cefdb cefbgd gcbe"
"edbfga begcd cbg gc gcadebf fbgde acbgfd abcde gfcbed gfec | fcgedb cgb dgebacf gc"
"fgaebd cg bdaec gdafb agbcfd gdcbef bgcad gfac gcb cdgabef | cg cg fdcagb cbg"
"fbegcd cbd adcefb dageb afcb bc aefdc ecdab fgdeca fcdbega | efabcd cedba gadfec cb"
"aecbfdg fbg gf bafeg dbefa fcge gcbea fcaegb dgceab fcbdga | gecf egdcabf bgf bfgea"
"fgeab ca afcebg bdacfeg cfaedg gcfdb baec bfadeg bafgc acf | gebdcfa ecba ca fadegcb"
"dbcfg fgd bdegcaf fgec aegbdf ecdfab fbedc dacgb gdcebf gf | cefg dcbef fcge gbcadfe"
"bdfegc cbegaf gecbf dfcage bdacg ed bedf ced adcbefg gebcd | ed bcgafe cdgba cbgef"
"egadfb cdbfeg cegd fecab cgb gbdefca cg fgcdab egfdb bfceg | gbdfcae bgc cg cgb"
"gcafb gcf dcaebfg ecagb gf abcdeg gaef cafbge fdbac fegbdc | fgae cfgab fg bagce"))

  (defconst advent/day8-input
    '(
"aecgdbf badcg fbcage gdabce be gaedb bced dfeag adbfgc abe | gedbacf be bdfcga bedfgca"
"gbeda bf fbgea dgafce fcgedb fgaec bcfa bfg baefgc dbfgace | fb cfba cbedfg afbc"
"dfegb bcfdae cagbef cedfg cde cadg fcagde dbcefag dc geacf | dc aedcfb ebadgfc cgdef"
"fgecab ebfd ed acgbd bgadfe dge dbage daefcg gfeba ecdbafg | dfbe fbaeg abegd caefdgb"
"edbg gd ebfcg cafed dfgecb gdf agcbfde dgfcab fegdc gfbaec | dbge fbaedcg gd dg"
"fdbagc egbdf dga ebcfad caedgf eadcf dafeg dagfecb gaec ga | fadebc edgaf ga eagc"
"ed gefacb dfacge fedb cde ecgdfab cgbfe ecdbg edfbgc dbagc | defb edfb ebgadfc efgcb"
"afgbec adfecg ebfacgd gbfc fb ecdba aebfc debgaf fba gfcea | gadfbe gefdabc dbeac fb"
"def degfba egfbd ef cabdge gbdfc adbeg eafbdc geaf edacgfb | bfdgae fde fde geadb"
"fbdcg edafcb dgabef cfedb eadbf ced gcbedfa beca acfgde ce | fcaged eacb bgeadf dbacef"
"bgcaf fgabd ebfgc cfa dagfce cgefbad gfcbea ca fdbgce aebc | aebc edgcbaf adfgb gbfad"
"ebgad ea dbfeg bceagdf dgcba aebc edgabc cafdeg abfgdc aeg | dgcba ae ceadgf gbedf"
"bcdeg gfedab cf cfg aefc fcbdega ebfag cbgadf gbfec acbfge | fc cgf gcf fc"
"dg adcebg bcdafe dbgf gda bfade adfgbe afedg adefcgb geafc | cgaef dg caegf gfdecab"
"dgace afbegd bcgdeaf cdgfea ca cdegb cfga egdaf eacfbd cea | eca cfga gafde ca"
"cfgeab gdfeabc fcbeg fdegba ae ega gcbea dagbc fcgbed feca | degbfca bdfgeca gcbaef caef"
"cbgfa dfbcg gdb dg fdgbea edcg cfgbde cfdbe cdafbge bdeafc | dg dgb gfdeab bdg"
"fb bedgfc cbf fegadcb dfacbe bfceg fbgd gdfce dfgaec geabc | adbfce gafcdeb bcf bf"
"cegfd edagc fadgebc abfegc cf gdefbc aefbgd gedbf gfc cfdb | dcgbfe cdbf fbdc fc"
"ebcag adbefc defgca fdga gefdacb egfcdb afcge fg gcf edcfa | cgfdbe adefbcg bcfadeg beacg"
"cebfa begfca efb fe ecbgad bgaec fgecbd fdcgabe gefa dabfc | ef ecabdg egbfcd cgbea"
"gdae dgebf acgebf dafcgb dg efbgda gfbeacd fdg cbdef efabg | bfcde dg gfdbace dfg"
"gfcdb fbecad abdce fcdbe dgfeab efca dfe bcadeg ef degbfca | dgabce fdgbc fgdcbae bcgdf"
"becf ecdafb aefgd gbdcaf cdebafg cdf acbed cafed fc debagc | abdfgc gcbfad cagdeb fc"
"fabdc fcegdab be deb defbca fbacdg bfade gfcebd beca gdeaf | ebca be bcagdf gcefbd"
"dacbge cbdae gfaeb gacfbd baged acdebf bdg ecgd gd acfdebg | gd dgb edfbgac dg"
"bdfecg fgeac agdeb fadb bgeaf bgdfae bgcedaf fb cbadeg gbf | bfeag cabefgd baged fb"
"ecga cef becdfg bgcdeaf fcdage fedac cdabfg dfagc dbefa ec | ce cdgfbe fec cfbadg"
"ecbf agbcf beagc dagcf cafgeb bfg dgfbcae egbacd bf adgfeb | fgb fgb cbegfa befc"
"bdcaefg fdb bdefa edbca cgaedf gefb adfeg fb fcgbad edbafg | fdb bf ebdaf fbeadcg"
"cba ecgfa bdgc gfabcd bc abfedcg abgfd fabcg bedafc gbfead | cab bc bcgd dgcb"
"fbeadgc fdacbe abde dagfce cfbag efcda gdefbc bec be feabc | dabe be ecb cefagdb"
"af eaf debga bcedf ecgfbda acfegb adcf bfgecd ceafdb badef | dfac af fa bfdeac"
"cdaeg fedcag edfcg fgacedb gadbcf acd egacb dgfceb daef da | begca ad efacgdb cad"
"cefdg adbg ecbfag cbeafdg geafb bgedf dbf ebcadf fgdeba bd | gedbf cgdaefb dfb gdcef"
"cdfeg gecafbd bdfea bgfadc gbfaed fcead cdfbae fca ecab ca | fcbgda bcae ecab acf"
"abdcef gbacdfe fdabc fedac cfbe fde bdagfc eadcg ef edgbaf | efcb adfec fed bcedfa"
"fcadg efbgc bdf afcdegb bd cfdagb cdgbf bcda gdebfa deafcg | fbcgd agcfdb cgfad db"
"efg gbdce cgedaf bdfe acbegd egfcdb gbfec ef fdcgbae fbacg | bcdfeg fcgba egf gebcd"
"cabedf cgfed fdgeb baeg gadfb eb cgafbed edagbf fbe acbgfd | dbfacge edgfabc eb eb"
"gfecad gebdf egb bdcfe gb gadb ecfgbda egdfa defgab cfabeg | cegafd gafcbde adbg egb"
"cefbg ceb ce egbdf cagfb bgfedc gcde bdfgae bfdcae gdbfeca | ce gbcefad edgc ce"
"bacdg cbge ec fdega cafgbd gbecda cea bcdfae fabegdc cedag | eafdcbg cegadb fgdcab eca"
"gfcadb dfbe dfg egadf gbfaed agbed df dgeacb agefc dfgcabe | fd dbfe dgf bedf"
"efabg gbcfe bcaefd gc gec gcdb efdbc gfdcae ecgbfd cedbafg | cgfeb cdbfae fdaegbc ecg"
"dcfgae dcbgfa gfe fgcad afdeg fdbea ge cgdebaf fgcdbe geac | cdgabf dcgabf edfbcg fdebgc"
"efdacg dbgef defcbg be abgcde dbe cfdge gabfd dafbceg cfeb | fdgbace fdbga bgaedcf dcfeg"
"cfedgba agdbc gfdcab fg fgab fagdc dfcea becgfd adcebg fgd | fg eafdc gdbacf cadbgf"
"dgecbf agedfc af dcbae becgfda dbafe bfgdea fbegd gbaf fea | af ebfdg af abefd"
"afebgd ecbafdg bge bg gcdfe bcdg adcfge ebgcf acefb bedgcf | fecdag fcaeb beg bg"
"bfgdec de efgca cedabf agcbdf gedb dec gbdcf afbgdec gecdf | dcgfb cde fegca ed"
"fegcb ecd egda gcbda fadbec edgcafb adgbcf ed gdbec egabcd | cabedfg fgdebac de egad"
"efcbg cafeb dcafbe ebag gbf bg dgefc ebdafgc bfeacg dbcafg | bg fgecd bfg efgcd"
"cfbg aedfcb bg gdb ecbdg dbfec adcge aebgdf agcbdfe edbcgf | gbd cegbdf fegdbc gcedb"
"fcbgae bdacef aedfg gdcafbe fdebc cbda fdaeb ab eab gbdefc | ab dacb agefd gcbefa"
"gdcfb dfgceb eb feb cfaebg faced fcedgab cbedf gbde fbgacd | feb baecgfd eb eb"
"fbdaegc efcb bdgaef fbgcde dfc bfedg cbgfd egacdf abgdc fc | dgcba cgdfb bgacd gcafbed"
"aegfbc gfdbac abfec efb fceg dfbcage bcdae fe eafdbg bafcg | gfedab fe bcfdga ef"
"fcdbag ecgfabd dgaecb dgcae ed cebd deg egbfda gefac gbacd | de caedg aegbfdc bdcfaeg"
"adfbc eba bedcga becda efcagdb egad gcdebf cgafbe ea dbegc | efcgdba dage bcgdafe ae"
"fbgace gafdc adge cfdegab bfedcg fgeacd gd dgf eacfg fcbda | dgcaf bdafc gacef dg"
"gdecf dge bdcgf fdbgea ebdgfca gfacde cead gecfab de cegfa | edg ed ceda ed"
"cbedf cbeafg edfagb adec bfade cbgdf ce fdecba ecbdagf fce | cbfed fec aced eacd"
"gebac ebdcagf facbdg abcgfe fbc bfgde ceaf cgbeda fc bcfeg | bcf bcf fc bfc"
"facgeb cgfade abc abcdf ceagdfb edbcf ab cdagf abdg bgcdfa | afgdc ba gebfcad dbag"
"fbadgc defac ga egafd ebdfgca dfecba aegc adfgec defgb gda | ag gaec gdafcb dga"
"face cag gdafeb dbagce agecbf gbdcf gbcaf fbeadcg egfab ca | cga ca becfga efac"
"bcgdfa bdgca cgebad fcgb fbedac dgafb dfb faged gbadfec fb | dfbag gdfba fbcg dbf"
"decabg be gdafebc edgfb ecbdfg ecagfd gcedf dbafg geb cebf | fgebcd dcgebaf gcbdea bfec"
"dfaecg gdbea cbd bedcfa gcfbde cbfg dfgaceb gdcfe edgbc bc | bc gcbf edgba bc"
"bgeafc gedfbac dceaf bged fdgbce cgdfb ebc bfecd fcagbd be | cfgbea bec dcgafb adbfgce"
"fde fcea dgefca dfcag abged ef eadfg cdfgeb fgbacd dcefbag | gdacfe cfea fdcbega cagfbd"
"gefdca eb bgdfa adegbc edgcf cfabdeg gfdeb bge befc gedfbc | eb fgdecb dbaegc eb"
"bgadcf aefgb gecdba dcef fgc aegdc cf cafge agdcfe agcfdbe | cf fdcabge fc cgf"
"dfegb fg fadbe gcdefba baefgd cegdaf dcabfe gcedb gef agbf | fabg gabf aefgdb fg"
"eadfc defcb fdabcg dabceg gceadf ea eac eagf gbacdfe dgcfa | cae faecbdg ebgdfac eca"
"adcbgf badfce cfd fdega beafdcg cf caegbd bcgda gdcaf gbfc | cf cfgadb efcbda fabdegc"
"gcd ecdfb abfcde fgdab bcgfaed gc afedgc gbdcf egdcbf ebcg | cdfbge bcedfg gceb gc"
"eadbgf cfgbe bdagf decgfa bdac ca bfagc afbcdg cag acfegbd | ca cag edcgaf abdfgec"
"gcfbea cbeadgf bdcg cd decbga abdce cabge adbfe adgecf cde | gbfeadc cbgd fcedga cbega"
"fc decf abecgf cdeafg adcfg acdbge agbfd decag cgfeadb cfa | cfa cf bgadf eacgd"
"bgafe ae afecbg gcaedb bae cfae ebfcgd cgabfed gbadf egbfc | acef egfab bae befgdc"
"afcdbg aegbd gdbace baecd gd ecgdfab dgb ecgd aebgf baedfc | efdbcag egcd efdacb gbaef"
"afcgbe gdbc agfde cbdega dc dgbeacf dce afebcd acegd baceg | aecgd cde cdgb dgbc"
"fabed egab cfgdea fae bafdgc cfbde ae bgdfa gbacfed gedafb | efbad dafeb eaf fagdcbe"
"dbca agebd gbdcea ebfcadg fgabe bdgcfe eagcdf da gad bgecd | abdc gfbaced gafedc gbfae"
"cgadb ecfadb agb bdgf dbfac bg dcgea dcgeabf fabegc bfdcga | dgfb gb cbagd gab"
"bcadf efad ef gebcafd ebf bgedc bfcgad becfd ebfagc cdbefa | cbafd ebf faed dcfab"
"aegfb gabedcf fbg bf ecfb dbfgca adcgfe afbecg beagd egfac | becf decfga gfb gcafedb"
"gedbc adgcb da adg feabdg gdaefcb fcad bcagef gbafc gbadcf | dgcebfa da bdgce fgabc"
"cdgfeab fdeca bcafde cg dgc abdecg fadcg egcf afdbg ceafdg | dgc gdc ecabdfg fdaceg"
"gdbefa gfacbd dgacfe abcge eacfg dcfe egf gfcad fe gaefbcd | ef edcf egcdfa efgadcb"
"gacd fabed caebg cdbafeg cd ceabd gbdcae edc dgbefc abcgfe | dec cgda dc cde"
"bgae agedcb caged dfcaegb gcb dcbag dfaceg cfdab fecdgb bg | abcgd ageb adgcfbe beag"
"cdbgf dfbagc cfd cegbd bfdag agbefd gcfa fc fbecda fedcabg | gcfdba cfag aegcdbf gfac"
"gedca efab gcdfab bdeca ecdbagf ab befdc bad abecdf efgcdb | faecgdb ab egacd acged"
"eaf agebf abfcg edga debfag ae befgd dabfecg dfebca edfgbc | ea aef agde ecdfabg"
"gdceab dcafgeb ecfgda ef fdbag fbdge fge edgcfb edbcg bcef | gef cdbgfe bedcfg ebcf"
"cdgbfa fgbec gbdefc acef ebagd ac acbdegf bca ecgba ecbgfa | bcgafd gafecb ca ca"
"bdaecg cfbg bgdef cfead feabgd gce gc bcdfgea egfcd efcbgd | dceagb befgdc gc cg"
"dfaecb gbfde gefad gbae bfegdc cafgd ae fae gcfaedb bdagfe | ea gfdaeb bfadeg bfecdga"
"efa geadf fa bcgafe cagedf dcaf badge cebgdf fcgde fbdaegc | fea afgedc fa cgfde"
"cebdga de baedgfc cdagfb ecdfg ebgfdc cdgbf dec efbd efcag | egacf bgcdf ed eacfgbd"
"edac gaebdf afdeg agedbcf acdfge ec fce egfac cebdfg afgbc | fbegcad ce gfcab cdfage"
"dfaeb edfgb ebg debcgf fedcg gebacd facgde fbgc cadbgfe gb | bfdge gbcf cdgbef fbgc"
"gc ecgfbd bagfd fgabc gcda gedbfac aefbc bfcagd fadegb gcb | efabc cgda deagfcb gbfedc"
"gbdea cgefadb gacd ged aebdf gd cgeab eacgbf fbecdg dbacge | dfgbeac dgca faebgcd cbdeag"
"fdabc bgecf dgab fbaegcd gadbcf fagced cfdabe gaf ga facbg | fdeabc gfbadc gaf cgdbeaf"
"cbagde cbdefg ad afegb eagdfc fegad dgfce acgebfd dafc agd | fcad eagdbc gda efgda"
"egcfa adgbe cdfega cebgadf gebcfd bc begac bafc ecb abgfce | ceb egbdcaf edfbcg bafc"
"dfg gcad dg dcagfbe baefd fdgeac fegac dfbgec cfebag afged | ceafg agcd gadef ecdgbf"
"eag ea agedbc gafced bcea abgcdef edagb bacgfd dgbac bfegd | acdbeg fagedc aecb abce"
"eacgf defgcb dfc fagdebc ecgabf fd dcgefa edaf dcgaf bdcag | cegaf cgdaf eadf bcgedf"
"ecbda ebdf bf cfb fgbcad abedfc abegdc gfeca fbaec dbacefg | fcb egdbac badcge dceba"
"eagcdfb cfgea cebd cgfdba cbgae eab acbdg eb bceagd gbfeda | abgdce agefdb edfbag fagdbc"
"decfb gecbafd gefabd gebda efgacd gf egabcd begfd fdg bfga | fg cegabd efbdcga gf"
"gfce fed febcd ef gacfbd debac adcfebg fdabge gcedbf gbcfd | ef cgbfad fed eabcd"
"fda gedbf edgca af ceafdb efgda agedcb acgf bgdceaf acedgf | fda fbdace cgfa debfg"
"gdebca dgcab acgf cf bfdacg fdbegc bfc efbda bgcdafe dafbc | gcebdf cf fcb gebcdf"
"ecgfdb dbae fagdce fbeag ea afgdceb bfaedg fea bedfg cfbga | eaf dbgef ea bfaegdc"
"daegfc dfebc cgebf cbaefd dcf ecgdfba dc gadbef aebdf adbc | gedfba gcdabef abedfc dc"
"edfbag cdeabf decafbg acfgb ac fbcaeg acf gaec fegba cbfdg | cega dbfagec ebgafd cgae"
"fgabde ecagf fcdae agfbcd ge abfgc gcbe gea dfegcba ebcagf | cfaegdb gebc acfed ge"
"dgaebc cgb fgbedac debcaf gc dgfc gcbadf afdcb fegab fbacg | gbecda cbfadge gbc fbcdae"
"egdbc gbcaedf bcf afbg ebfgc bf bagcfe gecadf cefag dafbec | gbcfe dbaecf decfgab fb"
"befgd caef fgc fdeagc ecgda dcbfag fc acebdg dfceg cgfebda | fc eagdc cf cafe"
"cgabf acegdf gbadec deaf dcage cfaeg cbgfade egf ef decfgb | cgefdb decabg adceg cgedab"
"bdce gdfce cbgafd cbdfge facdbeg fce bfaegc fgbdc ce gfeda | agdef ebgfcd fbdcg dfegc"
"gca bage ga fcedg fbcedga cagbfe cfbae cfbadg facdeb egacf | agbcdef agc gca ga"
"efgab ce adec ebagcd abdgc abgec bfacgd gbefdc efdacbg ebc | ec egacbdf agfebdc beagf"
"be fcdeag gcebad adcbe ebcfagd eba ecbg dcfba adegc edgafb | ebgdaf ebgc dgcfea cebadg"
"febgad geda dagecfb abdfe fbcga dbgaf efgcbd dg dgf cdfabe | gaed adge gdae gaed"
"fe gbcdaf cfdgae begdf agdbf bdgec bfegad fabgdce bfae gef | gfadbe beaf agfdec egf"
"gcbef cegabd cgebdf dbcge abgfe cf cdfb fgc gbcdefa agfdec | gcf fgc bedgac dbcf"
"fcbed dfgeab becdagf egabf fac gafcdb ca cega becfa fceagb | cdbfag cfa bfagcd cfedb"
"efabgd bgfea ebacdfg afb cfebgd ebdfg af agceb dafceb fagd | fa fbdage afb dafgeb"
"agb ba fedbgc geabcd fgead fcab fadgceb afbdg cdbfag cdgbf | abcdge ab ab agedcb"
"bfega feadbg fgbc cgfeabd cfa abcfe afcebg acdeb cf cfaedg | fgbc fac acf dgafce"
"egfba fdbeag fda ebdf agbfd fd ecfadg bgcfea bacdg fgeabdc | faebgd gfeba eabgf fadgb"
"decgbfa dcfbag bgf abdg bg ebgfca gfedc bafcd fabcde gbcfd | gb fgecd dgecf gbf"
"gcbaef cfgead fb acdbfeg acbf gcfea gebcf ebgcd degabf fgb | gaedfbc bf cgefa cbgfead"
"gfc abcfged edgbfc egafcb fc dbgefa acfb gbeaf aefgc ecagd | fc bgeaf gcf cfba"
"ecadfb cegbf cedbf egb edbagfc gbfdea gb feagc bdgc dgfbec | bcfed efcbg gb bg"
"gbfa fa dcbegf dagce bgdface dcafg bdfcg cfa bdgacf fdecab | fgbcda bedcfg cfa gafebdc"
"afbd gcdeb agecdf dafbeg ebfga cfgaeb fed dbgfe bafgecd fd | df afdb edf gcbed"
"fgcedb cbg bcfgead agdb dbaegc gcaeb aedcg bg ecbfa fgdeac | bg acgbe bg gb"
"dgacf bf fbd afbcd afgb dbafcg ebafdgc fadgec dfegcb cdeba | bdf fgab fbd bfga"
"daecg dabecgf edfagb fcagd cadbgf dabfec bfgc gbadf dcf fc | bafedcg afgcd cdage dcafg"
"cgafbd beadgc fagbc afb bf gbdca gafce fbdg fgdceba efdbca | cfgbad fab abf bfa"
"febgd cfdge fcda gbdacfe fc cagde degfac cbedga fabceg fce | ecf befdg cdefg fc"
"dcaf agecdb dgfbcea cgeadf faegb gecda dgafe fd bedcgf dfg | daegc bcdeag cfad fdgea"
"dbgea acdeb ecabdg fadce begafc abc dbgc defagcb cb fabged | agdbcfe cagbef dacgbe deacf"
"fdbge ae caedfg ade agbfcd ebca egadcfb dcabf fedcba daefb | aebc caeb dea bdefg"
"edab cda fedacb da gbdecf dcgefa fbced acfgb cbafd bacgefd | afegbcd cfebdga ad fgaecd"
"afgbd cedga cgabd cb bcdfea fgabdc cfbg gcbdefa fdageb bac | efcdabg bfegda cba abdcfe"
"gfdcab ceg adgbc aefcd gedca cebfga ge ebgd gfaebcd degcab | edfgbca eg gebd gdbe"
"eafgcb afcbd egbfa dfge fedabg gd fabgd cgbeda dgb aebcdgf | dbg bafeg cegbdaf fdge"
"cefdg edbfacg cb fabced dgfba bfcgd cdb dcbagf bfadeg acgb | dfeabg abcg bceafgd cbd"
"bac bagcf acge cbdgf cafedb gafecb fbgae agbecfd ca agefdb | cage cfdgbea fgebca bafgc"
"bgeacd cbd dgcfeb db bfeac aefdgc fbcedga cfdeb gbdf efgdc | befca dcfeb gedafbc dbc"
"dbcaefg fadec abfdge gcde ecf ceagbf efadg ec acfdge cfabd | febdag fdage acdefgb cef"
"badgfc fad eafbc fbdcge fbdge dgae eadbf abedgfc da fbdgea | edbgf gbfcde baecf dfgbce"
"ce bgefad fecg bedgac dce badcf degafc deagf baegdfc cedfa | ec egfda dce cfeg"
"gadcbe afebg edgbfc fcad fgcebad fce cf fedcba faceb beacd | cef acegbd dafc adcegb"
"cagfde dbgcaf baecfd gdebcfa dce cbfde de bgefc bcdfa abde | ebdfagc abgcdf adbe cde"
"bcaedgf agecb eadgbc egda gbcfed aebcd cdabf ed fgbeca deb | fadcb edcba gcfedab adbegfc"
"fcgedba cadegb ecdgbf eabcf ga fabdgc cgbed agb dgae abecg | ebdgc abg ceafb cbfae"
"badcg gdafb dacbgf aegbf fcegadb gcdf afd fd adcbeg defcba | df dacbg cfgd agbedc"
"bfdc cb gbfad agefbd aegfc gbc agcdbe adfcbg bedcfga cgbaf | bcg dgbaf cb egafdb"
"bfea aecdb ebdcaf cfb bf gdcfeba cefdg aedgbc bedcf afcbdg | beagdc fb befa ecdab"
"cabd egfadc cd abdfgec decfb bdgeaf cfd fbdae gcfbe ebfdac | afbcged cd bdafec dc"
"cgbdafe fdabce cbfgda gb befgca dcagb bfgd acdbf agecd gba | aebgfcd bg dbgac dfgb"
"gecdafb fe bfdea gbfda bef fceabg adbec degf agebfd afcdgb | bafedg fged fecgabd bgcafe"
"becadf decga ca adc cgadfeb gadfeb deagb gcba decgf gabdce | cad acd egdca adc"
"dbaef dagbef cegafb baf gcfbeda fgdb baged efcda bceadg bf | bgdae fb bfcage gdefab"
"deagbc bedfg gdafcb dcgafeb cg ecdfab cedbg gcea edabc gcd | ecga gabfcde gcea gc"
"bdfacg cbdag ecdga cebdag geab ea eda begcadf ebfadc gcfed | dea dea dabcg fbgadc"
"dcga ceafb facbg fgdacb gc fdgecb adgebfc degbaf cgf dbgaf | fcg aefbc gfc dgac"
"efacgd gabdfe bagd bdfec begacf afgbe da fad ebafd fbgeadc | eafdb agdbef bagd adbgfe"
"acdgbe eb cfbe gfebca fedagbc bge gefab gcdaef agfdb cfgea | bfcagde fgabd befc afebg"
"fgedc cfabged bc ebac acbdeg gcedb eabfgd bgc dgabe badcgf | gcb abec efabdcg beca"
"ebcfgd cbdgaf dbcga facbegd da dga fcad ebcga bcfdg bgdefa | bcgae gcadb da agd"
"gdeba gbc gc abgec befdga dagcbe bdcagf cbfae cegd bfgaecd | cg dageb egcba gc"
"cgaeb acgbed cbade abefgcd fdgcba aged edbfc adb da cagfbe | agde aegfbdc da acebd"
"deb caefgd eb eacb egdca dgcefba dgabfe gdbce cbaegd fgbcd | ecgad egbcda fgbdc ebd"
"aegfbd bdeagfc facg cgebf abfecd edgcb cef fc agefb gbcefa | cgadfeb fce gcfa fbdega"
"degafcb cdgbef efdb cbegd fgadce acfgb cfe begcf cdabeg ef | egfacbd bafcg fe caedgf"
"cbfeadg fceba bcdegf fb ebf eadcf egcab egfcda fedbac fdba | abecg gaceb fgadebc cadefb"
"efacb cb cgbe afdegb agebf abc cdebafg fcbage cafed abfdcg | bc bceg aedcf cdgbeaf"
"dabcefg geafb eadg cfedba dgeabf fdgba adf ad fbdcg eabgcf | fgdcb edag bedfca aegbf"
"gcdbefa bag dbafg aecfbd ag beafgd cfgbd aegf gabedc aedfb | ga deagbc bagfd afedbg"
"gefdba ea gcdbea adgef abef efcbgd gae egdbf cdgfa cdagbfe | gea feba abfe afbe"
"bcfag eafdbcg feagc defbgc bdgeaf gbc gbacfd adcb dgfab cb | bc dfagb ceabgfd bacd"
"cadgfe gefbd bg cdfge ebfdgc bgdafce gdb cgfb fedab gcdeab | bg dgb bedaf dbgfcae"
"afcdb dcbg eacdf agbfec gbacf bd fdb dcbgeaf befdga gabfcd | bcgaf cbfaeg cfdab bcfad"
"cebfdag cgafe cdfbe abfec fegabc fdaecg ab eab aegcdb fbag | egcaf eba gbaedc dbgfcea"
"cbdge gcbdea bdg cbaed defcg ebag gbcdeaf agbdfc bg ecafbd | ageb aebg gb fecbad"
"dgc gbcad bdafgce cedagf dfbg abcefd dg abgcfd abceg afcdb | gfdb eagbc efdbac dgc"
"fgdab egdbcaf dbagfc efbadg ge egcdfb cabfe fbage gead geb | gbe adcfgbe ebg beg"
"bgfd cbafegd dcabe gfcba dagefc gda ecfabg dg bcadfg bcgad | caebd cdgba acgdef gfecbda"))
#+END_SRC

#+RESULTS: day8-input
: advent/day8-input

#+NAME: day8-solution
#+BEGIN_SRC emacs-lisp :session day8
    (defun advent/find-1478s (input)
      (let ((summ 0))
        (dolist (line input)
          (let* ((segments (split-string line "|"))
                 (digits (split-string (cadr segments))))
            (setq summ (+ summ
                          (length
                           (seq-filter
                            (lambda (x) (let ((len (length x)))
                                          (or (= len 2)
                                              (= len 3)
                                              (= len 4)
                                              (= len 7))))
                            digits))))))
        summ))

    (defun advent/deduce-digits (input)
      (let (zero one two three four five six seven eight nine (summ 0))
        (dolist (line input)
          (let* ((segments (split-string line "|"))
                 (digits (mapcar #'string-to-list (split-string-and-unquote (car segments))))
                 (unknowns (mapcar #'string-to-list (split-string-and-unquote (cadr segments))))
                 numbers)
            (setq digits (mapcar (lambda (elem) (sort elem '<)) digits))
            (setq unknowns (mapcar (lambda (elem) (sort elem '<)) unknowns))
            (setq unknowns (mapcar #'concat unknowns))
            (setq one (car
                       (seq-filter
                        (lambda (elem)
                          (= (length elem) 2)) digits)))
            (setq digits (remove one digits))
            (setq eight (car
                         (seq-filter
                          (lambda (elem)
                            (= (length elem) 7)) digits)))
            (setq digits (remove eight digits))
            (setq seven (car
                         (seq-filter
                          (lambda (elem)
                            (= (length elem) 3)) digits)))
            (setq digits (remove seven digits))
            (setq four (car
                        (seq-filter
                         (lambda (elem)
                           (= (length elem) 4)) digits)))
            (setq digits (remove four digits))
            (setq six (car
                       (seq-filter
                        (lambda (elem)
                          (and (= (length elem) 6)
                           (= (length (cl-intersection elem one)) 1))) digits)))
            (setq digits (remove six digits))
            (setq three (car
                       (seq-filter
                        (lambda (elem)
                          (and (= (length elem) 5)
                               (= (length (cl-intersection elem seven)) 3))) digits)))
            (setq digits (remove three digits))
            (setq nine (car
                         (seq-filter
                          (lambda (elem)
                            (= (length (cl-intersection elem three)) 5)) digits)))
            (setq digits (remove nine digits))
            (setq zero (car
                        (seq-filter
                         (lambda (elem)
                           (= (length elem) 6)) digits)))
            (setq digits (remove zero digits))
            (setq five (car
                        (seq-filter
                         (lambda (elem)
                           (= (length (cl-intersection elem six)) 5)) digits)))
            (setq digits (remove five digits))
            (setq two (car digits))
            (setq numbers `((,(concat one) . 1)
                            (,(concat two) . 2)
                            (,(concat three) . 3)
                            (,(concat four) . 4)
                            (,(concat five) . 5)
                            (,(concat six) . 6)
                            (,(concat seven) . 7)
                            (,(concat eight) . 8)
                            (,(concat nine) . 9)
                            (,(concat zero) . 0)))
            (dotimes (e 4)
              (setq summ (+ summ (* (cdr (assoc (nth e unknowns) numbers)) (expt 10 (- 3 e))))))
            )) summ))

  (advent/deduce-digits advent/day8-input)
#+END_SRC

#+RESULTS: day8-solution
: 989396
** Day 9
#+NAME: day9-input
#+BEGIN_SRC emacs-lisp :session day9
  (defconst advent/day9-input
    [[2 1 2 7 8 9 7 6 7 8 9 9 8 6 7 6 8 9 4 3 1 3 9 8 7 6 4 3 1 3 4 7 8 9 8 7 6 5 4 3 4 3 4 9 8 7 6 7 8 9 3 2 3 4 5 9 6 5 4 2 1 2 9 8 9 8 9 9 9 8 7 4 3 2 1 0 1 4 5 9 8 9 6 5 3 4 5 6 7 8 9 5 4 3 2 1 2 4 5 6]
     [1 0 5 6 7 8 9 5 6 9 8 7 6 5 4 5 6 7 9 5 2 4 5 9 8 8 5 4 5 4 5 6 8 9 7 6 5 4 3 2 1 2 3 9 9 6 5 6 7 8 9 1 9 5 9 8 9 5 3 1 0 1 9 7 6 7 8 9 9 8 6 5 4 3 5 9 2 3 9 8 7 9 5 4 2 3 4 5 6 9 9 7 6 5 4 0 1 3 4 7]
     [2 2 4 5 8 9 3 4 5 8 9 8 9 4 3 4 7 8 8 9 6 5 6 9 9 9 6 7 8 7 6 7 8 9 8 9 7 6 4 3 4 3 9 8 7 5 4 6 9 9 9 9 7 9 7 6 8 9 9 2 3 9 9 8 5 8 7 8 9 9 7 6 5 4 9 8 9 9 8 7 6 5 4 3 1 2 3 4 5 6 9 5 4 3 2 1 2 3 9 8]
     [9 4 9 9 9 1 2 9 6 7 8 9 8 3 2 3 5 6 7 9 7 6 9 8 9 8 7 8 9 8 7 8 9 5 9 9 9 6 5 4 5 4 5 9 9 7 3 4 8 9 9 8 6 5 4 5 6 7 8 9 9 8 7 6 4 5 6 7 8 9 8 7 6 9 9 7 4 3 9 8 7 6 5 1 0 1 2 3 4 7 8 9 5 4 3 9 4 9 8 9]
     [8 9 7 8 9 0 9 8 9 8 9 8 7 4 5 6 9 7 8 9 8 9 8 7 6 9 8 9 9 9 8 9 5 4 9 8 9 8 9 7 6 5 6 7 9 7 6 5 7 8 9 7 5 4 3 4 8 9 9 1 0 9 7 5 3 4 5 6 9 9 9 8 9 8 7 5 4 2 1 9 8 7 3 2 1 2 3 5 5 8 9 7 6 5 9 8 9 9 7 8]
     [7 5 6 7 8 9 9 7 8 9 8 7 6 5 6 7 8 9 9 9 9 8 9 6 5 3 9 9 9 6 9 8 9 3 9 7 6 9 9 8 7 6 7 9 9 8 7 9 8 9 7 6 7 0 1 5 6 7 9 9 9 8 6 3 2 4 5 9 8 8 9 9 8 9 9 6 4 1 0 1 9 8 9 3 4 3 5 6 6 7 8 9 7 8 9 7 8 7 6 7]
     [4 3 4 8 9 9 8 6 7 8 9 8 8 9 9 8 9 6 7 8 9 7 8 9 4 2 1 9 8 5 6 7 8 9 9 8 4 5 8 9 9 8 9 9 9 9 8 9 9 6 5 4 3 2 3 4 8 8 9 8 7 6 5 2 1 2 9 8 7 6 9 8 7 9 8 9 3 2 1 2 3 9 7 6 5 4 7 7 8 8 9 9 8 9 8 6 9 9 4 5]
     [5 4 5 7 8 9 7 5 6 7 8 9 9 6 5 9 4 5 6 9 8 6 7 8 9 9 9 8 7 4 5 6 9 6 9 4 3 4 6 7 8 9 6 8 9 9 9 9 8 7 6 5 4 5 4 5 9 9 9 8 6 5 4 3 0 9 8 7 6 5 4 3 5 6 7 8 9 3 2 3 4 9 8 7 6 5 6 7 9 9 3 4 9 7 6 5 7 8 3 4]
     [6 6 6 7 8 9 5 4 5 6 7 8 9 5 4 2 3 9 9 7 6 5 4 9 8 8 9 9 5 3 4 7 8 5 8 9 2 3 5 6 7 9 5 7 8 9 0 1 9 8 7 6 5 6 5 6 7 9 3 9 7 6 5 3 1 2 9 8 7 6 5 6 6 7 8 9 6 4 9 4 9 8 9 8 7 8 9 9 2 1 2 9 8 7 5 4 5 1 2 5]
     [7 7 7 8 9 4 3 3 4 5 8 9 5 4 2 1 9 8 9 8 7 3 3 4 7 6 7 8 9 2 1 2 3 4 7 8 9 4 6 7 8 9 3 5 7 8 9 2 3 9 8 9 8 7 9 7 9 9 2 9 8 8 5 4 2 3 4 9 8 7 8 7 9 8 9 8 7 9 8 9 8 7 8 9 8 9 3 4 9 2 9 9 7 6 3 2 1 0 1 6]
     [9 8 9 9 3 2 1 2 5 6 7 8 9 5 9 2 9 7 6 4 3 2 1 3 4 5 6 9 4 3 2 3 4 5 6 7 8 9 8 9 9 2 2 4 5 9 8 9 4 5 9 6 9 8 9 9 9 8 9 8 9 9 7 6 3 4 9 9 9 9 9 8 9 9 9 9 9 8 7 5 4 6 7 6 9 8 9 9 8 9 8 7 6 5 4 3 2 1 3 5]
     [2 9 9 9 4 3 2 3 4 7 8 9 9 9 8 9 8 7 6 5 4 1 0 1 5 6 7 8 9 4 3 4 5 7 9 8 9 9 9 3 2 1 0 9 9 8 7 8 9 9 5 4 5 9 9 9 8 7 6 7 6 8 9 7 4 9 8 9 8 7 6 9 6 7 8 9 9 9 8 4 2 3 8 5 6 7 8 9 7 6 9 8 9 8 5 4 3 2 3 4]
     [1 3 9 7 9 5 4 4 5 9 9 9 9 8 7 5 9 8 7 7 6 3 2 3 7 7 8 9 6 5 5 6 9 8 9 9 9 8 7 5 3 9 9 7 6 6 5 6 7 8 9 5 7 9 8 9 7 6 5 4 5 7 8 9 9 8 7 9 9 6 5 1 5 5 6 9 8 7 9 2 1 2 3 4 5 6 7 8 9 5 4 9 8 7 6 5 4 6 5 9]
     [2 9 8 6 8 9 6 5 9 8 9 9 9 9 6 4 3 9 9 8 5 4 3 4 6 8 9 8 7 6 7 7 8 9 4 3 2 9 7 6 9 8 7 6 5 4 3 5 6 7 8 9 9 9 7 9 9 5 4 3 4 9 9 7 6 7 6 7 8 9 4 0 3 4 9 8 7 6 5 4 2 3 4 7 6 8 9 9 1 2 3 5 9 9 9 6 5 7 6 7]
     [9 9 9 5 7 8 9 9 8 7 9 8 9 5 4 3 2 9 8 7 6 5 6 5 7 8 9 9 8 9 8 9 9 4 3 2 1 0 9 9 7 9 8 7 6 5 4 6 7 8 9 8 8 8 6 7 8 9 7 5 9 8 8 7 5 4 5 6 9 3 2 1 2 9 7 9 9 9 8 5 3 4 5 8 9 9 2 1 0 3 4 5 9 8 7 9 6 8 7 8]
     [8 8 5 4 6 9 9 8 7 6 5 7 8 9 5 4 3 6 9 9 8 7 8 6 7 9 9 8 9 7 9 4 9 8 7 5 2 1 9 7 6 7 9 8 7 6 8 7 8 9 9 7 6 7 5 7 8 9 8 9 8 7 6 5 4 3 4 5 7 9 4 3 9 8 6 5 9 8 7 6 5 7 6 7 8 9 3 2 1 2 6 7 9 8 6 8 9 9 9 9]
     [7 6 5 3 9 8 6 5 4 3 4 5 7 9 6 5 4 5 6 9 9 8 9 7 8 9 9 7 6 5 4 3 4 9 5 4 3 9 8 6 5 6 5 9 8 7 9 8 9 8 7 6 5 5 4 6 7 9 9 5 9 8 7 6 3 1 2 3 8 9 9 9 8 6 5 4 5 9 8 7 6 8 7 9 9 8 7 4 2 3 5 9 8 7 5 7 8 9 2 4]
     [8 7 6 2 3 9 9 8 7 4 6 6 8 9 9 6 7 8 9 8 9 9 9 8 9 8 9 8 7 6 3 2 9 8 7 6 5 7 9 9 4 3 4 5 9 8 9 9 9 8 7 7 3 2 3 4 8 8 9 4 9 9 4 3 1 0 1 2 4 9 8 7 6 5 4 3 3 2 9 8 9 9 9 9 8 7 6 5 3 9 9 7 9 5 4 5 6 8 9 9]
     [9 8 2 1 2 9 8 7 6 5 9 7 8 9 8 9 8 9 9 7 8 9 4 9 8 7 9 9 8 2 1 0 1 9 8 7 9 9 9 8 9 4 5 6 8 9 7 9 8 7 6 5 4 3 4 5 6 7 9 9 8 6 5 4 3 2 3 3 4 7 9 9 7 7 2 1 0 1 2 9 8 7 9 8 9 8 7 6 9 8 7 6 5 4 3 4 5 6 7 8]
     [5 4 3 2 3 4 9 8 7 6 7 8 9 6 6 7 9 8 7 6 8 9 2 3 4 6 7 9 9 3 2 9 2 3 9 9 8 7 6 7 9 7 6 7 9 7 6 6 9 8 7 6 5 4 5 6 7 9 2 3 9 9 6 7 4 5 7 6 5 6 9 8 5 4 3 2 3 2 3 4 9 5 4 7 9 9 8 9 9 9 8 9 7 3 2 3 4 5 9 9]
     [7 6 5 3 6 5 6 9 8 7 8 9 6 5 4 9 8 7 6 5 1 0 1 3 4 5 6 9 8 9 9 8 9 4 9 8 7 6 5 6 9 8 8 9 8 9 5 4 5 9 9 8 7 6 6 7 8 9 9 9 9 8 9 6 5 6 9 8 6 9 8 7 6 5 5 4 5 3 6 5 8 9 3 5 6 9 9 9 8 6 9 7 6 5 3 4 5 6 7 8]
     [8 9 9 5 7 6 7 9 9 8 9 9 7 4 3 2 9 8 9 4 3 2 2 4 9 7 8 9 7 8 9 7 8 9 9 9 8 9 6 7 8 9 9 8 7 9 4 3 9 8 9 9 9 8 7 9 9 9 8 8 8 7 8 9 6 8 9 9 7 8 9 8 9 8 6 5 7 8 7 6 7 9 2 7 7 8 9 7 6 5 9 8 8 7 8 9 7 7 9 9]
     [9 9 8 9 8 9 8 9 9 9 9 8 7 6 4 3 9 8 7 5 4 3 6 9 8 9 9 7 6 7 5 6 7 8 9 1 9 8 7 8 9 8 8 7 6 8 9 9 8 7 8 9 9 9 8 9 9 7 6 7 5 6 8 9 8 9 3 9 8 9 9 9 8 9 7 6 7 8 8 7 9 2 1 2 5 7 8 9 5 4 5 9 9 8 9 9 8 9 8 9]
     [7 8 7 8 9 9 9 9 9 7 8 9 8 9 5 4 5 9 9 6 5 4 5 6 7 8 9 8 5 4 4 5 7 8 9 0 9 9 8 9 6 7 7 6 5 7 8 9 6 5 7 9 9 9 9 9 8 6 5 2 4 5 9 9 9 3 2 1 9 9 8 6 7 9 8 7 8 9 9 8 9 1 0 1 4 8 9 8 9 5 6 7 9 9 4 4 9 6 7 8]
     [6 5 6 7 8 9 9 8 7 6 7 8 9 8 6 7 6 9 8 7 6 7 8 9 8 9 8 7 6 2 3 5 6 7 8 9 8 7 9 6 5 4 3 5 4 6 9 7 6 4 6 7 8 9 9 8 7 5 3 1 2 6 7 9 5 4 9 9 8 9 7 5 6 7 9 8 9 1 0 9 5 4 3 2 3 4 5 7 8 9 7 8 9 2 3 2 3 5 7 9]
     [5 4 5 6 7 8 9 8 6 5 7 9 8 9 8 8 7 8 9 8 7 8 9 1 9 8 7 6 5 4 4 8 9 9 9 4 4 5 9 8 6 5 2 1 2 5 8 9 4 3 5 6 7 9 9 9 6 4 3 0 3 5 7 8 9 9 8 7 7 5 6 3 5 6 6 9 8 9 2 9 8 5 4 5 4 7 6 8 9 9 8 9 2 1 0 1 2 3 5 7]
     [6 5 7 8 9 9 8 9 7 4 5 6 7 8 9 9 8 9 4 9 8 9 3 2 3 9 8 9 8 7 5 6 7 8 9 3 2 9 8 7 6 5 4 0 3 4 6 8 9 1 6 7 8 9 9 8 7 5 2 1 3 4 6 7 8 9 9 6 5 4 4 2 3 4 5 6 7 8 9 8 7 6 5 7 9 8 9 9 6 5 9 4 3 4 2 2 3 4 5 6]
     [7 9 8 9 9 8 7 8 9 6 6 9 8 9 9 9 9 2 3 8 9 9 5 6 9 9 9 7 9 8 7 8 9 9 3 2 1 2 9 8 5 4 3 1 2 5 6 7 9 8 7 8 9 0 1 9 8 7 8 2 4 5 6 9 9 9 9 7 6 3 2 1 4 8 7 8 9 9 6 9 8 7 8 9 7 9 9 9 5 4 9 6 4 5 3 9 4 5 6 7]
     [8 9 9 9 8 7 6 7 9 7 8 9 9 8 8 9 2 1 2 6 8 8 9 9 8 9 7 6 4 9 8 9 7 6 4 9 0 1 2 9 6 5 4 3 4 6 7 8 9 9 8 9 8 9 9 9 9 9 4 3 4 5 9 8 8 9 9 8 7 4 3 2 3 9 8 9 3 2 4 9 9 8 9 5 6 7 9 8 9 9 8 6 5 6 9 8 9 6 7 8]
     [9 4 5 9 8 6 5 9 8 9 9 8 7 6 7 8 9 2 3 5 6 7 9 7 7 8 9 7 3 1 9 9 8 7 9 8 9 9 9 8 7 7 6 6 5 8 9 9 1 2 9 6 7 9 8 8 9 8 9 4 5 9 7 6 7 8 9 9 8 5 4 3 4 7 8 9 9 0 9 8 6 9 8 6 7 9 8 7 8 9 9 8 6 8 9 7 8 9 9 9]
     [1 2 9 7 6 5 4 5 7 8 9 7 6 5 6 7 8 9 4 5 9 9 7 5 6 9 9 9 4 2 3 4 9 8 9 7 6 8 9 9 9 8 9 7 6 9 2 1 0 1 4 5 9 8 7 7 5 7 8 9 9 8 6 4 5 6 7 8 9 7 5 6 5 6 9 9 8 9 7 6 5 4 9 8 9 8 7 6 9 7 8 9 7 9 8 6 7 8 9 9]
     [2 9 8 4 5 5 3 5 6 8 9 9 7 4 5 8 9 6 5 9 8 7 6 4 9 8 9 9 5 6 4 9 9 9 9 8 5 6 8 9 7 9 0 9 8 9 9 2 1 2 3 6 9 8 6 5 4 6 7 8 9 6 5 3 6 7 8 9 9 8 9 8 7 7 8 9 7 8 9 9 4 3 2 9 9 8 6 5 8 6 7 8 9 9 7 5 6 9 8 9]
     [9 8 7 3 2 1 2 7 7 9 9 9 8 5 6 9 8 7 6 7 9 9 5 3 4 7 6 8 9 7 9 8 9 9 9 7 6 7 9 7 6 5 2 4 9 9 8 9 2 9 5 9 8 7 7 4 3 5 6 7 8 9 5 4 7 8 9 7 6 9 1 9 8 9 9 3 5 6 7 8 9 4 9 8 9 7 6 4 5 5 6 7 9 8 9 7 9 8 7 8]
     [9 7 6 2 1 0 2 3 8 9 9 8 7 6 7 9 9 8 7 9 9 8 4 2 3 4 5 9 9 9 8 7 8 9 9 8 9 8 9 8 7 4 3 9 8 8 7 8 9 8 9 8 7 6 4 3 2 3 4 8 9 7 6 9 8 9 9 8 5 4 3 9 9 2 1 2 4 5 6 7 8 9 8 7 6 5 5 3 5 4 5 7 8 7 8 9 8 7 6 5]
     [8 7 4 3 2 1 2 3 8 7 8 9 8 7 8 9 1 9 9 9 8 7 5 1 5 7 6 7 9 9 7 6 5 7 8 9 2 9 9 7 6 5 9 9 7 5 6 9 8 7 8 9 8 7 5 2 1 2 5 9 9 8 7 8 9 9 8 7 6 5 9 8 8 9 2 4 5 6 7 8 9 8 7 6 5 4 3 2 1 3 4 4 5 6 7 8 9 9 5 4]
     [7 6 5 6 3 2 6 4 5 6 8 9 9 8 9 3 2 4 5 6 9 7 6 2 3 4 9 9 9 8 7 5 4 5 9 4 3 6 9 8 9 9 8 7 5 4 8 9 4 6 7 8 9 8 7 1 0 1 2 7 8 9 8 9 9 9 9 8 9 9 8 7 6 7 9 9 7 7 9 9 9 9 8 7 4 3 2 1 0 1 2 3 6 7 8 9 9 8 9 3]
     [8 7 6 6 5 4 6 5 6 7 8 9 9 9 9 4 3 5 7 9 8 6 4 3 4 9 8 9 8 9 7 6 5 7 9 5 4 5 6 9 8 7 9 6 4 3 2 5 3 4 5 9 9 9 8 2 3 4 5 6 7 8 9 9 8 7 8 9 9 9 8 6 5 6 7 8 9 9 9 9 9 8 7 6 5 4 3 2 1 3 3 4 5 6 7 8 9 7 6 2]
     [9 8 9 8 7 5 7 8 7 8 9 4 8 7 8 9 4 6 9 8 9 7 8 9 9 8 7 8 7 9 8 9 9 8 9 6 8 6 9 8 7 6 5 4 3 2 1 0 1 2 6 8 9 9 9 4 5 5 6 7 8 9 9 8 7 6 7 9 9 8 7 6 4 5 6 9 8 9 8 9 1 9 9 8 7 5 4 3 2 4 5 7 7 7 8 9 9 8 4 3]
     [9 9 9 9 8 6 8 9 9 9 2 3 4 6 7 9 5 9 8 7 9 8 9 8 9 7 6 5 6 8 9 2 0 9 9 7 9 9 9 9 8 7 6 9 5 4 2 1 6 9 9 9 4 9 8 6 7 7 9 8 9 8 9 3 4 5 6 7 8 9 3 4 3 6 9 8 7 8 7 9 3 4 5 9 8 6 5 4 3 5 6 8 8 9 9 6 7 9 5 5]
     [8 7 9 9 9 7 8 9 2 0 1 3 4 7 9 7 6 9 9 6 7 9 9 7 6 7 7 4 9 7 8 9 9 9 9 8 9 8 8 7 9 8 9 8 7 5 4 2 5 8 8 9 5 9 9 7 8 9 5 9 8 7 5 4 6 7 8 9 9 3 2 0 1 7 9 9 6 5 6 8 9 5 6 7 9 9 7 5 6 7 7 9 9 2 4 5 9 8 9 6]
     [7 6 7 8 9 8 9 3 2 1 2 9 5 9 8 9 9 8 9 5 6 9 8 6 5 4 4 3 7 6 9 9 8 9 9 9 8 7 6 5 4 9 2 9 9 5 4 3 4 6 7 8 9 8 9 8 9 3 4 8 9 8 6 6 8 9 9 9 9 4 3 1 9 9 8 7 5 4 5 7 8 9 8 9 9 8 9 6 7 8 9 9 9 1 2 9 8 7 8 9]
     [8 5 8 9 9 9 5 4 3 9 9 8 9 8 7 8 9 7 6 4 9 8 7 7 8 3 3 2 3 5 6 6 7 8 9 9 9 9 7 4 3 2 1 2 9 7 5 6 7 8 8 9 4 7 6 9 4 2 6 7 8 9 7 7 9 4 5 9 8 6 9 9 8 9 9 9 3 3 4 4 9 9 9 9 9 7 9 7 9 9 8 9 8 9 3 9 7 6 7 9]
     [5 4 6 8 9 9 7 6 9 8 8 7 5 7 6 7 8 9 5 3 5 9 6 4 3 2 0 1 2 3 4 5 8 9 9 8 7 5 4 3 2 1 0 1 9 8 6 7 9 9 9 1 3 4 5 8 9 4 5 6 7 9 8 8 9 3 2 1 9 9 8 7 6 7 8 9 2 1 2 3 5 7 8 9 5 6 7 9 8 7 6 5 7 8 9 7 6 5 6 8]
     [6 6 7 9 6 5 9 7 9 7 6 6 4 6 5 6 7 8 9 2 9 8 7 5 6 3 1 2 3 4 5 6 7 8 9 9 8 6 5 9 4 2 1 2 3 9 9 8 9 9 8 2 4 9 6 7 8 9 9 7 8 9 9 9 9 9 3 2 4 9 7 6 5 6 7 8 9 2 3 7 8 9 9 6 4 5 9 8 7 6 5 4 6 7 8 9 5 4 5 7]
     [7 8 9 2 3 4 5 9 8 6 5 4 2 5 4 7 9 9 4 3 5 9 8 9 5 4 2 3 4 5 6 9 8 9 9 9 9 7 9 8 9 3 4 3 4 6 7 9 9 9 7 6 5 8 7 8 9 9 8 9 9 9 9 9 9 8 9 4 9 7 5 3 4 6 7 9 8 9 5 6 8 9 0 1 2 3 4 9 8 6 5 3 7 6 7 9 9 3 4 5]
     [8 9 0 1 2 3 9 8 7 5 4 3 0 2 3 9 9 6 5 4 6 7 9 9 7 9 3 4 7 6 7 8 9 9 8 9 7 9 8 7 9 4 5 4 5 6 7 8 9 9 8 7 6 9 8 9 9 8 7 9 9 9 8 7 8 7 8 9 8 9 4 2 3 5 6 7 7 8 9 7 9 2 1 2 3 4 9 7 6 5 4 2 4 5 6 7 8 9 5 6]
     [9 2 1 2 4 9 8 7 6 5 3 2 1 3 4 9 8 9 6 7 7 8 9 8 7 5 4 5 8 8 9 9 8 7 7 8 6 4 5 6 8 9 9 5 6 9 8 9 8 8 9 9 7 8 9 9 8 7 6 8 9 9 8 6 6 5 6 6 7 9 2 1 2 3 4 5 6 7 8 9 8 9 4 3 4 5 6 9 7 7 5 6 7 8 9 8 9 7 6 7]
     [4 3 2 3 9 8 9 8 7 6 7 3 2 3 9 9 7 8 9 8 9 9 9 8 7 6 7 6 7 9 0 2 9 6 6 5 4 3 6 5 6 7 8 9 9 8 9 8 7 7 8 9 8 9 1 2 9 6 5 6 9 8 7 5 4 3 4 5 9 8 9 9 3 4 5 7 9 9 9 8 7 8 9 4 5 9 7 9 9 9 6 7 9 9 7 9 9 8 7 8]
     [6 5 3 9 8 7 6 9 8 6 5 4 3 9 8 7 6 7 8 9 7 6 5 9 9 7 8 9 8 9 1 9 8 5 7 3 3 2 3 4 5 6 7 8 9 7 6 6 5 6 7 8 9 9 0 9 8 7 6 7 9 9 8 6 3 2 1 4 5 6 7 8 9 5 6 9 8 7 5 4 6 7 9 5 9 8 9 9 9 8 7 8 9 6 5 4 1 9 8 9]
     [7 8 9 8 7 7 5 4 9 9 8 5 9 8 7 6 5 4 7 8 9 5 4 5 9 8 9 3 9 9 9 8 6 4 2 1 0 1 2 3 7 8 9 9 8 6 4 2 4 5 6 9 9 8 9 9 9 8 8 9 4 9 8 7 4 3 2 3 5 8 8 9 7 6 9 8 7 6 4 3 4 7 8 9 8 7 8 9 9 9 9 9 6 5 4 3 0 1 9 6]
     [8 9 9 9 6 6 4 3 6 9 7 6 7 9 9 8 7 5 6 7 8 9 3 4 9 9 0 1 2 9 9 7 5 4 3 2 1 2 4 5 6 9 9 8 7 5 3 1 3 4 5 7 9 7 9 8 6 9 9 2 3 9 7 6 5 4 4 7 8 9 9 8 9 7 9 9 8 7 5 4 5 6 7 8 9 5 7 8 9 9 8 9 6 5 3 2 1 2 4 5]
     [9 9 9 8 5 4 3 2 4 9 8 7 8 9 9 9 7 6 7 8 9 3 2 9 8 9 1 9 9 8 9 8 6 5 4 5 2 3 7 6 7 8 9 6 5 4 2 0 1 3 7 8 9 6 5 4 5 6 8 9 4 9 8 7 6 8 5 6 7 8 9 7 9 8 9 9 9 8 9 7 6 7 8 9 5 4 5 6 4 6 7 9 9 9 4 3 2 4 6 7]
     [6 9 8 7 6 5 4 5 6 7 9 9 9 9 9 9 9 8 8 9 9 9 9 8 7 9 9 8 9 7 9 8 7 8 7 6 3 5 8 9 8 9 5 9 7 5 6 1 3 4 5 6 9 5 4 3 4 6 7 9 9 8 9 8 7 7 6 7 8 9 5 6 9 9 7 8 9 9 9 8 9 8 9 5 4 3 1 4 3 4 5 6 7 8 9 5 4 5 7 8]
     [5 4 9 8 9 7 5 6 9 8 9 9 9 9 8 9 9 9 9 9 9 8 9 7 6 6 5 6 8 6 7 9 8 9 8 7 4 6 7 8 9 3 4 9 8 6 8 9 4 5 7 9 8 9 3 2 3 6 7 8 9 7 5 9 8 8 7 9 9 2 3 9 8 8 6 7 8 9 9 9 9 9 6 5 4 3 0 1 2 3 6 8 9 9 9 6 5 6 8 9]
     [2 3 4 9 2 9 8 7 8 9 8 9 8 6 7 8 9 0 1 9 8 7 5 4 5 3 4 3 4 5 5 6 9 9 9 8 9 7 8 9 4 2 3 9 8 7 9 6 5 6 9 8 7 8 9 3 4 5 6 7 8 9 4 5 9 9 8 9 3 1 9 8 7 6 5 6 5 6 7 8 9 8 7 6 4 2 1 2 3 4 5 6 7 9 8 7 6 7 9 6]
     [1 4 9 2 1 0 9 8 9 8 7 9 6 5 4 6 6 9 9 8 7 6 5 3 2 1 0 1 2 3 4 7 8 9 9 9 9 8 9 7 9 1 2 3 9 8 8 7 6 9 8 8 6 7 8 9 5 7 8 9 9 2 3 4 5 6 9 5 4 0 1 9 8 7 4 4 4 5 7 9 9 9 8 6 5 3 2 4 5 6 7 8 9 9 9 8 9 8 9 5]
     [0 9 8 9 9 1 2 9 9 9 6 8 9 1 3 4 5 8 9 9 8 7 5 4 3 2 1 2 3 4 5 6 7 8 9 7 8 9 8 6 8 9 9 4 6 9 9 8 9 9 7 6 5 6 7 8 9 8 9 1 0 1 2 3 5 7 8 9 5 1 9 8 7 6 3 2 3 7 9 8 9 9 9 7 6 5 4 5 9 8 9 9 8 9 9 9 3 9 3 4]
     [9 8 7 9 8 9 9 9 9 8 5 7 8 9 9 5 6 7 9 9 8 7 6 9 8 6 5 4 8 9 6 7 8 9 5 6 9 8 7 5 6 7 8 9 8 9 9 9 8 9 6 5 4 5 8 9 9 9 3 2 1 2 3 9 6 9 9 8 9 2 3 9 8 5 4 0 2 5 6 7 8 9 9 8 8 6 5 7 9 9 7 6 7 8 9 3 2 1 2 3]
     [8 7 6 5 6 9 8 7 6 6 4 5 6 7 8 9 7 9 0 1 9 8 7 8 9 7 6 5 7 8 7 8 9 3 3 9 8 7 6 4 5 6 7 8 9 9 9 8 7 6 5 4 3 4 7 6 9 8 9 5 4 3 9 8 9 9 8 7 8 9 9 8 7 6 4 1 2 3 4 9 9 7 6 9 9 8 9 8 9 6 4 5 6 7 8 9 3 2 5 4]
     [9 8 5 4 5 9 7 6 5 4 3 4 5 9 9 9 8 9 1 9 9 9 9 9 9 8 7 6 8 9 8 9 2 1 2 9 6 5 4 3 2 3 5 7 9 8 9 9 9 8 6 4 2 3 4 5 6 7 8 9 5 9 8 7 5 8 6 6 7 9 9 9 8 9 3 2 6 5 6 8 9 6 5 6 9 9 7 9 7 5 3 4 7 7 8 9 4 3 4 7]
     [8 9 6 6 9 8 7 6 4 3 2 3 4 8 9 9 9 9 9 8 9 2 1 0 2 9 8 7 9 9 9 5 1 0 9 8 9 7 9 2 1 9 9 9 8 7 7 8 9 5 4 2 1 2 3 4 5 8 9 9 9 8 7 8 4 9 4 5 6 7 8 9 9 8 4 3 7 6 7 9 4 3 4 5 7 9 6 5 4 3 2 3 5 6 9 8 9 4 5 6]
     [7 6 9 8 9 9 8 7 3 2 1 2 3 7 9 9 9 9 9 7 8 9 2 1 2 9 9 8 9 8 4 3 2 9 8 7 8 9 8 9 9 8 7 5 4 5 6 7 8 9 3 1 0 1 5 8 6 7 9 8 7 6 5 4 3 4 3 4 9 8 9 9 8 6 5 4 5 8 8 9 3 2 3 6 9 8 7 4 3 2 1 2 4 5 6 7 8 9 7 7]
     [4 5 6 9 9 9 8 7 5 4 3 4 5 6 7 8 9 8 7 6 7 8 9 2 9 8 9 9 9 6 5 4 9 8 7 6 8 7 7 9 8 7 6 5 3 4 4 5 8 9 4 2 1 2 3 9 8 9 9 9 9 8 4 3 2 1 2 9 8 9 3 2 9 7 7 6 6 8 9 6 4 3 4 5 6 9 8 5 2 1 0 1 2 4 8 9 9 0 9 8]
     [3 4 9 9 7 8 9 9 6 5 4 5 6 7 8 9 9 7 6 5 8 7 8 9 8 7 6 7 8 9 6 5 9 9 6 5 4 5 6 7 9 8 9 2 1 4 3 4 7 8 9 5 4 3 5 6 7 9 8 9 9 9 5 4 1 0 1 9 7 8 9 1 0 9 8 7 8 9 9 8 6 5 6 7 7 8 9 4 3 4 2 2 4 6 7 8 9 1 9 9]
     [4 9 8 7 6 7 9 8 7 6 6 6 7 9 9 8 7 6 5 4 5 6 7 8 9 6 5 6 7 8 9 9 8 7 6 6 3 4 1 2 4 9 8 5 0 1 2 5 6 8 9 6 5 4 6 7 9 8 7 8 8 9 4 3 2 2 9 8 6 9 8 9 1 2 9 8 9 1 0 9 8 7 7 8 8 9 9 9 9 4 3 3 5 8 9 9 8 9 8 9]
     [9 8 7 6 5 7 8 9 8 7 9 7 9 8 9 9 7 5 4 3 4 5 6 9 2 3 4 5 6 7 8 9 9 6 5 3 2 1 0 1 9 8 7 4 3 2 3 4 5 7 8 9 6 5 7 9 8 7 6 7 6 7 9 4 3 9 8 7 5 6 7 8 9 9 8 9 4 3 9 6 9 8 9 9 9 9 9 8 8 9 6 4 7 9 8 7 7 5 7 8]
     [9 8 6 5 4 5 6 8 9 9 8 9 8 7 8 9 6 5 6 2 3 6 7 9 4 5 5 6 7 8 9 9 8 7 6 4 3 4 1 9 8 7 6 5 6 7 8 9 9 8 9 8 7 6 8 9 7 6 5 4 5 8 9 5 9 9 9 5 4 5 6 7 8 9 6 8 9 9 8 5 4 9 5 4 5 9 9 7 6 8 9 5 8 9 7 6 5 4 5 8]
     [7 6 5 4 3 4 5 7 9 8 7 6 5 6 7 8 9 4 2 1 3 4 8 9 5 8 7 7 8 9 0 1 9 8 9 8 4 5 2 3 9 8 7 6 7 8 9 9 8 9 6 9 8 7 8 9 9 8 4 3 6 7 8 9 8 9 5 4 3 4 7 9 9 6 5 7 8 9 7 6 6 7 9 3 9 8 7 6 5 7 9 9 9 8 6 4 2 3 6 7]
     [9 7 4 3 2 3 4 6 7 9 8 5 4 5 6 7 8 9 3 2 4 5 9 8 6 7 9 8 9 3 1 2 9 9 8 7 6 6 3 4 6 9 8 7 8 9 9 8 7 6 5 6 9 8 9 8 7 6 5 4 5 9 9 8 7 5 4 3 2 3 8 9 9 5 4 6 7 9 9 7 8 8 9 9 8 6 5 5 4 6 8 8 9 5 4 3 1 3 4 5]
     [8 7 5 4 1 2 3 4 9 8 7 6 5 6 7 8 9 6 5 7 5 7 8 9 7 9 8 9 9 4 9 9 8 9 9 8 7 7 4 5 7 8 9 8 9 8 7 9 8 7 6 7 9 9 9 9 9 8 6 8 9 8 9 9 8 9 5 4 3 5 6 7 8 9 3 5 6 8 8 9 9 9 8 9 6 5 4 4 3 5 6 7 9 9 4 3 0 1 2 3]
     [9 8 7 3 2 3 6 7 8 9 9 7 6 9 8 9 8 7 9 9 9 8 9 9 9 8 7 8 8 9 8 6 7 9 9 9 8 8 7 6 9 9 6 9 5 5 6 7 9 8 7 9 8 9 8 5 4 9 8 9 6 6 8 9 9 8 6 5 4 7 8 9 9 9 2 3 5 6 7 8 9 9 7 6 5 4 3 3 2 4 5 6 7 8 9 2 1 2 3 4]
     [4 9 8 6 5 4 5 6 9 7 6 9 8 9 9 5 9 9 0 1 3 9 9 9 8 7 6 7 6 8 9 5 6 8 9 9 9 9 8 7 8 9 4 5 4 4 5 7 8 9 9 8 7 6 7 5 3 3 9 3 4 5 6 8 9 9 8 6 5 8 9 9 7 8 9 4 5 7 8 9 7 9 8 5 4 3 2 1 0 1 4 7 8 9 9 3 2 3 5 6]
     [3 4 9 7 9 5 6 9 8 9 5 5 9 0 2 4 9 2 1 2 3 9 8 7 6 5 5 3 5 6 9 4 5 9 9 9 8 9 9 8 9 4 3 4 2 3 5 9 9 5 6 9 6 5 4 3 2 1 0 2 3 4 5 6 7 8 9 7 6 9 8 7 6 7 8 9 6 7 8 9 6 7 9 6 5 7 6 2 1 2 3 5 9 9 8 9 3 4 6 7]
     [2 9 8 9 8 9 9 8 7 9 4 3 2 1 2 9 8 9 2 3 5 6 9 9 7 4 3 2 4 8 8 9 6 8 9 9 6 9 9 9 8 6 2 0 1 3 4 8 9 4 5 9 7 8 5 6 3 2 4 3 6 5 6 7 8 9 9 9 7 8 9 6 5 4 5 6 9 9 9 6 5 6 9 8 7 6 5 3 2 3 4 7 8 9 7 9 4 5 7 8]
     [9 8 7 5 7 6 8 9 6 8 9 9 3 2 9 8 7 8 9 9 9 7 9 8 9 5 5 1 5 6 7 8 9 9 9 8 9 8 9 9 9 7 3 1 2 4 5 7 8 9 7 9 8 7 6 5 4 5 5 5 7 6 7 8 9 9 9 9 8 9 6 5 4 3 4 5 8 7 8 9 4 3 2 9 9 7 5 4 3 5 6 9 9 7 6 7 9 9 8 9]
     [9 7 6 4 4 5 4 5 5 7 9 8 9 9 8 7 6 9 6 7 8 9 8 7 6 5 3 2 8 9 8 9 3 9 8 7 9 7 8 9 9 8 9 2 3 5 6 8 9 9 8 9 9 9 7 7 8 6 8 7 8 7 8 9 7 8 8 9 9 6 5 4 3 2 3 4 5 6 7 8 9 2 1 2 9 8 9 8 4 5 6 7 8 9 5 6 7 8 9 1]
     [7 6 5 3 2 1 2 3 4 5 9 7 8 9 9 9 5 4 5 6 7 8 9 8 7 6 5 6 7 8 9 5 4 9 7 6 5 6 7 8 9 9 8 9 4 5 7 9 2 3 9 8 7 9 8 8 9 7 9 8 9 8 9 7 6 5 7 9 8 7 6 3 2 1 2 3 4 5 7 8 9 3 2 3 9 8 7 6 5 6 7 8 9 2 4 5 6 9 1 0]
     [6 5 4 2 1 0 3 4 5 9 9 5 6 7 8 9 2 2 3 8 9 9 9 9 8 8 6 8 8 9 9 9 9 8 6 5 4 5 6 9 4 6 7 9 6 7 8 9 9 9 8 9 5 4 9 9 9 8 9 9 5 9 3 8 5 4 5 8 9 9 8 2 1 0 3 4 5 7 8 9 5 4 3 4 5 9 8 7 6 7 8 9 0 1 6 8 8 9 2 2]
     [7 6 5 4 7 1 3 9 9 8 7 4 5 6 7 9 0 1 9 9 9 8 9 9 9 9 7 9 9 9 9 8 6 9 7 3 2 4 7 9 3 3 8 9 9 8 9 9 8 9 7 8 9 3 2 3 8 9 6 5 4 3 2 0 1 3 4 7 8 9 7 5 2 1 5 6 6 8 9 7 6 6 7 8 7 8 9 8 7 9 9 2 1 3 8 9 9 9 9 3]
     [8 7 6 5 6 2 9 8 9 7 6 3 4 4 6 7 9 9 8 7 8 7 8 8 9 9 8 9 1 9 8 7 5 4 3 2 1 5 6 9 1 2 3 7 8 9 9 8 7 5 6 9 8 9 3 4 7 9 7 6 5 4 3 4 5 4 5 6 8 9 8 4 3 2 7 8 7 9 3 9 9 7 8 9 8 9 4 9 8 9 4 3 4 5 7 8 9 7 8 9]
     [9 8 8 6 7 9 8 6 5 4 5 2 4 3 4 6 7 8 9 6 5 6 6 7 8 9 9 3 2 3 9 8 6 5 5 8 7 6 7 8 9 3 5 6 8 9 8 7 6 4 5 8 7 9 9 5 6 8 9 8 6 7 5 5 6 7 8 9 9 9 6 5 4 6 8 9 8 9 1 9 8 9 9 6 9 4 3 5 9 6 5 9 8 6 8 9 6 6 9 8]
     [1 9 9 8 9 8 7 5 4 3 2 1 0 2 8 9 8 9 9 5 4 4 5 6 9 6 5 4 3 4 5 9 7 6 7 9 9 7 8 9 5 4 5 6 7 9 8 5 4 3 4 7 6 7 8 9 7 9 9 8 7 9 9 9 7 9 9 2 9 8 7 6 7 8 9 6 9 8 9 8 7 8 9 5 4 3 1 9 8 7 6 8 9 8 9 5 4 5 9 7]
     [2 9 8 9 6 9 8 9 5 4 3 2 2 7 7 9 9 9 8 6 2 3 6 7 8 9 6 7 4 7 8 9 8 9 8 9 9 8 9 9 9 5 6 8 9 8 7 4 3 2 3 4 5 6 9 9 8 9 1 9 9 8 7 8 9 8 9 1 2 9 9 7 9 9 7 5 6 7 8 9 6 9 5 4 3 2 0 1 9 8 7 9 8 9 5 4 3 9 8 6]
     [9 8 7 6 5 5 9 7 6 6 4 3 3 5 6 8 9 9 9 6 5 4 5 6 7 8 9 9 5 6 7 9 9 7 9 7 4 9 6 9 8 9 8 9 8 7 6 4 2 1 4 5 6 8 9 9 9 4 2 9 9 7 6 9 8 7 8 9 4 9 9 8 9 6 5 4 9 8 9 6 5 6 9 9 4 3 1 2 9 9 8 9 7 9 6 9 1 9 7 5]
     [9 9 6 5 4 4 9 8 9 8 9 6 5 8 7 8 9 9 8 7 9 5 6 7 8 9 7 8 9 7 9 8 7 6 4 6 3 4 5 6 7 8 9 9 9 9 8 5 3 2 3 4 5 6 7 8 9 6 9 8 7 6 5 4 5 6 7 8 9 8 7 9 7 6 4 3 8 9 5 4 4 8 7 8 9 4 2 9 8 9 9 7 6 8 9 8 9 9 8 7]
     [8 6 5 4 3 2 3 9 9 9 8 7 8 9 8 9 3 1 9 9 8 9 9 8 9 8 6 9 8 9 9 9 6 4 3 2 1 5 6 7 8 9 9 9 8 9 9 6 4 3 4 5 6 7 8 9 9 9 9 9 8 9 4 3 4 7 8 9 9 7 6 9 9 4 3 2 6 8 9 2 3 5 6 6 8 9 9 8 7 9 8 6 5 7 8 7 8 9 9 9]
     [9 7 9 8 4 1 4 5 9 8 9 8 9 6 9 8 9 0 9 9 7 8 9 9 8 7 5 6 7 8 9 8 7 6 4 3 2 8 7 8 9 7 8 8 7 9 8 7 5 8 9 9 7 8 9 8 9 8 9 9 9 8 5 4 6 7 9 8 7 6 5 7 8 9 9 3 5 9 0 1 2 3 4 5 6 7 8 9 6 9 8 7 4 3 4 6 7 8 9 0]
     [9 9 9 7 5 2 3 9 9 7 6 9 4 5 6 7 8 9 8 7 6 7 8 9 9 8 4 5 6 9 9 9 8 7 6 4 3 5 8 9 6 6 5 3 6 7 9 9 6 7 8 9 8 9 8 7 6 6 8 9 8 7 6 5 6 9 8 7 6 4 3 5 6 7 8 9 6 8 9 2 3 4 5 7 7 8 9 6 5 4 9 8 3 2 5 7 9 9 3 2]
     [9 8 9 9 6 3 9 8 8 9 5 4 3 4 5 8 9 9 9 6 5 8 9 9 9 4 3 4 9 8 9 9 9 8 7 8 9 6 9 6 5 5 4 2 4 5 6 9 7 8 9 3 9 9 9 9 5 4 7 7 9 9 7 7 7 8 9 8 9 3 2 9 8 9 9 9 8 9 4 3 9 5 9 8 9 9 6 5 4 3 9 9 4 3 5 6 7 8 9 3]
     [8 7 9 8 9 9 8 7 6 5 6 1 2 3 4 5 9 8 7 6 4 9 8 9 8 9 1 2 9 7 8 9 9 9 8 9 8 7 8 9 4 3 2 1 3 4 5 9 8 9 5 4 9 8 9 7 6 3 5 6 7 8 9 8 8 9 9 9 5 4 9 8 9 4 5 6 9 7 6 9 8 9 9 9 9 8 7 6 5 9 8 9 9 7 6 7 8 9 6 4]
     [7 6 9 7 9 8 9 9 5 4 2 0 1 2 3 4 5 9 8 7 3 2 7 6 7 9 9 9 8 6 8 8 9 9 9 2 9 8 9 7 9 9 3 2 4 9 6 7 9 9 9 9 8 6 8 3 2 2 3 4 5 9 0 9 9 9 9 8 9 9 8 7 8 9 6 7 9 8 9 8 7 8 9 0 1 9 8 9 9 6 7 9 8 9 7 8 9 8 7 5]
     [6 5 4 5 6 7 9 8 7 6 3 4 5 3 4 8 9 9 9 8 2 1 6 5 6 7 8 9 7 5 6 7 8 9 1 0 1 9 5 6 7 8 9 3 9 8 9 9 9 9 8 7 5 4 3 2 1 0 4 5 8 9 1 2 3 9 8 7 9 5 9 6 7 9 7 8 9 9 9 7 6 7 8 9 2 3 9 9 8 5 7 6 7 9 9 9 1 9 8 9]
     [5 4 3 4 5 8 9 9 8 7 4 6 6 4 6 7 9 8 7 5 1 0 3 4 5 8 9 7 6 4 7 9 9 8 9 3 2 3 4 5 9 9 9 9 8 7 9 8 9 9 9 8 6 6 7 3 2 1 5 6 7 8 9 3 9 8 7 6 5 4 3 5 6 7 9 9 3 2 9 8 7 8 9 9 3 9 9 8 6 4 3 5 6 7 8 9 0 9 9 5]
     [7 6 2 3 4 9 1 2 9 9 5 6 7 6 7 9 8 7 5 4 3 1 2 5 6 9 9 8 7 3 4 5 6 7 8 9 4 5 6 9 8 7 8 4 3 6 7 6 7 9 9 9 7 7 9 5 4 2 6 7 8 9 4 9 8 7 6 5 4 3 2 6 7 8 9 9 4 1 0 9 8 9 6 7 9 8 7 5 4 3 2 3 7 5 7 8 9 8 7 6]
     [3 2 1 2 9 8 9 9 9 8 9 7 8 9 8 9 9 8 5 4 3 2 3 4 5 9 8 7 5 2 3 4 5 8 9 8 7 6 9 8 7 6 5 4 2 5 4 5 8 9 8 9 9 8 7 6 5 4 7 8 9 5 3 0 9 9 8 7 6 4 5 8 8 9 9 8 9 2 1 3 9 3 5 9 8 9 6 4 3 2 1 2 3 4 5 7 8 9 9 7]
     [4 3 2 9 8 7 9 8 7 6 8 9 9 7 9 9 8 7 6 5 4 3 4 6 7 8 9 5 4 3 4 6 7 9 3 9 8 7 8 9 8 9 6 2 0 2 3 4 5 6 7 8 9 9 9 7 6 7 8 9 7 9 2 1 2 3 9 9 6 5 7 9 9 9 8 7 8 9 9 9 3 2 9 8 7 5 4 3 2 1 0 1 2 3 4 5 6 7 8 9]
     [5 4 9 8 7 6 5 3 4 5 7 8 9 6 5 4 9 8 7 6 5 6 7 9 8 9 7 6 5 4 6 7 9 3 2 3 9 9 9 9 9 5 4 3 1 4 5 6 9 7 8 9 1 2 9 8 9 8 9 5 6 8 9 2 4 5 6 9 8 6 7 8 9 6 7 6 5 9 8 8 9 3 9 8 7 6 5 4 3 2 4 5 4 5 5 6 7 8 9 5]
     [6 9 8 7 6 5 3 2 3 5 6 7 8 9 4 3 2 9 8 7 8 7 8 9 9 9 8 7 8 9 7 8 9 2 1 2 7 6 8 9 9 6 5 4 3 5 6 7 8 9 9 5 3 9 8 9 8 9 3 4 7 7 9 3 6 7 8 9 9 7 8 9 6 5 6 3 4 5 6 7 8 9 5 9 8 7 6 6 4 3 6 6 5 6 6 9 8 9 3 4]
     [8 9 9 8 7 3 2 1 2 3 4 5 9 9 4 2 1 0 9 8 9 8 9 4 6 4 9 8 9 8 9 9 2 1 0 1 3 5 7 9 8 7 6 5 6 6 7 9 9 8 7 6 9 8 7 6 7 3 2 3 4 6 8 9 9 9 9 4 9 8 9 6 5 4 5 2 3 4 6 9 9 5 4 6 9 8 8 7 6 4 5 7 8 7 7 8 9 3 1 2]
     [9 4 3 9 8 5 1 0 1 2 5 6 7 8 9 3 2 3 5 9 9 9 5 3 2 3 4 9 7 6 5 4 3 2 1 2 3 4 8 9 9 8 9 6 7 9 8 9 9 9 8 7 8 9 9 4 3 2 1 2 4 5 6 7 8 9 2 3 5 9 7 6 4 3 2 1 2 4 5 7 8 9 3 1 2 9 9 8 7 8 9 8 9 9 8 9 6 4 3 4]])

  (defconst advent/day9-test
    [[2 1 9 9 9 4 3 2 1 0]
     [3 9 8 7 8 9 4 9 2 1]
     [9 8 5 6 7 8 9 8 9 2]
     [8 7 6 7 8 9 6 7 8 9]
     [9 8 9 9 9 6 5 6 7 8]])
#+END_SRC

#+RESULTS: day9-input
: advent/day9-test

#+NAME: day9-solution
#+BEGIN_SRC emacs-lisp :session day9
  (defun advent/day9-sum-minimums (field)
    "Search the FIELD for minimums and return their sum (+1)."
    (let ((summ 0)
          (rows (length field))
          (columns (length (aref field 0))))
      (dotimes (i rows)
        (dotimes (j columns)
          (let ((value (aref (aref field i) j))
                (top (if (> i 0) (aref (aref field (1- i)) j) 10))
                (bottom (if (< i (1- rows)) (aref (aref field (1+ i)) j) 10))
                (left (if (> j 0) (aref (aref field i) (1- j)) 10))
                (right (if (< j (1- columns)) (aref (aref field i) (1+ j)) 10)))
            (if (and
                 (< value top)
                 (< value right)
                 (< value bottom)
                 (< value left))
                (setq summ (+ summ value 1)))
            )
          )
        )
      summ)
    )

  (defun advent/day9-find-basins (field)
    "Search the FIELD for minimums and return their sum (+1)."
    (let ((basins ())
          (returnlist ())
          (rows (length field))
          (columns (length (aref field 0))))
      (dotimes (i rows)
        (dotimes (j columns)
          (let ((value (aref (aref field i) j))
                (top (if (> i 0) (aref (aref field (1- i)) j) 10))
                (bottom (if (< i (1- rows)) (aref (aref field (1+ i)) j) 10))
                (left (if (> j 0) (aref (aref field i) (1- j)) 10))
                (right (if (< j (1- columns)) (aref (aref field i) (1+ j)) 10)))
            (if (and
                 (< value top)
                 (< value right)
                 (< value bottom)
                 (< value left))
                (progn
                  (setq returnlist (advent/day9-sum-basin field i j))
                  (setq basins (cons (car returnlist) basins))
                  (setq field (cadr returnlist)))))))
      (setq basins (sort basins '>))
      (* (car basins) (cadr basins) (caddr basins))))

  (defun advent/day9-sum-basin (field row column)
    (cond
     ((or (< row 0)
          (< column 0)
          (>= row (length field))
          (>= column (length (aref field 0))))
      (list 0 field))
     ((>= (aref (aref field row) column) 9)
      (list 0 field))
     (t (let (returnvalue (summ 0))
          (setq summ (1+ summ))
          (aset (aref field row) column 10)
          (setq returnvalue (advent/day9-sum-basin field (1- row) column))
          (setq summ (+ summ (car returnvalue)))
          (setq field (cadr returnvalue))
          (setq returnvalue (advent/day9-sum-basin field row (1- column)))
          (setq summ (+ summ (car returnvalue)))
          (setq field (cadr returnvalue))
          (setq returnvalue (advent/day9-sum-basin field (1+ row) column))
          (setq summ (+ summ (car returnvalue)))
          (setq field (cadr returnvalue))
          (setq returnvalue (advent/day9-sum-basin field row (1+ column)))
          (setq summ (+ summ (car returnvalue)))
          (setq field (cadr returnvalue))
          (list summ field)))))

  (advent/day9-find-basins advent/day9-input)
#+END_SRC

#+RESULTS: day9-solution
: 1076922
** Day 10
#+NAME: day10-input
#+BEGIN_SRC emacs-lisp :session day10
  (defconst advent/day10-input
    '(
  "{{<{{{{([{[([[()<>]{<>{}}]<([]())(()<>)>)((({}())[()[]])<<[][]>[{}[]]>)]{{(<{}<>>{<><>}]([<>[]]<"
  "[(<{{[{(<({{<<[]()><<>{}>>([<>[]]{<><>})}})>)}]}}>[{(<{({[{[[({}())((){})]({{}[]})]<<[<>{}]([][])>({<>()}"
  "(({<{[{({(([[([]())({}())]]({[[]{}]([][]))<((){})<{}<>>>))[(([<>[]]<[]>)(([]{}){{}{}}))])})[({<[{"
  "([{{[([<({<<<([]())[()[]]>{<()[]>[[]()]}>[{<[]{}><[]>>{<<>()>{[]()}}]>[[[[[]{}]([]<>)]<{<>{}}"
  "[[((<({<(<{<<{{}()}{[][]}>[((){})]>}>{((<({}<>)<{}()>>[[<>()]])<<<[][]><<>[]>>{<{}[]>(<>())}>)<{[[{"
  "[{<{{{{<([{[(<[]<>>(<>[])){({}<>)([]<>)}]{{([][])[<>{}]}{<[]<>>(<>{})}}}])<<{[<[<>{}]<(){}>>{<{}<>><<>"
  "(({({([(<[[([[{}{}]([]<>}][(<>()){(){}}])]](({{{{}<>}<{}[]>}([{}[]][(){}])}[(<[]{}>({}()))<<<><>>>])<[{"
  "[{<((<{(<{<<{[()()](()<>)}<({}[])([]<>)>>{(<<><>>[[]{}])[[[]()](<>[])]}>{[[({}<>)([]<>)][[{}[]"
  "{<{<{{(<[[{[[({}[])[()[]]]([()<>][{}[]])]<<({}())[{}{}]><[<>[]](<><>)>>}(([([]{})((){})]((<>)([]{}))))]<{<<<"
  "<{(<<(<[<{<[{[<>[]][{}{}]}{{()<>}{<><>}>]>[<(([]{})[[]])>]}<[<([{}{}][<><>]){([]{})}>]({<{<>()}>{"
  "{[[<{{{<<<[<((()<>)({}{}))<{{}()}>>]<((([]{}){{}<>})[{{}<>}([]{})])({{()[]}[[]()]}[{{}()}({"
  "<[[[{{([{[({[<{}[]>[{}()]]{<()>}}({<()()>}<<<>()>{[]}>))]((({({}[])>{[(){}]{<><>}})(({()[]}[()<>]"
  "[([([([<[{{<[[{}[]]{<>{}}][<{}>(()[])]>[({<>()}(()[])){<[][]>{()[]}}]}}<{(({()}([]()))(([]())<()[]>))<((<>{}"
  "<{[{(({([([[{((){})[[]]>{{{}[]}[<>()]}]])]{([([<[]{}>((){})]<[()<>]<()()>>)][<<{<>{}}{<><>"
  "[[{{(([{(({[[{{}[]}]][<<<>()>({}{})>[[{}<>]{{}<>}]]}[(({{}}{[][]}){[{}{}][<>[]]})(<<<>{}><<><>>>)])<["
  "[[{([<<([[<(<{<>()}<[][]>>{[<>[]]{()[]}}){[<[][]><{}()>][([]())<<><>>]}>]((<<[(){}][(){}]><([])>>))"
  "[{[<{(([(([([(<>[]}(<>{})][<{}[]>[()[]]])<{[{}<>]<[]<>>}{{[]<>}{{}{}}}>]<<{[<>{}](<>())}{{()[]}{<>{}}}>["
  "{({<[(((<{<<[[()<>]]<({}<>)>>>[<({[]<>}{()<>})[[()<>][<><>]]>({[{}[]]({}<>)}[<(){}>(<>())])]}><[{<[[<>"
  "<(((({{(<({[<<[]<>>>([()()]{<>()})][<[{}{}]{<>()}>{{{}{}}[[][]]}]}{(<<<><>>(()<>)>(<<>()>[()[]]))"
  "[<{{[{[[[<(({<()()>[(){}]}[([]())[(){}]]))>{[<[[[]]<[][]>]{[[][]](()())}>[(<<>()>{[]<>})(({}())<{}[]>)"
  "(<[[((<<({[(([()[]]([]<>)){{(){}}})]{<(<<><>><[]{}>)<<{}<>]([]<>)>>}}){(<{<{[]{}}[{}<>]>}>{({(<><>)<()[]>}{(("
  "{[{((<{<<<<([<[]{}>[[][]]]<[[]()][<>[]]>)[[<{}[]>{{}()}](<()<>>[<>[]])]>>[{([<()[]>{{}[]}](({}{}"
  "(<([<((<{[<<(((){})<<><>>)<[{}()]<[]<>>}>[([[]{}](()[]))]>[<{({}()){{}()}}>[(([]<>)({}[])){"
  "{((((<(({[(<{<()]([][])}>){[<[[][]]>]<{{{}<>}[[][]]}>}]}[<{([{[]{}}]{[(){}]<<>()>})[(<()<>>{()<>"
  "<<{([{<[[[<{([[]<>]){[<>()][(){}]}}[{(()[])[()[]]}]>][{{[{{}[]}<()<>>]>[[{(){}}[<>[]]][[<>[]]({}()"
  "<((<[<(([<[{({<><>}(()[]))}]<[<[{}()]<()[]>>(<()()>)][[(<>())<()())]<{<>}<{}>>]>>({{<<<>[]><<>("
  "[({{{{{{(([[<<()()><<>[]>>[{[]<>}]]{(<{}<>>(()[]))<<[][]>(()())>}]([<({}()><[][]>>]<{[[][]]<[]<>>}("
  "(<(<{{<[{{{[<[<>[]]<[]{}>>[{<>{}}{()()}]]{<<{}()>(<>())>[[{}[]]]}}}}][{([{[([]{})<()[]>][[<>{}]{()[]}]}(([()"
  "{[<<(<<<{[<<<<[]<>><()[]>>[({}[])[[]<>]]><((<><>)[{}<>])[{{}{}}[[]()]]>>{{{[<><>]<<>()>}[<[]{}>([][])]"
  "<(<{<(<({[[{((()[])[{}<>])([<>()]>}{[({}{})[(){}]]<[()<>]({}[])>}]{[<{[]{}}><{[]{}}[[][]]>][[<{}<>><()[]>]<["
  "{<({[<((<<<{{([]<>}{<><>}}<{<>{}}[[]<>]>}>{<[{{}}(()())]>}>(<<{[(){}]<()[]>}({(){}}[()<>])>[<<<>[]>{[]"
  "{(({<{{{{{((<{[]<>>(<>{})>[[<>()]])<<(()())[<>]><[(){}][{}{}]>>)}({([[[]]]{<{}{}><()[]>})<{[(){}][[]()]}>"
  "<<[<<[((({[[(<{}[]>({}())){[()()]}][{{<>{}}<<>()>}[<{}[]>[<>[]]]]]{<(([]())([]()))>{([()()]<<>[]>)[<"
  "{([<<<({((<{{[<>[]][<>{}]}<<<>[]>[[][]]>}[{[()[]]<<>[]>}<[{}{}]<<><>>>]>({[<[]<>>]<<()()>([][])>}(((<"
  "(<{<((<{[[<[(<[]{}>{<>{}})][<([][])[{}<>]>[<{}<>>]]><<[(<>[])[{}<>]]{<{}{}><{}[]>}>(<([]<>){()[]}>)>]]}{({[<("
  "[{{(({<<<<{{<({}()){{}{}}>[(()[])]}[([(){}]{<>[]})[(<>())[{}]]]}>[<<<{[]{}}{{}{}}>]{<[{}<>]>{(()())}}>[{(<[]<"
  "{[<<{<[[({{<<{()[]}<<><>>>([[]<>>[{}[]])>}[[[([]<>)[<>{}]]]<<[<>()](<>{})>>]})(((({({}[])<<><>>}([<>])))((<"
  "[{(({({<({(<{{[][]}({}<>)}[{()()}{[][]}]>(((<><>)(<>()))([{}()][{}()])))([{[[]()]<[]{}>}{("
  "{<{{<[<<[(<([({}())[{}()]]{{{}<>}<[]>}){[((){})<[][]>]<([]())({}[])>}>{<(((){})[()<>])(<()[]>[(){}]"
  "{({({<{{(<([<[<><>]((){})>{{()[]}<<>{}>}]{[(<>())<{}[]>][{()<>}[[]()]>})>[[<{([])[()[]]}><<[(){}]({}())>>]{"
  "(<{{(<<<{(<(({<><>}{()[]})<[{}[]]([]())>)([(()<>)[[]<>]]({[]()}{{}{}}))))[(<{{()[]}<()[]>}((<><>))>[["
  "<<[<([{<<[[({<[]<>><<>()>}{([]<>)[[]<>]}){[<{}{}><()[]>]<{<>()}{<>()}>}]{{<({}{})>})]>[<({<"
  "(<<[[({[({(<{{[]{}}<[]{}}}>[<<()<>><{}<>>>(<()()>{{}<>})])}{<({({}[])<()>}<([]())<{}<>>>)<<[("
  "[<(<{(([(<([[<<>{}>(<>{})]](((()[])[[]()])[[{}<>]({}{})]))><<{<([]<>){[][]}>[{<>[]}<()<>>]}>(<((<>[]){()<>}"
  "[<{[[{(([[{[{<[]<>>(<>[])}<<<>()>{{}{}}>][({[][]}<<>>){(<>[])[<><>]}]}(([([][])(<>[])]{(()())}))](<<{"
  "((<{<<([<[(([{()()}((){})][<()[]><()[]>])<{({}<>){{}<>}}>)[{(<<><>>)<{{}[]}>}({(<>()){()}}{(["
  "[({{{{((([({{(<>[])[[]<>]}([{}])}(({<><>}{<>()})[[{}[]]]))<{[[<>{}](()[])](<()<>>{[]()})}{{<()()"
  "[<[<({[[({[[[<<>[]>]({[]}[<><>])]{[[()<>]([]())]<({}{})[[][]]>}]}<<(([()()]<()<>>)<{()()}[()[]]>"
  "{<([[<[<<(([<(()[])(()<>)>{[<><>](<>[])]]{({{}})}){<((<><>)<{}<>>)((()[])[[]()])>})<<(<(())("
  "<[<((<{(<[[({{{}()}({}{})}}<[[()<>]]<[()()][<>]>>]<[([()()]({}<>))[<{}()>([]<>)]]>][{[[(()())[()]][[<>[]"
  "[{(<(<[((<{(({(){}}[()[]])<{[][]}(<>{})>)[(<<><>>[()[]]]{[{}[]]{()<>}}]}><[<[[{}()](()[])][(<>()){<>()}]>[{"
  "([({<({{{[[<[{{}<>}([][])]{[(){}]{()<>}}>][{[{[]<>}][<{}()>]}]]}{((<[{{}[]}(()()))[{<>[]}]>({(<>{})<[]<>>}"
  "{[({[<[([(<{((<>{})<{}{}>)}(<[[]()]<{}{}>>({{}[]}{[]<>}))><[((()[])(())){([]<>)[()[]]}]<({()"
  "[(<<<([{[[[<<<<>>{{}<>}>[{[]()}]>[([[]{}]{[]<>}){[<>()]}]]]]}]<<((<([{[][]}<{}<>>]<[[]{}][[]<>])){{[<>[]"
  "{[{{[[{{[<[<<{{}<>}<[]{}>><<()[]>[<>[]]>>[([<>{}](()()))]]>{({([{}[]](<><>))<<(){}>(<>{})>}({([]<>)[{}[])}(<<"
  "<{([[{<[<{{([(<>{})[<>()]]){{[()[]]([])}}}[{<((){})([]())>}(<{[][]}<<>{}>>[[[][]]<()()>])]}>["
  "{(<[({{(<<<{[(()())]<[<>[]][{}{}]>}[[<()[]>{[][]}]]>(<((<>())[()[]]){{()[]}{[][]}}>({{[]<>}<[][]>}(<[]{}"
  "<{{[{((((<[{({[]{}}<(){}>)}[[{[][]}<<>{}>]<<[][]>{[]}>]]>{{([((){})<<>{}>]{{()()}})<[<<>()>](<<>>[()"
  "<([({(<<<{[<{(()<>)(<>[])}([<>]{<>{}})>]<(<<<><>><{}()>>[([][]){[]<>}])>}{[([[[]<>]{(){}}]<[{}<>]{{}<>}"
  "{<<<[{[(<[([([[]()]<()[]>)(([]())({}[]))]<[[()<>]]<[(){}]<[][]>>>)(<{<[][]>)<(()<>)<{}[]>>"
  "{[[<[[<(<[[{(<()<>>)<{{}<>}[[][]]>}<<(()()){[]{}}>{<[]()>>>]]>)({<<<<[{}{}]{<>()}>{<<><>>([]{})}>>[([<()()>("
  "[[[{({{({[{[(({}())(<>[]))<<<>[]>[[]<>]>]<<<()()><<>>>[({}())(<>[])]>}[({<(){}>({}{})}[[{}()]]){[[[]<>"
  "<(((<<[{[[<({({}<>)[{}()]}[{[]{}}([]())]){([[]<>]<[]<>>)[(()[])[{}[]]]}>(<<<{}[]><()[]>)>[[<{}("
  "[<<{[{{<<[[{<<()[]>(())><<{}()][<>()]>}({[{}{}][<>()]}<([]())([])>)]({{{[][]}[<>{}]}<[()]{{}()}>}(({"
  "{([(<[[<(<<<(<<><>><{}<>>)({{}()}[<>()])>{([(){}][[][]]){[<><>]{<><>}}}>>(({(<<><>><()<>>){{()<>}{(){}}}}"
  "[(<([[[([(({[[<>[]]]}))([{{[{}()]([]<>)}{{<>[]}[[][]]}}(<([]())>[([]{}){()<>}])][<{<()[]><()()>}>{<(["
  "{([[<<[[<[[[<[{}[]]{[]<>}>[<{}()>{<>[]}]]]<[<{[][]}(<>[])>[[{}[]]<[][]>]][((()[])[<>{}]){{{}()}[(){}]}]>]>"
  "{[[[<<{{[<<<([{}[]]<<>[]>)([()]<{}{}>)>({<<>{}>(()[])})>[(((<><>>{<>{}})<<<>[]>[[]()]>)({(()("
  "[[[{<<(({{[((<{}<>>[{}])({<>{}}<{}{}>))[(<{}()>(<>{}))(<<><>>{{}{}})]]({{<()>}}(<{(){}](<><>)"
  "(({{[[[<[{<{[<{}()><<>{}>]}({[[]()]<{}[]>])>}[<{{(<><>)<{}()>}{{{}<>}{{}[]}}}(([<>[]]([][]))"
  "<[<<{({[(<(<{({}<>)<[][]>}{(()[])({}[])}>{(<{}{}>>})>([<<<<>{}>((){})>[(()())[[]()]]><{[{}<>]<<>"
  "[{<{[(<[[[{({({}<>)(()<>)}{<[][]>})}{[<[()[]]{[]<>]>{<{}()>(()())}]{[<()()>{<>[]}]<[<><>]>}}]"
  "({{<{[[[([({{<<>()>(()<>)}(<{}()><()[]>)}<[[{}()]<{}[]>]{((){}){{}[]}}>)[([{<><>}<()<>>][(<><>)(()())]"
  "(({<{{{[([{<<<{}{}>{[]{}}>([<>[]]{[]{}})>}{<<{[]{}}[[]{}]>{<<>{}>([]())}><(<(){}>({}[]))[(<>[])(()<>)]>"
  "<[<(<{[[<([({[<>()][<>{}]}{{()()}[<><>]})]<[[<[]()>]<[{}<>]([])>]{<[<>[]]<<>()>]((<>())[<>{}])}>)([{<[[][]]"
  "<<{{((({<<[[<{<>()}(()())>[(()[])[()<>]]]{({{}[]}[<><>])}]<{<<<><>>{{}[]}>}<[<[][]>[{}[]]](<()()>{[]{}})"
  "[<<{<{([{(({[{()[]}{()}][({}{})(()[])]}{({<>()})({[]()}({}[]))}))}][[[([[{<>[]}[{}[]]][[<><>]<()[]>]](["
  "[([[{{<(<[{(<<()<>>><[[]()]{()()}>)<(({}()){[]<>})>}]>)>{<[<{{((()())({}<>)>{([]{}){{}<>}}}}<({"
  "((<<{(<[(<[[<({})>[{[][]}[<>[]]]]]>)]>)}([(<[[([(([][]))[{{}()}([][])]][((<><>){[]()})])]]<<("
  "<<<<(<{[{[({<{(){}}[<>]>[<[]<>>{<>()}]}[<[<>()]>{[[]<>][{}[]}}])(<{<(){}>[{}{}]}<(()<>)<()[]>>>)][<{{<[]<"
  "(([[<{[({{{[<<<><>>(()())>({[]<>}(<>()))]{<[<>()][{}{}]>([[]()]((){}))}}((<({}{})[<>]>([<>()]{(){}})))}[<{([<"
  "{[([<<[([[<[(<[]()>{()[]})<{<>()}{(){}}>]><<{<[][]><{}()>}(<[]<>>([]<>])>>]{[[<<{}<>>({}[]"
  "{{[<<(<({[<<{<[]<>>}{(<>())}>[{[<>]{(){}}}]>]}{{{<([()<>]{<>{}})(<()[]>[[]()])><[<<>[]>({}{})]((()())[{"
  "[{{[<{<<{{<[<<()()>[{}]>([{}{}]({}{}))]{(<[][]>([][]))(([]{})<<>[]>)}>}({{<{<>[]}[<>()]>(({"
  "[<{[(<<[<<(([[<>[]]][([]())({}<>}])){(({[]()}{()<>})[<[]{}>(<><>)])[<[{}[]][{}{}]><{(){}}<{}{}>>]}>({<<[[]()"
  "[({[<<<({<({({{}<>}[[]{}])}({({}<>)<<>[]>}))([<{(){}}>])>}{<{[[{{}{}}(<>{})]]<[[()[]]<<><>>]{[<><>]<{}()>"
  "[<{<<<<(([([[{{}()}[<>]][((){})[[]{}]]](({[]()}[[]()])[{[]()}(<>[])])){[{<<><>>{{}<>}}<{()[]}[[]"
  "[{({<(((<({{({[]()}))[((()())<[][]>)<{<>{}}(<><>)>]}{[<[[][]](<><>)>][[{<>{}}[<>{}]](<<>[]>{[][]})]})>)))>}"
  "[[{[[{({[([(<<<>[]>[<><>]>([{}()][<>()]))<<[<>{}]{{}<>}>[<<>{}>([]{}]]>])<(<(<[]()>)[(()[])"
  "<([(<<[<<({{{([]{})}[{()<>}<[]()>]}}{(<{[]{}}([][])>)})[[[<[[][]]<<><>>><{{}{}}(<><>)>]<<(()())[(){}]>{"
  "[(<{[{({[({<{<{}[]><<>()>}{<{}()>[[][]]}><<{{}()}{(){}}>>}[<{{<>{}}{()())}>]){[<[{()()}<[]()>]><[[{"
  "<{<[{([([<<[<[<>()]{(){}}>][({{}[]}((){}))[<[][]><()<>>]]>>{{{<{<><>}{(){}}>({<><>}<()))}({<()><{}[]>}(<("
  "({((([[{([<[(([]{})){[()<>][<><>]}]>{[<<{}{}><()[]>>(<<>>)]({<<><>>[<>{}]}{<[]{}><<>{}>})}])[(<(([<><>][{}{"
  "<[<(([(({([[<(()[])[[]{}]>{<<>{}>(<>{})}]]([([<>{}]{[]{}})][{<()>{()[]}}(({}[])(<>[]))]))})({{[(({(){}}[<>"))

  (defconst advent/day10-test
    '(
  "[({(<(())[]>[[{[]{<()<>>"
  "[(()[<>])]({[<{<<[]>>("
  "{([(<{}[<>[]}>{[]{[(<()>"
  "(((({<>}<{<{<>}{[]{[]{}"
  "[[<[([]))<([[{}[[()]]]"
  "[{[{({}]{}}([{[{{{}}([]"
  "{<[[]]>}<{[{[{[]{()[[[]"
  "[<(<(<(<{}))><([]([]()"
  "<{([([[(<>()){}]>(<<{{"
  "<{([{{}}[<[[[<>{}]]]>[]]"
      ))
#+END_SRC

#+RESULTS: day10-input
: advent/day10-test

#+NAME: day10-solution
#+BEGIN_SRC emacs-lisp :session day10
  (defun advent/day10-find-corrupted (lines)
    (let ((scores '((41 . 3)
                    (93 . 57)
                    (125 . 1197)
                    (62 . 25137)))
          (result 0)
          )
      (dolist (line lines)
        (cl-block corrupted
          (let ((stack ()))
            (dolist (char (append line nil))
              (cond
               ((or (= char 40)
                    (= char 91)
                    (= char 123)
                    (= char 60))
                (setq stack (cons char stack)))
               ((<= (abs (- char (car stack))) 2)
                (pop stack))
               (t (progn
                    (setq result (+ result (cdr (assoc char scores))))
                    (cl-return-from corrupted))))))))
      result)
    )

  (defun advent/day10-find-incomplete (lines)
    (let ((scores '((40 . 1)
                    (91 . 2)
                    (123 . 3)
                    (60 . 4)))
          (result ())
          )
      (dolist (line lines)
        (cl-block corrupted
          (let ((stack ()))
            (dolist (char (append line nil))
              (cond
               ((or (= char 40)
                    (= char 91)
                    (= char 123)
                    (= char 60))
                (setq stack (cons char stack)))
               ((<= (abs (- char (car stack))) 2)
                (pop stack))
               (t (cl-return-from corrupted))))
            (let ((score 0))
              (while stack
                (setq score (+ (* score 5) (cdr (assoc (pop stack) scores)))))
              (setq result (cons score result))))))
      (nth (/ (length result) 2) (sort result '<)))
    )

  (advent/day10-find-incomplete advent/day10-input)
#+END_SRC

#+RESULTS: day10-solution
: 1698395182
** Day 11
#+NAME: day11-input
#+BEGIN_SRC emacs-lisp :session day11
  (defconst advent/day11-input
    [
     [4 7 4 3 3 7 8 3 1 8]
     [4 6 6 4 2 1 2 8 4 4]
     [2 5 3 5 6 6 7 8 8 4]
     [3 2 7 3 3 6 3 8 6 1]
     [2 2 8 2 4 3 2 6 1 2]
     [2 1 6 6 6 1 2 1 3 4]
     [3 7 7 6 3 3 4 5 1 3]
     [8 1 2 3 8 5 2 5 8 3]
     [8 1 8 1 7 8 6 6 8 5]
     [4 3 6 2 5 3 3 1 7 4]
     ]
    )

  (defconst advent/day11-test
    [
     [5 4 8 3 1 4 3 2 2 3]
     [2 7 4 5 8 5 4 7 1 1]
     [5 2 6 4 5 5 6 1 7 3]
     [6 1 4 1 3 3 6 1 4 6]
     [6 3 5 7 3 8 5 4 7 8]
     [4 1 6 7 5 2 4 6 4 5]
     [2 1 7 6 8 4 1 7 2 1]
     [6 8 8 2 8 8 1 1 3 4]
     [4 8 4 6 8 4 8 5 5 4]
     [5 2 8 3 7 5 1 5 2 6]
     ]
    )
#+END_SRC

#+RESULTS: day11-input
: advent/day11-test

#+NAME: day11-solution
#+BEGIN_SRC emacs-lisp :session day11
  (require 'cl-lib)

  (defun advent/day11-count-flashes (octapi)
    "Count the flashes of OCTAPI in the bottom of the sea.
  The energy of the octapi is raised by one and any octapi that
    reach 10 are flashing and raising the energy of the octapi
    around them by 1.  At the end the energy of the octapi that
    have flashed is moved to 0 and the cycle begins.  All this for
    100 cycles."
    (let (flashes (result 0))
      (dotimes (i 100)
        ;; add one to all octapi
        (dotimes (line 10)
          (setf (aref octapi line) (cl-map 'vector #'1+ (aref octapi line))))
        (let ((flashing 11))
          (while (> (setq flashes (seq-reduce
                                   #'+
                                   (mapcar
                                    (lambda (x)
                                      (- x 9))
                                    (apply 'cl-concatenate 'list
                                           (mapcar
                                            (lambda (row)
                                              (seq-filter
                                               (lambda (elem)
                                                       (= elem 10))
                                               row))
                                            octapi)))
                                   0))
                    0)
            (setq result (+ result flashes)) ;; store the flashes after increment
            (dotimes (row 10) ;; set all flashes to flashing value
              (setf (aref octapi row) (cl-map 'vector (lambda (elem) (if (= elem 10) flashing elem)) (aref octapi row))))
            (dotimes (row 10)
              (dotimes (column 10)
                (if (= (aref (aref octapi row) column) flashing)
                    (progn
                      (advent/day11-flash-around octapi row (1- column))
                      (advent/day11-flash-around octapi (1- row) (1- column))
                      (advent/day11-flash-around octapi (1- row) column)
                      (advent/day11-flash-around octapi (1- row) (1+ column))
                      (advent/day11-flash-around octapi row (1+ column))
                      (advent/day11-flash-around octapi (1+ row) (1+ column))
                      (advent/day11-flash-around octapi (1+ row) column)
                      (advent/day11-flash-around octapi (1+ row) (1- column))
                      ))))
            (setq flashing (1+ flashing));; increment flashing for this session
            )) ;; Here I have collected all possible flashes.
        (dotimes (line 10) ;; Zero all flashed octapi.
          (setf (aref octapi line) (cl-map 'vector (lambda (elem) (if (> elem 9) 0 elem)) (aref octapi line)))))
      result))

  (defun advent/day11-find-all-flash (octapi)
    "Count the steps needed for all OCTAPI to flash together.
  The energy of the octapi is raised by one and any octapi that
    reach 10 are flashing and raising the energy of the octapi
    around them by 1.  At the end the energy of the octapi that
    have flashed is moved to 0 and the cycle begins.  All this for
    100 cycles."
    (let (flashes (result 0) (step 0))
      (while (not (= result 100))
        (cl-incf step)
        (setq result 0)
        ;; add one to all octapi
        (dotimes (line 10)
          (setf (aref octapi line) (cl-map 'vector #'1+ (aref octapi line))))
        (let ((flashing 11))
          (while (> (setq flashes (seq-reduce
                                   #'+
                                   (mapcar
                                    (lambda (x)
                                      (- x 9))
                                    (apply 'cl-concatenate 'list
                                           (mapcar
                                            (lambda (row)
                                              (seq-filter
                                               (lambda (elem)
                                                       (= elem 10))
                                               row))
                                            octapi)))
                                   0))
                    0)
            (setq result (+ result flashes)) ;; store the flashes after increment
            (dotimes (row 10) ;; set all flashes to flashing value
              (setf (aref octapi row) (cl-map 'vector (lambda (elem) (if (= elem 10) flashing elem)) (aref octapi row))))
            (dotimes (row 10)
              (dotimes (column 10)
                (if (= (aref (aref octapi row) column) flashing)
                    (progn
                      (advent/day11-flash-around octapi row (1- column))
                      (advent/day11-flash-around octapi (1- row) (1- column))
                      (advent/day11-flash-around octapi (1- row) column)
                      (advent/day11-flash-around octapi (1- row) (1+ column))
                      (advent/day11-flash-around octapi row (1+ column))
                      (advent/day11-flash-around octapi (1+ row) (1+ column))
                      (advent/day11-flash-around octapi (1+ row) column)
                      (advent/day11-flash-around octapi (1+ row) (1- column))
                      ))))
            (setq flashing (1+ flashing));; increment flashing for this session
            )) ;; Here I have collected all possible flashes.
        (dotimes (line 10) ;; Zero all flashed octapi.
          (setf (aref octapi line) (cl-map 'vector (lambda (elem) (if (> elem 9) 0 elem)) (aref octapi line)))))
      step))

  (defun advent/day11-flash-around (field row col)
    (cond
     ((or (< row 0)
          (< col 0)
          (>= row (length field))
          (>= col (length (aref field 0)))
          (> (aref (aref field row) col) 9)) nil)
     (t (setf (aref (aref field row) col) (1+ (aref (aref field row) col))))))

  (advent/day11-find-all-flash advent/day11-input)
#+END_SRC

#+RESULTS: day11-solution
: 440
** Day 12
#+NAME: day12
#+BEGIN_SRC emacs-lisp
  (defvar advent/day12-input '(start (yq VJ) #1=(YA #3=(yi
  #2=(JS (ez #5=end) #5#)) #4=(yq (ps (QT #3# #5# (zt mu)) #2# #3#)
  #2#)) (nf #1# #2# #4# #3#))
    ;; "start-yq"x
    ;; "start-nf"x
    ;; "start-YA"x
    ;; "nf-YA"x
    ;; "YA-yi"x
    ;; "yq-YA"x
    ;; "ps-yq"x
    ;; "zt-mu"x
    ;; "JS-yi"x
    ;; "yq-VJ"x
    ;; "QT-ps"x
    ;; "nf-JS"x
    ;; "JS-ez"x
    ;; "yq-JS"x
    ;; "ps-JS"x
    ;; "ps-yi"x
    ;; "yq-nf"x
    ;; "QT-yi"x
    ;; "end-QT"x
    ;; "nf-yi"x
    ;; "zt-QT"x
    ;; "end-ez"x
    ;; "end-JS"x
    )

  (defvar advent/day12-test
    '(start #1=(HN (end)) #2=(kj (sa) #1#) (dc #1# (LN) #2#)))
#+END_SRC

#+RESULTS: day12
: advent/day12-test
* Advent of Code 2022
** day template
#+NAME: 2022-dayXX-input
#+BEGIN_SRC emacs-lisp :session "dayXX"
(defconst aoc22/dayXXtest '("TBD"))

(defconst aoc22/dayXXinput '("TBD"))

#+END_SRC

#+NAME: 2022-dayXX-solution
#+BEGIN_SRC emacs-lisp :session "dayXX" :val x=2022-dayXX-input
;;; Code:

(defun aoc22/dayXX-part1 (input)
  "Takes INPUT and solve the puzzle.
To be replaced with actual docstring."
  (car input))

(defun aoc22/dayXX-part2 (input)
  "Takes INPUT and solve the puzzle.
To be replaced with actual docstring."
  (car input))

;;; Helper functions:

;;; Results vector

(vector (aoc22/dayXX-part1 aoc22/dayXXtest)
        (aoc22/dayXX-part1 aoc22/dayXXinput)
        (aoc22/dayXX-part2 aoc22/dayXXtest)
        (aoc22/dayXX-part2 aoc22/dayXXinput))
#+END_SRC

** day 1
#+NAME: 2022-day1-input
#+BEGIN_SRC emacs-lisp :session "day1"
(defconst aoc22/day1test '((1000 2000 3000)
                           (4000)
                           (5000 6000)
                           (7000 8000 9000)
                           (10000)))

(defconst aoc22/day1input '(
                            ( 6758 5199 10292 8812 3527 10178
                              1340 2824 )
                            ( 62522 )
                            ( 22990 )
                            ( 6730 )
                            ( 7255 3210 3003 8296 8799 7655
                              10312 )
                            ( 18837 19882 5386 15891 )
                            ( 4203 36288 )
                            ( 1586 2295 4981 2109 2284 5814 4823
                              5492 1524 5286 2147 2952 4783 4814
                              3042 )
                            ( 8474 4059 14465 13390 )
                            ( 4623 2150 7545 7833 3686 2095 3336
                              5030 7648 4087 4482 )
                            ( 31278 29863 )
                            ( 1228 4851 2706 1692 3200 3521 5200
                              3755 3922 5181 5561 5162 5280 2460
                              )
                            ( 1083 4432 4938 4303 6304 3746 3527
                              3141 3198 4980 4395 )
                            ( 8218 3954 1396 2147 7924 4650 4483
                              6610 4799 3973 )
                            ( 3401 4111 7798 5181 8418 5014 5975
                              7916 7788 1864 )
                            ( 8547 13217 9699 5701 11040 2943 )
                            ( 6214 3287 4137 6773 2593 4776 1687
                              2821 7240 3681 1185 6578 )
                            ( 7850 6697 4844 2325 1834 6812 3380
                              2302 2531 4959 )
                            ( 5275 1883 6919 2865 7943 7718 9494
                              7957 )
                            ( 28727 22865 )
                            ( 3064 4279 2649 12521 )
                            ( 10169 16383 3301 12707 )
                            ( 3533 2280 9232 10618 1488 7616
                              4334 7847 )
                            ( 4322 1215 3514 5513 3469 5472 3658
                              1096 3410 1607 5482 3015 5234 2488
                              )
                            ( 1306 8067 3375 4064 2943 6158 3911
                              7766 2493 4897 6551 )
                            ( 10694 13319 )
                            ( 10862 2483 8522 4509 5021 8789
                              6152 )
                            ( 7824 23812 6740 )
                            ( 6548 2116 14900 )
                            ( 3470 1825 2865 4691 4729 4263 4899
                              4855 3732 4439 5023 1291 3121 5322
                              )
                            ( 6529 )
                            ( 5141 2353 8515 9815 9541 10389
                              1114 1373 )
                            ( 11924 11446 20373 )
                            ( 37249 )
                            ( 5749 2968 5300 5405 7280 6161 4298
                              7104 7140 3405 5754 )
                            ( 4763 11364 7492 5630 15978 )
                            ( 3622 2185 12718 2466 5015 11302 )
                            ( 65579 )
                            ( 5450 6455 )
                            ( 5721 1939 8537 7075 1317 1805 1701
                              4578 8435 1718 )
                            ( 10692 6581 3068 9013 1741 4654
                              2159 5340 )
                            ( 4981 6327 6931 3024 1263 4313 6793
                              2818 6727 2245 4524 5825 )
                            ( 10156 11779 1694 7495 1615 8872
                              11840 )
                            ( 7323 7184 4094 3989 1820 2141 7277
                              3208 2064 7765 5764 )
                            ( 2796 3030 2783 3426 5581 1659 2369
                              2784 5284 4110 1157 3129 6088 2215
                              3503 )
                            ( 20991 1521 )
                            ( 1601 4869 9195 1835 5402 2721 1128
                              1991 9336 )
                            ( 2557 6635 6981 6296 5278 3077 7679
                              5764 2359 2467 6705 )
                            ( 2594 2611 3189 1436 1510 1341 8213
                              8525 5447 2045 )
                            ( 3812 2106 6216 3236 7169 5840 4770
                              1724 1061 5062 7990 )
                            ( 5722 4372 3524 1561 3417 5807 3969
                              3635 3067 3469 4393 1705 4897 4307
                              2663 )
                            ( 28920 3093 )
                            ( 12949 9070 9161 3530 6651 )
                            ( 12010 1783 21165 )
                            ( 4667 3553 6938 5433 3244 1082 7305
                              7262 6577 1987 2256 )
                            ( 4933 1802 1315 1303 1722 2688 6103
                              2749 1478 4994 4369 5074 5655 2827
                              3232 )
                            ( 1101 2284 4349 4868 3264 3227 1786
                              5233 6054 6144 3533 1841 1721 4775
                              )
                            ( 16514 )
                            ( 7282 7260 2423 1738 4498 5570 3862
                              3979 3845 4313 3249 5639 )
                            ( 7910 9862 7476 9103 2851 3634 8641
                              7369 )
                            ( 8574 1439 1442 12337 1387 7777 )
                            ( 18060 )
                            ( 10287 1924 4066 12275 14094 )
                            ( 4797 5061 2701 1391 6617 5870 4999
                              4150 2881 2667 2461 1978 1058 )
                            ( 12911 7290 9442 2875 5812 )
                            ( 13016 4985 2517 9758 11215 )
                            ( 2845 11805 6418 8128 1604 )
                            ( 9643 6574 6804 3575 9226 6276 1406
                              4493 8104 )
                            ( 11616 7196 5685 1267 3281 1250
                              7666 )
                            ( 9654 8646 7144 2790 7583 2681 1799
                              5301 1714 )
                            ( 30086 23066 )
                            ( 10205 7316 1550 4056 2627 10056 )
                            ( 9912 1615 1584 2963 1347 9336 8310
                              8728 )
                            ( 2436 4741 6665 5239 5737 4252 1954
                              4916 5341 7475 5909 5012 )
                            ( 4897 8580 5122 1865 8318 5369 2334
                              5629 7058 )
                            ( 14621 2969 15900 14828 2997 )
                            ( 7051 3305 7848 7947 3961 3206 5175
                              7055 3182 5838 1954 )
                            ( 6614 3086 7740 6624 4106 7195 )
                            ( 3815 4858 3460 1427 5685 5865 4790
                              6660 1510 5685 2790 5112 )
                            ( 13626 1665 16722 9598 )
                            ( 15870 )
                            ( 3453 8531 9997 8590 5833 7896 8524
                              )
                            ( 6783 5931 3245 4327 5496 5017 2136
                              3899 3875 2904 5023 3173 3227 )
                            ( 4241 4693 1164 1877 5541 5017 3433
                              3333 4734 3639 1724 2439 1673 4362
                              )
                            ( 6479 3259 3496 6125 1147 3181 3948
                              5746 3019 1924 )
                            ( 6250 26443 )
                            ( 4901 6813 6581 3144 1525 6629 3254
                              6542 1156 6663 3856 4083 1598 )
                            ( 7932 8717 9657 1873 2727 2052 2376
                              )
                            ( 6455 13127 3540 8038 6601 2249 )
                            ( 6226 5251 3416 5941 7336 5668 4139
                              1459 2529 7538 )
                            ( 6899 4680 10277 2515 16361 )
                            ( 23283 2647 )
                            ( 1272 3462 6817 3795 4973 6750 2340
                              7379 3873 1832 7935 )
                            ( 4808 4018 11801 7092 8312 9718
                              6693 )
                            ( 7285 7822 7063 2854 7844 1121 4362
                              4685 5360 7140 6796 )
                            ( 17114 20195 9330 )
                            ( 19378 27739 )
                            ( 16288 15298 13251 5444 10856 )
                            ( 7616 6108 3420 9201 3422 4312 4388
                              3008 9551 )
                            ( 1255 7803 1598 3892 6954 7936 8078
                              5261 2057 2914 )
                            ( 7497 10296 2343 10020 1171 3092
                              2333 )
                            ( 1492 4718 4267 10309 7919 7080
                              1012 9981 )
                            ( 17367 1357 16269 7775 )
                            ( 13641 3004 13280 )
                            ( 6205 3003 1634 4608 2759 6324 4372
                              4833 6565 2865 7345 3719 )
                            ( 4268 2071 2155 4408 4869 2634 1329
                              2075 4276 4032 2129 5181 2594 2102
                              2281 )
                            ( 2486 7483 6748 4017 5926 3507 4666
                              3837 )
                            ( 8082 13626 12247 5622 13565 )
                            ( 7911 1180 1854 5795 7017 6873 7728
                              5055 5207 7810 7474 )
                            ( 3459 5418 1420 5028 6793 4851 2885
                              2263 2734 4868 6596 1434 5440 )
                            ( 3368 3541 5756 3039 4234 2632 6031
                              5613 4769 1538 4898 5128 4848 )
                            ( 2817 3013 2260 4714 6461 3262 3924
                              4083 2487 4221 5311 4274 5591 1625
                              )
                            ( 8756 8549 9481 7994 7775 6951 5276
                              7598 9126 )
                            ( 11749 7152 14494 )
                            ( 14395 7799 16109 14178 )
                            ( 24404 4941 )
                            ( 5326 9070 3951 1404 6513 9155 5981
                              3880 1476 )
                            ( 12661 10966 )
                            ( 3517 7760 4724 6891 1447 3337 3903
                              7382 7067 1771 1184 )
                            ( 3556 13458 12699 12330 13534 11244
                              )
                            ( 10818 31380 )
                            ( 17968 3978 17994 )
                            ( 9486 6163 1748 3765 7191 1461 2062
                              8169 9167 )
                            ( 3111 4378 3560 6292 5521 2132 5071
                              4519 1977 6587 )
                            ( 11961 2119 11633 10970 4089 7390
                              6481 )
                            ( 4350 5261 4801 1584 1531 5034 5917
                              4136 6668 5364 3814 3873 4437 )
                            ( 2568 2449 5582 1857 6143 5457 4396
                              3723 2885 2428 2790 4173 1726 5687
                              )
                            ( 21758 )
                            ( 32901 )
                            ( 4313 12688 14465 1073 6568 )
                            ( 2295 3872 5979 3014 1408 1865 2937
                              4231 5076 2544 3270 2673 6060 4292
                              1073 )
                            ( 5340 10378 10445 11874 8275 8558
                              1558 )
                            ( 3652 9630 15612 18471 )
                            ( 5856 4627 4762 6094 5266 2970 1230
                              6292 5083 4557 6158 5841 6321 3672
                              )
                            ( 4531 2204 4583 4426 4310 6136 5577
                              4765 6882 1300 2979 6754 4241 )
                            ( 3266 6610 2322 12666 11874 10495 )
                            ( 7493 2468 2710 6550 7383 4442 3692
                              8168 )
                            ( 4381 3648 4270 3016 4178 3066 1736
                              5402 4995 1980 5438 5256 4804 4854
                              2585 )
                            ( 4096 4397 4061 3811 2537 3296 1877
                              4267 2760 3682 5949 3713 3365 4135
                              1310 )
                            ( 30319 )
                            ( 7244 6071 1234 6387 1980 1935 3431
                              6474 6601 1652 )
                            ( 10125 11599 )
                            ( 4436 3242 6077 6707 1582 6648 3345
                              5812 1635 2782 2514 2608 )
                            ( 9244 1348 5019 2059 9226 2546 5130
                              8902 7779 )
                            ( 10030 10749 3690 8769 9835 7216
                              2132 )
                            ( 6105 1205 1860 3190 5815 1424 2611
                              1230 4491 1731 5804 2863 1816 3694
                              )
                            ( 4791 6491 3292 3310 2223 4296 6323
                              3414 1462 6799 3276 4435 5554 )
                            ( 2859 2854 1127 4179 6233 6219 5955
                              3139 2457 3854 5071 4887 4190 4469
                              )
                            ( 67818 )
                            ( 7880 6503 4931 5813 1692 2126 6300
                              8743 4983 2182 )
                            ( 1882 5752 6369 1996 2955 5978 6087
                              5123 2587 2000 4973 2214 5118 3178
                              )
                            ( 10807 9780 8468 2157 1021 8078
                              4848 )
                            ( 3400 1666 6908 10199 1685 4979 )
                            ( 2250 5672 2505 9061 5514 8895 4958
                              8274 7707 )
                            ( 15083 2359 23052 )
                            ( 6279 1563 4247 4593 4844 5335 7024
                              7324 5904 1016 3394 3382 )
                            ( 2965 2673 3329 1833 1222 1789 1027
                              6268 4404 1031 1407 4510 4047 1972
                              )
                            ( 4423 8018 4991 7190 7061 6223 5972
                              2864 5674 )
                            ( 1559 1850 4117 1495 2604 2243 1498
                              4936 2970 4109 1252 6416 5293 3319
                              )
                            ( 5577 4032 3528 6140 5994 2811 3247
                              7297 5776 3863 4240 3973 )
                            ( 9884 8267 )
                            ( 3047 4053 2400 4246 3193 2309 4014
                              1369 1437 )
                            ( 10529 2975 3033 10601 13985 )
                            ( 12323 9086 2903 7243 8351 12729 )
                            ( 13982 7013 7500 11098 9206 )
                            ( 11963 3055 9862 2601 13991 )
                            ( 66684 )
                            ( 6171 1924 1569 3761 4616 5565 3644
                              1817 4029 2333 1934 2492 6161 )
                            ( 2802 1498 3232 7475 5503 4913 6759
                              8657 4445 )
                            ( 18324 19871 )
                            ( 6287 4271 7871 1097 1932 5980 5376
                              7824 4911 4751 6453 )
                            ( 8374 3293 7175 8288 1217 4831 1514
                              6681 2596 6199 )
                            ( 32039 )
                            ( 1235 2206 6429 4880 5463 6814 1530
                              3544 4685 3169 6752 5854 6764 )
                            ( 6115 6039 6519 6414 4558 5214 4411
                              2882 6006 5117 5321 2059 )
                            ( 2431 5892 1839 5352 3295 2768 4788
                              5271 1503 1173 4691 4906 4346 1043
                              )
                            ( 5172 5976 6248 4288 3851 8543 4189
                              4396 )
                            ( 10361 14864 18037 )
                            ( 7381 5180 1829 3624 3144 3962 5923
                              4356 1477 3153 2891 5196 )
                            ( 3143 3180 4428 3418 6243 3480 1151
                              4262 4958 4641 3823 1469 2149 )
                            ( 3702 4159 3799 4639 5703 2425 4579
                              2397 2814 3959 3987 3088 2982 2338
                              3432 )
                            ( 7256 16171 12417 11290 13105 )
                            ( 2594 5105 6253 4743 4251 6439 3370
                              5662 2763 3147 6366 4537 6279 6104
                              )
                            ( 7926 3430 2206 4334 5226 1817 2404
                              2587 8020 1849 )
                            ( 1257 6091 2485 6366 3184 4775 5987
                              3473 5761 1905 3742 5478 5343 )
                            ( 3336 5819 2617 2756 5602 3921 4660
                              5041 1471 2297 5575 1473 6059 3111
                              5789 )
                            ( 2647 6183 5004 2750 2772 1964 4453
                              2132 3181 2916 1804 4666 1215 6354
                              )
                            ( 1449 1539 3005 3167 1712 6222 6007
                              4141 1481 6198 4476 3850 3885 5880
                              )
                            ( 1833 5557 3185 6117 3456 2789 4576
                              1439 3212 5223 2687 2368 3270 4629
                              4716 )
                            ( 10123 6686 12658 )
                            ( 6838 4415 10796 6040 3065 1832
                              11624 )
                            ( 69368 )
                            ( 5469 8816 7624 13506 )
                            ( 8923 1621 10042 )
                            ( 6113 9373 9212 7054 3193 6588 7743
                              4224 4983 )
                            ( 1911 1589 2667 3095 3768 5898 4574
                              3456 3281 4176 1591 3383 5063 )
                            ( 1378 5923 9019 4379 2932 3918 9631
                              )
                            ( 7851 6466 2388 13209 7613 2396 )
                            ( 3015 1119 4172 2459 3872 5912 4012
                              2894 2765 1950 4147 4523 2504 4691
                              2038 )
                            ( 4472 5029 3599 6237 8566 3508 7995
                              3756 6631 3625 )
                            ( 16549 15550 22868 )
                            ( 7356 11800 8330 14503 9470 )
                            ( 1306 1960 6574 7234 3841 1006 4156
                              2019 6187 2494 7475 5916 )
                            ( 8894 9358 9666 8711 10140 11205 )
                            ( 8123 19317 11676 7989 )
                            ( 7610 3163 9789 6331 6998 7288 4632
                              5340 )
                            ( 7105 15276 22300 )
                            ( 11919 6212 5062 )
                            ( 18496 10383 10695 4206 )
                            ( 8127 2277 10392 1337 2779 5380
                              3881 6556 )
                            ( 5514 6678 2324 4686 3807 4785 3972
                              )
                            ( 1488 3662 4866 2687 3519 2605 5189
                              5313 4112 2559 1887 5656 5931 1816
                              )
                            ( 9949 11409 8427 15008 2241 )
                            ( 1942 1004 1070 5860 4932 4055 2922
                              5129 1232 4940 5270 1023 5323 2002
                              2727 )
                            ( 48445 )
                            ( 6687 4155 2999 3348 )
                            ( 5347 4592 1463 3080 3520 5283 3166
                              2945 2891 1100 5372 5797 3060 5748
                              5592 )
                            ( 8132 3941 7625 4458 2714 7390 4305
                              1612 6707 )
                            ( 2105 2880 6683 6257 6472 1371 3493
                              1542 4431 5003 3276 2205 3417 )
                            ( 6421 4279 1213 6274 3757 6856 3244
                              1554 2716 1854 1924 3769 6344 )
                            ( 1081 2601 2607 6042 1967 2924 4656
                              6462 1747 4278 6384 4427 5074 6454
                              )
                            ( 6344 13912 15708 1335 5433 )
                            ( 5862 7799 3707 9404 10527 10543
                              6428 )
                            ( 2009 17261 13328 )
                            ( 10389 9214 9189 8747 12720 9443 )
                            ( 7162 2362 3837 8891 2098 8577 9063
                              3336 5023 )
                            ( 1322 12214 5387 9804 9542 6149 )
                            ( 1997 6709 6614 5116 6691 5904 5563
                              2437 4442 7346 5749 7194 )
                            ( 5836 15439 9020 9124 )
                            ( 6761 4892 5956 2500 6879 1980 1908
                              1705 6157 4559 5776 1235 3077 )
                            ( 10155 8529 7837 7027 7897 6504
                              4192 7193 )
                            ( 9711 17664 4069 10400 )
                            ( 24373 20215 )
                            ( 2155 9371 9201 5590 9806 13380 )
                            ( 7716 1116 6106 2703 2403 3549 3740
                              6658 4769 )
                            ( 13954 36130 )
                            ( 1767 7955 5622 5077 2512 8206 4501
                              2917 9336 )
                            ( 1601 23493 16981 )
                            ( 3719 2266 1982 4557 3198 3815 5006
                              2587 4173 2965 2658 4890 5723 4231
                              )
                            ( 19350 )
                            ( 19637 13784 21672 )
                            ( 17040 29745 )
                            ( 2037 7872 5766 7919 1382 9398 3197
                              )
                            ( 11570 12560 6206 12642 3275 )
                            ( 1535 6685 5587 12955 12197 )
                            ( 2980 15784 12178 12996 )
                            ( 7928 8780 7528 5428 8181 8527 5229
                              3850 2012 2975 )
                            ( 30992 26372 )
                            ( 4384 2425 2332 1309 3899 3062 4825
                              1428 1116 3635 1669 1922 5941 4378
                              2742 )
                            ( 1961 4243 4443 3070 5786 3638 6330
                              2461 1612 4572 3551 3831 3263 6173
                              )
                            ( 2759 3889 5197 4293 2957 6305 3797
                              1465 4674 5659 5258 3775 4436 2260
                              )
                            ( 5141 8383 6249 9982 4848 2675 4232
                              8974 )
                            ( 11489 11733 9990 4150 4533 3032
                              1044 )
                            ( 62338 )
                            ( 3645 5406 4672 3889 5799 5760 4356
                              5557 4120 2771 3399 5292 3640 3989
                              6047 )
                            ( 4629 6897 4312 2108 5301 1122 1893
                              5508 3414 2180 4254)))
#+END_SRC

#+RESULTS: 2022-day1-input
: aoc22/day1input

#+NAME: 2022-day1-solution
#+BEGIN_SRC emacs-lisp :session "day1"
;;; Code:

(defun aoc22/day1-part1 (list)
  "Function to solve day1 part1 of advent of code 2022 with input LIST.
  Need to find the elf with the most calories at hand"
  (let (result)
    (dolist (elem list)
      (setq result (append result (list (cl-reduce #'+ elem)))))
    (cl-reduce #'max result)))


(defun aoc22/day1-part2 (list)
  "Function to solve day1 part2 of advent of code 2022 with input LIST.
  Need to find the combined calories of the top three elves."
  (let (result)
    (dolist (elem list)
      (setq result (append result (list (cl-reduce #'+ elem)))))
    (let ((sorted-result (sort result #'>)))
      (+ (car sorted-result) (cadr sorted-result) (caddr sorted-result)))))

;;; Results vector
(vector (aoc22/day1-part1 aoc22/day1test)
        (aoc22/day1-part1 aoc22/day1input)
        (aoc22/day1-part2 aoc22/day1test)
        (aoc22/day1-part2 aoc22/day1input))
#+END_SRC

#+RESULTS: 2022-day1-solution
: [24000 71506 45000 209603]

** day 2
#+NAME: 2022-day2-input
#+BEGIN_SRC emacs-lisp :session "day2"
(defconst aoc22/day2test '((A . Y)
                           (B . X)
                           (C . Z)))

(defconst aoc22/day2input '((B . Y)
                            (A . X)
                            (B . Y)
                            (A . Y)
                            (A . Z)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (A . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (C . Z)
                            (A . X)
                            (B . Y)
                            (C . Z)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . Z)
                            (B . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (A . Z)
                            (A . Z)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (C . Y)
                            (C . Z)
                            (B . Z)
                            (B . X)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (C . Z)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (B . X)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (B . X)
                            (B . Z)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (C . Z)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (A . Z)
                            (A . X)
                            (C . X)
                            (B . X)
                            (A . X)
                            (A . X)
                            (C . Z)
                            (A . Z)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (C . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (A . Y)
                            (B . Y)
                            (B . Z)
                            (A . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . Z)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (C . Z)
                            (C . Z)
                            (A . Y)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . X)
                            (A . Z)
                            (A . Y)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . X)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (A . X)
                            (B . X)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (C . Y)
                            (B . X)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (C . Z)
                            (A . Y)
                            (B . Y)
                            (A . Z)
                            (B . Z)
                            (C . Y)
                            (A . Z)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (C . X)
                            (B . Z)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (A . Z)
                            (C . X)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . X)
                            (A . Z)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (C . Z)
                            (B . X)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . X)
                            (B . Z)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (A . X)
                            (C . Z)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (C . Z)
                            (B . X)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (C . Y)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . X)
                            (C . Z)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (B . X)
                            (B . X)
                            (C . Z)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (C . Z)
                            (A . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (A . Z)
                            (B . Y)
                            (C . Z)
                            (B . Z)
                            (C . Z)
                            (B . Z)
                            (A . Y)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . X)
                            (C . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (A . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (B . X)
                            (B . X)
                            (A . X)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (A . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (A . Z)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (C . Y)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (A . X)
                            (A . X)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (A . Z)
                            (C . Z)
                            (C . X)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (C . Z)
                            (B . Y)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (A . Y)
                            (A . Z)
                            (B . Z)
                            (B . X)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (B . Z)
                            (A . Y)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (B . Z)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . X)
                            (C . Y)
                            (A . X)
                            (A . X)
                            (A . X)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (C . X)
                            (A . X)
                            (B . X)
                            (C . Z)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (A . Z)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (A . Y)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (C . Z)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (A . Z)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (C . Z)
                            (C . X)
                            (C . Y)
                            (A . Y)
                            (C . Y)
                            (C . Z)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (A . Z)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (C . Y)
                            (C . Y)
                            (C . Y)
                            (B . X)
                            (C . Z)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . Y)
                            (A . Z)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . X)
                            (C . Y)
                            (C . Z)
                            (C . Y)
                            (C . Y)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (C . Z)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (B . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (B . X)
                            (B . Z)
                            (C . Y)
                            (C . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (B . X)
                            (B . X)
                            (B . Z)
                            (B . Z)
                            (B . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (B . Z)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (A . Z)
                            (C . Y)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (C . X)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (B . X)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . X)
                            (A . Y)
                            (B . Y)
                            (B . Z)
                            (C . Z)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (A . X)
                            (A . Y)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (B . X)
                            (C . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (C . X)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (C . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (A . Z)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (C . Y)
                            (A . X)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (A . Y)
                            (A . X)
                            (A . Z)
                            (C . Y)
                            (C . X)
                            (C . X)
                            (C . Z)
                            (C . X)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (A . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (B . X)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (C . Y)
                            (C . X)
                            (C . Z)
                            (A . Z)
                            (C . X)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (A . Z)
                            (A . X)
                            (A . X)
                            (C . X)
                            (A . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (C . Z)
                            (A . Z)
                            (B . Z)
                            (A . X)
                            (A . Z)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (A . X)
                            (A . X)
                            (C . Z)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (A . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (A . Y)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (C . Z)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (A . Z)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (B . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (A . X)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (A . Z)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (A . Z)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . X)
                            (C . X)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . Z)
                            (C . Y)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (B . Z)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (C . Z)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . X)
                            (B . X)
                            (B . Z)
                            (C . Z)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (B . X)
                            (C . X)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (C . Z)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (A . Y)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (A . Z)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (A . Z)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (C . X)
                            (C . X)
                            (A . Z)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (A . Z)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (A . Z)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (B . X)
                            (B . Z)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (A . Z)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . X)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (A . Z)
                            (C . X)
                            (B . X)
                            (A . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . Z)
                            (B . Z)
                            (C . Z)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (B . X)
                            (B . X)
                            (C . Y)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . Z)
                            (B . X)
                            (B . Y)
                            (C . Z)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (B . Z)
                            (A . X)
                            (A . Z)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Z)
                            (B . X)
                            (A . X)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (C . Z)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . X)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . Z)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (A . Y)
                            (C . Y)
                            (C . Z)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (A . Y)
                            (C . Y)
                            (C . X)
                            (B . Z)
                            (C . Z)
                            (B . X)
                            (B . X)
                            (C . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (C . Z)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . Z)
                            (A . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (C . Z)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (A . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . Z)
                            (C . Y)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (C . Z)
                            (B . Y)
                            (B . Z)
                            (C . Z)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . X)
                            (A . X)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (A . X)
                            (C . X)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (A . Z)
                            (B . Y)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (C . Z)
                            (C . X)
                            (C . X)
                            (C . Y)
                            (A . X)
                            (C . Z)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (B . X)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (A . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (B . Z)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (A . Y)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (A . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (A . X)
                            (B . X)
                            (B . Z)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (C . Z)
                            (B . Y)
                            (C . Y)
                            (C . Z)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . X)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (C . Z)
                            (B . Y)
                            (A . X)
                            (C . Z)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . Z)
                            (C . Y)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (A . Y)
                            (A . Z)
                            (A . Y)
                            (C . X)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . Z)
                            (A . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . Z)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (C . Z)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (A . Z)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (A . X)
                            (C . Y)
                            (C . Z)
                            (B . Z)
                            (A . Z)
                            (B . X)
                            (A . Z)
                            (C . Z)
                            (A . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (B . X)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (A . Z)
                            (B . X)
                            (B . Z)
                            (A . Z)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (A . X)
                            (B . Z)
                            (C . Y)
                            (C . Y)
                            (C . X)
                            (A . Z)
                            (B . X)
                            (C . X)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (B . X)
                            (B . X)
                            (C . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (A . X)
                            (A . X)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (B . X)
                            (A . X)
                            (C . X)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (A . Y)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (A . X)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (C . X)
                            (A . X)
                            (C . Y)
                            (C . Y)
                            (A . Y)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (C . Y)
                            (C . Y)
                            (A . Y)
                            (C . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (A . X)
                            (B . X)
                            (B . X)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (A . Z)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (C . X)
                            (C . X)
                            (C . X)
                            (C . X)
                            (B . X)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (C . Z)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (A . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (A . Z)
                            (C . Y)
                            (B . X)
                            (C . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (B . Z)
                            (C . Z)
                            (A . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (A . X)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . X)
                            (B . Z)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (A . Z)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (A . X)
                            (C . Y)
                            (B . Y)
                            (A . Z)
                            (C . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (A . Z)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (A . X)
                            (A . Z)
                            (C . Y)
                            (A . X)
                            (C . X)
                            (C . X)
                            (A . X)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (B . X)
                            (B . Y)
                            (C . X)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (A . Z)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Z)
                            (B . Y)
                            (A . X)
                            (C . Z)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (C . Y)
                            (B . Y)
                            (B . Z)
                            (B . Z)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (C . X)
                            (A . Z)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . Y)
                            (C . X)
                            (C . X)
                            (C . Y)
                            (C . Y)
                            (B . X)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (A . X)
                            (C . Z)
                            (C . Y)
                            (C . Y)
                            (A . X)
                            (C . Z)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . X)
                            (C . X)
                            (C . X)
                            (C . Z)
                            (C . Y)
                            (A . X)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . X)
                            (C . X)
                            (B . Z)
                            (C . X)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . X)
                            (C . Y)
                            (B . X)
                            (B . Y)
                            (B . Z)
                            (B . Y)
                            (A . Y)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (C . X)
                            (C . Z)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (C . Z)
                            (B . Y)
                            (C . Z)
                            (C . X)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (C . Z)
                            (B . Z)
                            (A . Y)
                            (C . X)
                            (A . X)
                            (A . Z)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (B . X)
                            (C . Y)
                            (B . Y)
                            (B . Y)
                            (C . Y)
                            (C . Y)
                            (B . Y)
                            (A . X)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (C . Y)
                            (B . X)
                            (B . X)
                            (B . X)
                            (A . X)
                            (B . Z)
                            (B . Y)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (C . X)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (B . Z)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (C . Z)
                            (B . Y)
                            (A . X)
                            (A . X)
                            (A . Y)
                            (C . X)
                            (B . Z)
                            (B . X)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Z)
                            (A . X)
                            (C . X)
                            (A . Y)
                            (A . X)
                            (C . X)
                            (C . Z)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . X)
                            (B . Z)
                            (B . X)
                            (A . Z)
                            (C . Z)
                            (A . X)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (A . X)
                            (B . X)
                            (B . Z)
                            (B . Y)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (C . Y)
                            (C . X)
                            (B . Y)
                            (C . X)
                            (A . Y)
                            (B . Y)
                            (B . Y)
                            (B . Y)
                            (B . Z)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (B . Y)
                            (A . Z)
                            (C . X)
                            (B . X)
                            (A . X)
                            (C . Z)
                            (B . Y)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (C . X)
                            (A . Y)
                            (A . X)
                            (B . Z)
                            (B . Z)
                            (B . X)
                            (B . Z)
                            (C . Z)
                            (C . Y)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (B . Y)
                            (A . Y)
                            (C . X)
                            (B . Z)
                            (B . Y)
                            (C . X)
                            (B . X)
                            (C . X)
                            (A . X)
                            (B . Z)))
#+END_SRC

#+RESULTS: 2022-day2-input
: aoc22/day2input

#+CALL: 2022-day2-input
#+NAME: 2022-day2-solution
#+BEGIN_SRC emacs-lisp :session "day2"
(defun aoc22/day2-part1 (input)
  "This function takes INPUT and produces the score of Rock Papers Scissors session.
  For car, A = Rock, B = Paper and C = Scissors
  For cadr X = Rock, Y = Paper and Z = Scissors
  Scoring is as follows:
  Shape selected -> X=1, Y=2, Z=3
  Result of game -> L=0, D=3, W=6
  Final score = Shape + Result

  The INPUT is given as a list of pairs"
  (let ((score 0))
    (dolist (pair input)
      (let ((elf (car pair))
            (me (cdr pair)))
        ;; Add score of selected shape
        (cond
         ((eq me 'X) (cl-incf score 1))
         ((eq me 'Y) (cl-incf score 2))
         ((eq me 'Z) (cl-incf score 3)))
        ;; Add result of single match
        (cond
         ((eq elf 'A)
          (cond
           ((eq me 'X) (cl-incf score 3))
           ((eq me 'Y) (cl-incf score 6))))
         ((eq elf 'B)
          (cond
           ((eq me 'Y) (cl-incf score 3))
           ((eq me 'Z) (cl-incf score 6))))
         ((eq elf 'C)
          (cond
           ((eq me 'Z) (cl-incf score 3))
           ((eq me 'X) (cl-incf score 6)))))
        ))
    score))

(defun aoc22/day2-part2 (input)
  "This function takes INPUT and produces the score of Rock Papers Scissors session.
  For car, A = Rock, B = Paper and C = Scissors
  For cadr X = Lose, Y = Draw and Z = Win
  Scoring is as follows:
  Shape selected -> Rock=1, Paper=2, Scissors=3
  Result of game -> Lose=0, Draw=3, Win=6
  Final score = Shape + Result

  The INPUT is given as a list of pairs"
  (let ((score 0))
    (dolist (pair input)
      (let ((elf (car pair))
            (me (cdr pair)))
        ;; Add score of requested outcome
        (cond
         ((eq me 'Y) (cl-incf score 3))
         ((eq me 'Z) (cl-incf score 6)))
        ;; Add score of selected item (according to requested outcome)
        (cond
         ((eq me 'X)
          (cond
           ((eq elf 'A) (cl-incf score 3))
           ((eq elf 'B) (cl-incf score 1))
           ((eq elf 'C) (cl-incf score 2))))
         ((eq me 'Y)
          (cond
           ((eq elf 'A) (cl-incf score 1))
           ((eq elf 'B) (cl-incf score 2))
           ((eq elf 'C) (cl-incf score 3))))
         ((eq me 'Z)
          (cond
           ((eq elf 'A) (cl-incf score 2))
           ((eq elf 'B) (cl-incf score 3))
           ((eq elf 'C) (cl-incf score 1)))))
        ))
    score))

;;; Results vector
(vector (aoc22/day2-part1 aoc22/day2test)
        (aoc22/day2-part1 aoc22/day2input)
        (aoc22/day2-part2 aoc22/day2test)
        (aoc22/day2-part2 aoc22/day2input))
#+END_SRC

#+RESULTS:
: [15 12740 12 11980]

** day 3
#+NAME: 2022-day3-input
#+BEGIN_SRC emacs-lisp :session "day3"
  (defconst aoc22/day3test '( "vJrwpWtwJgWrhcsFMMfFFhFp"
    "jqHRNqRjqzjGDLGLrsFMfFZSrLrFZsSL" "PmmdzqPrVvPwwTWBwg"
    "wMqvLMZHhHMvwLHjbvcjnnSBnvTQFn" "ttgJtRGJQctTZtZT"
    "CrZsJsPPZsGzwwsLwLmpwMDw"))

  (defconst aoc22/day3input '( "lflZfgnSnlmmlgGfjGthQPtLNsQhvbHLLpSS"
    "zrCVDVFMJTCTcCJMwCThWbtbpbWpPbtbHPLQssLsHP"
    "rBFcrwFzFwwVDcDrzTzJfnRGjllBdGZnnZfhqmdn"
    "FjpnFRDmbRtnbJrFJmSTsGShWVhGqGVVsmqs"
    "ZwPvNPdzNZwfzBNLdNNNNcLvhnQhqMTVsTGSWSqGqTdVWhMT"
    "vgLZHfvLffNLPbggnrbFpJnCbC" "hzJzGjGfqmGtDQtDSvVV"
    "plpcMBNBcCTlTgCMbvtrsSVsVJDJlrwDQr" "McHBMMcTTHgJnWqnRqjzZnnRzR"
    "ppvsGZhDGprrSjSllwfZ" "TTFMMFJMgMHmHmdqdSvNqlSSSNJv"
    "mgBPHTRWFRVcpvsVttppbv" "ZZDssfMDMtqqppZLLJzmzSTwNJplTSgpgm"
    "BdCRRHFRbccWWBvBHCdcJVngNVSvTgVNzgNNVmnz" "QHFFrBdcGtqPmmQh"
    "qLvQFRgLSSNgqQvRrqLTQvLttwDBFWDwjwFttDdlBBwBwM"
    "nbsmZnbmHbZVCGPVmHWtwlStBDtwBMtwWHMj"
    "CnCbhGCPpPCSnZmrgRNRqNRrLNgrzh"
    "vgLWWHRNLnWwLggWzwLFFzMmBMRMhMhTbhsmmsbbmQTm"
    "rScpJJDDpjtSDPPPJDpjqPCHBBtlTdblmmlhBsMMmTsbmtsl"
    "GHZHCPprSSwgvWNVwVZv" "dMrCMJMqvtdFwcjczjQzThtm"
    "gGbLblLpZlHvllQhlQwcjT" "GHRWvPRbPHPRvNGbvdRBqdqBBfRqBqnrfF"
    "VsHcljlbhmHbHHlcjVcVShJSCdJCfMrMMQDfRNFCfMRGfNrQ"
    "tGtvLtpgBTGvDMMRdMMgdCNM" "pnGnGqGtvtzTLjWqmSSjHhWhWs"
    "NJTDntDNDVjNnjBfjjjcCZCZcVqCSCLqcSScCc"
    "zvhgRgQvvdllgQbHghlvHrRHSScBCRqqwCLGqSMCZCGGGqMZ"
    "pvvrHzdgvlgzQphQsDFmnsNTTtjfjJJmPB"
    "ScnSZSZZlmjmHjjWHHWZftJVJpppwtVVnLJtnptnwt"
    "CFFlQBbbPQqrBwJrJJrGJD"
    "PgTqRddFzgdRPFFbFgqQFgsSjfHWfSHmSMWcjZlmZmjTZM"
    "lzBRtctbnBRBRBBWnDnDWjlLVvwGMrvwrHHQHGmDvHQvHGrV"
    "FsTgFCTSgsCNspzhCGMfTHQVwVMfMmMmrH" "hSdSFgghhqpRbLqjntqnPz"
    "DCDnNGFFDQdQmVDNdFVNFccpJLHWSvPLrvvvPtGGhSttLv"
    "sBgTzzZqrBlfljslWBhvHSvPBhSBJSSL" "lRlTgMzlzrwRrnmbCMCFnNVMnc"
    "MJQJMJHBrsdrHwts" "dbbSVGgbjVqGTVfqddCTpmWWcprgNgWmcWwWswpN"
    "LPdGGdVGPCVdLBlBMlDRRRMD" "vdcwZLTdTFFRDHVgmpppMmqZ"
    "jGPzCnQPjlsDVqDpqDHbgP"
    "BjWJrlGQQzrCzBzlzBCGBznzwNRNcwLJdwTJFTHRSTvtLcNN"
    "ngrgqTjJJZnjFJpnqnnVTLzBbbHbLQdLHLHbrdHdHG"
    "lNcltCCtvftfWssPbMQdMBzhbbcBDLdh"
    "PRtWsQCmWsmSsCNCSvCSWlspwgqjqmqjTpnJZwnZVpFwgq"
    "PjWjGDCjmrmWPNmvWDWFmgCNfVJRLfJRfLDLJQlfHplpRbfR"
    "MtZMtcSbccZshTtQTVVTpzHlLRRQLV"
    "cZhbwMnwqsqnhnqtMBnvNFrnGPNPPmgPGCgW" "WBjWjWjqZwQJnJZCZZbf"
    "StHSDRPHHcTrTrJpLCCMbrqnJn"
    "RvTTvGqcqTFvSvSRDHvRjlhgWBWBdhjwjGgNjhlj"
    "FSbCqcFsbCPtrcrqhCScbshMjHDGGWBLHBnjGLPBHGGBGnHj"
    "flQdlsgQgGnQHBHjDn"
    "vllgRZdmvsvpgdwZgzJdwRmprqccSFcSShJbTSttqMCrCCch"
    "GwwgCtvHgwcHVVDqpWdfnqVv" "sllBsSNBjSrLfqhLgjfqhL"
    "ZbQbZQzgQQPSblBggNQRHGZHHCmwmHFGGcwtJm"
    "CmGVGBTVTmmTWTNLLCVgCSFvDQppQQDDnDQDJpMggfnQft"
    "RrtdqtldPbHzRbnjRfQZjJfMDnMj" "wcwhccqrdrrlFmLGCwCtSwtL"
    "pzZznZphZnpcNWSwGwVVPzrPrG" "lgFllLLltgbDsrBCwrjWGmwmtw"
    "MgJbDLlMQRJccchrhc" "wbbjzZhdGDwLzZSBWqqHmZgssCWqFtMZ"
    "VRJccfvPlTTlQlHQCWQhMMhCCHqQ"
    "RlVfVJcPTVTfvvvJfNJVlcBjGjwhSLdBNGGnjLLBwzGb"
    "bvpqHMVTTpZnqnWRQQQw" "tfhFFdSFggfhbldhhZcnRscRcQmnRs"
    "DPzgFJzFLfFbFSgPFgdPglMHpvBpHTCMGpjvMMpLvvNG"
    "JggGLQgQpLpSPRJgGPSnGlFTDBjjRFvRjtBFjWvFjqRj" "cmHhZcMHcWjrTBjrvm"
    "dbHwdNNHhwTNThZHdlwQJJwngpgnJGnSPw" "DbZjVfjVLhZDLpWPHpMZPmmGNp"
    "lFcJJGcFqnBFqwJCHHMmNHPsdCNp" "BlwccRQtBwBrwLGbGhGggzLgzR"
    "RBhZPjlWqgbNbgGLBr" "MzSmSzpFdHwpswzzHnzjnvLCbgtrtLGLbJLLJNtJtbwJ"
    "MsSHdmMdpFfmFjpfcPWRhRVZfWQThZ" "mqmssPCFhhsJccVg"
    "FTttfwdjjHznJgfngpnc"
    "dNFTjQNRtRNQldRNrRdHMRrlPZqCGlGBCqqZmmbPqDmDCmGW"
    "ZJVRRZZJRcvmPhCJrvhm" "PPWQDTfWbnnstlCGvjGrWMGMvr"
    "TbbwddndsnsfDpwFqZFVHBVPqc" "tFmpJmgJJgmFDWgRgFrrlGSltSQvZChMtCMM"
    "TLcZHsjLVNBwGQCCGlsCShvh" "nqNdwwccBwVLwjjDznZzppbgzFZfDF"
    "qsTqCCCszjlqTssBShlQSSZFgZZhgB"
    "LDPmVgDDJdLPrPgLgPZSFZQfhQGGBQJcSFJS"
    "mvmVbVvtggVtvgdLVvtmptCsNTtjRnpRTTjpsqCp"
    "BdNPLnmFvLFNgnmBmnFGnwSZZZWwqWgqjwWssTHWSS"
    "bJhMzhbVMbDCcVpZtjHMqTMwtttSjH"
    "hzclfCppVqQfbzQVbpzPQLNFBdrvdNGGBnmrmP"
    "nLVLzBDJCCHqdLncqVJgSsDlGsbssmvvvbvbff"
    "jMNHFWNTZZNwMPrPWrrPMMrrvSllbgsllfgbgvQsvGmglZbv"
    "RjPjrjRPtNrwHhBtncCJtJtL" "jbhhjhNjvqNbmjMjqhtCFdmPFdlzJzfFfJQJfR"
    "GBBZWrZWgpSsnSngrrSgHzFzFFdClzfFQFlRZftQPR"
    "TrGTrGWHpHWGHWVWsngprHpLbLLVvcqMcNbVNLhwVNbtNb"
    "sQDvDmDLQFDRsdchzhBczLhhPhVz"
    "MbGGMjjGZSjvfHvHSbfwBqcPnqqcPVhPNnqnzjcn"
    "ZwMMHrWvSHbfJfTrbJwSMMfMsQDtsFRptlpdCRpWmptQDRmC"
    "TwMHdcTznLqzTrHdzzzHTdgMRQWRhJhNjjvgQvQQWNjl"
    "tbfsVbDCVSSDtSPQJWPvRNhQtghN"
    "FVGBpGCVFCbfCbVbZCSHqmwqcqLcdHJGwHqqTd" "lTlGfjLGwHNMggscsDRwsC"
    "MrFtrzZZPZrtVQtnrrFdQhhDPDSphgDRhDcsCCgWpW" "ZJmJVzVVJFHfGbqJGMLv"
    "zsFZVjzlHPfTzGfLGt" "mdrrmdMMcBcmNqNbPqfRDLPWPlqTWD"
    "BNQhmmrBrQghgSmNBQQSmvwssjZZSJHljJFFHZJvZV"
    "rLZCsZdMJfdNCsfZMrLdFmssnwgTRQgBBwgRwcngTNVRVQjV"
    "StqDHlStDPgRTqcwjT"
    "GlDGDhbpHhvSHWlzbWlhpzhJdrFLrCLmvdmFZsmJJjJfdv"
    "pJHJMJsJjSMFdHhszFvMhlmmGNlSmmBGllWmVlwcTw"
    "ZqZRDrZCZDtPDPDrCngrnnPQGVmGHVBWGWtGmWVwVlmTlGNl"
    "ZQPgRqrrQPqLnrLMvLphHdvdjpJddb" "NwbBjljFbcjtTcccqW"
    "RHZrPHPpNgZTzTqc" "sfrPdmPdpsmPPPrfQPVGlwGVBwbGVnFlNQCG"
    "hQdNTlzhdTvrhdnTBqcWBLsBHgWQgBPg" "zwzRDbDfqZBLHDLB"
    "wFbFmjjRzfmjGGMGMfmJwwGCCnvNhpvSCNnrvJvCprnnSp"
    "zshNNJbwGFJfGJzzzNRnHGnCnRHcRPgTmPmn"
    "LMDVtZLStrrZClBrVDllLSBWRPTPPRRPmgWPVmPTPHTWgR"
    "SDSqLMlrtLlLtrBqBdlMZjvffCNzwvhjvvzhdfNhvf"
    "SLQmGBmhLSLQTBGBGwdwpJjwwQjwcVpJZJ"
    "sNrWrWPNbHghrbgnNNzbWbFWdZpMpzVpdMZMzMMVZcwwJdwd"
    "frrPNNWshWhhHDvDGDRSBSRvttqv" "FJqpgvhJJRjFjZTqDsMHrzwjsSsSszMrMm"
    "PPPQWGtnbbfBmPsFswwsMrcc" "QfBtbldtWQfbWbnfGlFqZppvpFZZLhFlpq"
    "ZqSMZHHCMpHTZTWmFTFZPZQJBgVGVJQvVVSDBvBtcBBG"
    "RNsndwsNjsbsgGCgjQBttcBg"
    "NRszRRNzLNNNwNfhCCrfdmTqFZllFFHFFpWhlTmWpq"
    "llbbzDmSspGRpHpzsldzRRsVtFBBFJMMVVFLTTTMVtLTDM"
    "cqgjqvNgvqCjQZqgGGnhMTnMJVLBLMtFhhVFWB"
    "PfGGvQrPCjvjZgGCCCZZZbSmmmHlRpprlHrHwssSRr" "mRmpFpWpfMMgLnmS"
    "CdCsqzdRzqStLjSqfMnL" "wQRHdTzCQbzCwsTrZBlFZGpVlpFGQD"
    "qnMTnTVSTPTHTHcMZMvVpmppmFmVzFLLFLlFpG"
    "gBjDsjRRwhDDghthwwWZwLmpmwWWLWLbGZ" "NhZtZtBgPTNJJNTS"
    "jLjjmpHvzvZrfzQjmfHHWrfbqblLsSlTsqsgqPJbPqVglb"
    "FBcCwDwtwgcgnCwcGchtJSsRqVRVJPPqDlbSDRPq"
    "MBhthFNtMGCwhcwnpQfWjNrQprpvzpgQ" "RfCnWfnhCbwHgWjzBgzB"
    "PsVqDsSTshsgszpsph" "DPDvTVtTShhSZhmqSvLlQJFnQJJZnbCnlCCZ"
    "pRRdJngltnwwvTNSWqWffqgBqD" "HQGcsdrjzMDDBfGMGG"
    "FLhsdbzCLLHjhntpVnRPRvZV" "gZNwQHHNRlGvhvhGRvRb"
    "dpSSBDrzdCfcSzfrzZrfCfMbthWWWPttDthvMFWvvvPj"
    "ZdpBpZCrssBJZfSJBzBdCTcnmQwmnVVlmqTQTTQlHLwNnN"
    "ssCpTttVVVpzZDVvRpCsRtDgWBWBBFBJvvJHMBghGghrMJ"
    "lwLmNNLwSblbmSQLfhJHZgHrHhhJJhHHmW"
    "QLSdbdPqndlNlLdSLNQncpRtRTcRVTPPZRCjVCcc"
    "wzzJclzcTThvWSSCqRlQSsNN" "rDpVjpVVDpsQSRDRfQmm"
    "GLbjrLpFbgLVLLgdbjVpchcFZhvBwJvtvtJcZwRB"
    "wPgZgLVMfWVTgmTZZZftJjtfjtJCcdpjdCqc"
    "zGGbQQnQGvBBhGQvvvBBSBvQdhdqqCpdddDmJlCcDjCtJdmJ"
    "HszzHBzQBSmGSwTWgswZPWTVgZ" "GDFvzCFdrszSdNJrFfjjfqZjRfsjpqmcwZ"
    "WbbVtVnBPWMgBLMBnQQnBQHcjfjpZRwqcwMfcNTZRqqNmT"
    "WQQnVVPHtggLghWWhHnPVQbvlJhSlrvJDlFGJDdDCzGNFF"
    "dVhTBjBHtTVqWRJZRqhJZQ" "brSDTbDfcCwDzfCSbwMQnlqCRJnMgWWnZngM"
    "DFwNSrwNwbDzbFTTFtjmBpVdGpHs" "dPQfdfTzDrFDmFDBgBFj"
    "RlJRclcswJRvnwPcpjbjbbCZjFjbBmsbFZ"
    "pqncGlcRJpHGpllGHhvPhRTHrQrttVVfrdQzfrTdftfV"
    "RCzTzRMTfCfRRDzRfhSmZZlCslBbZZBVtZBZsqBL"
    "nvvJPpdcFnPcWnFnVZvBqVlZMbZBNVlV" "FpWPMdjdPhSTmwfSjD"
    "NDJjNHLLNWjcLLWCLJLZjLDtRqqtgtMqgtqnRqnSRgggtZ"
    "BwrlfFwmQwhwfPBFhsBdFmbQggCgqQVtbRSqttqMngnp"
    "llPPwsPlGshBJGWJLcHvCzNv" "rBvTmwdTSbnrvVWsWVftGfJQGT"
    "gNRLLjlPRWnFVRFDFW" "lpCpPNZqZCdvdppnSnBr" "ShRdCrJgHClZJtZDGMMz"
    "LvqVVTTNbVPLQNFTnwwMtzFZGDDwmtnM"
    "VLbNvpPvTNVqVbbNpbVPGNLPrRWrcRCWdSrCjWSHcHSdWpCh"
    "tNmZnLSZPFLDnLTmhJMWczQdhmWhWH" "bGqbgrpsCsWhcChNQfJz"
    "vwlNbppsRGRRSSSDvjTjLZjZ" "zgMZhgfBtftSZQQmLHpSWH"
    "cdqcqnrJVGjjqPVjrPnfpJmsQHQQpsSsbsSDmm" "NNnrNqNlrNcPTlBvBvgggfMv"
    "llPrrLHBHCrRRBjrHCjBdrPmvJZzZgZbmgJlZmZhMhhmvh"
    "pNDstVtNtGFNSDFScQtfwzzFJwmJhgqzbMwqZJmh"
    "fpNsptGtQcTsSTccprddCWPrWdTRBMMCMd" "TTtDVqTsTcJFgbCqmbCq"
    "NWZQnllzfBFZPBGWQGzFPFRNNgHbHrrwbNrmCbggJRHR"
    "nBZjGFjMQBMPZnjfWjstpcctttvVtcTttMpL"
    "qphVCCwnHqhnRVznFwvLtBTLDTWZtwLWWS" "JmdlsdlsjfJfrtjTcvtctDZSSB"
    "rsmfPGbrPbPJfPmrsgMrdJdlFTHhFCqhNqVHnNHHCFznhphG"
    "JsWFMJJzrhSSdFdldmmdmdQc" "qLLgCVTgLbBvqsQPVdQGcRRmQmdc"
    "bBCBgCCDbLDqTvqqjpShHfzrzMfjtHHSHsfz"
    "nvFSBFlvvgQFFBzQnlQglmRRzqwsrrMJJMrsMqrfrwzf"
    "CjZNCNhLDNbPZZLZZhwVjpcfrqRhsdJqdsshRTTdqJrJ"
    "jNNDDppjpjDWNVLCVVDpGVVPBFtlSQFWvvQvSSQHSgwQnvtB"
    "WhrQWBRWwhzgmpnSpH" "LqMVsJVvFMJLJMsfNjsTJvCgFbSmzgpSHzmngHbGPCbm"
    "jvMjjtqVjTRnwZQwBWwt" "jfTWSGSTTWhgcngQfbtJfNzztBQBzz"
    "pVVwsdppRVPLVmPsVVHsjPLPzQdzBzQFzFBNNrJZZQBzbbFF"
    "VmsqHmjHmpvGDSWDvlclSl" "PNZfTFSFfTFGCHqqmbFm"
    "WjzRWrjVgnjzplrWWjJVppgGPGsgstmPCCtcmssQqGQt"
    "pzjzJVvnzJjWvpPlnVRVrvnlTDLNNhwfdNZLfMZLwLhTNvTw"
    "QFrQZMFVrVpVszzcNTdMRCCb" "SvljGmlvLfwLhLLLHlHdNzsRthhbbRccRCRNbC"
    "LfwlDmlvGBSjjlLLgpPpFJqgQndQgZBJ" "RBjPRHdjPfqQcfhcdv"
    "SngFcJZJlcnctSlhhsQvGsDGDsDnfs"
    "pSmFgSWNJFNtStrmNtpCCjPVcbjjHbcWTBHBHL"
    "vGjqCPqNPGFGNftLwmZwfQNTLp" "hrdBCSHcCJJcCBShJswmLQpLbbQZTLLJmmZp"
    "BdHHSzrBWdzchzzCcdzHddcDVWFnjPjllGggVlWljPFFFWPM"
    "hBtZZnpbhbPZJbnhDtPnpBtpfjfNNzrrCzjFzFzFTjfjjWzJ"
    "gHllMqRSmqcqMTdggMqHlcFzRrFQWNfvrRvzQrWjWvWf"
    "gwqlgHmmdsgwlwMHZtpsbBbtDBThbBht"
    "CsDLFFLFCvczsCsJrCrJJLRgbQQgmMmPbDDQbPnMgMmg"
    "VlwNBNVhjNVNWBwWjtbRMRZzPmQnfQMPnlZP"
    "VWWSSwGTwtwWWNVwwpqJJrcJGvzqCJCqJF" "wLwSSbzwCvddlvvlSj"
    "THnQnnHttcvpQzrZRllZ" "sTntBHTnVbPbgzsbgL"
    "FwHgrHvFQQwpHhNhTBLdpNNNLd"
    "fCGqCVtszfSslCSzSGsfCssjNTqLTdmjNLBLdnTTTMTjTg"
    "DccfslfgRSSVVzlcSVtzDRVHwQZFrwwvwFWbbbRRWwrFJb"
    "CwwWwwFNRpFFpZQHtsmfqbQDTQTTqb"
    "VcjzLjGjzGjGjVjLdzqmDqHrsmsqGRrHqGqH" "RjdVlgdnljlBnSgPCpNwwMWwMM"
    "tCCtqtbPGzsSQVzQTq" "mzMmHMpRsRQTsFFV"
    "DpzDwgdMzMLppNmNpDpfgrbhLcGtPrbtrbrbhnbBcC"
    "BvsQBBBLvDQGjDvSQLTvrHprHlRpVlVllgRbRbHPqq"
    "MMMMCpfJFZZMmCzwpVPCWRtHgqWgqClgtt" "FwzmfzhFFdFcpvSDSBDThs"
    "fQrGQbFFFrHHtlHPclzzPLvc"
    "mTnwpNCCqMqjmCThpTpSvvtBczstlLznvsztsPPP"
    "mCpTNhmmpCqCmjmpTjmLCpSJQZVfFVrDVfffFFgfgJQFdbgG"
    "GmWjRBSfttcGfRcSclVVJqsTMllsgJVMVZwV" "pPFNpfNCdNzCVMTTNqVssqJN"
    "dzPfHCLLhdjjLGRnmnmr"
    "GPhPfGWgggfslffPsVPGsqJMzLQJtBprwQJJGQwLpQrw"
    "ZNdmvbDDbNvHbmZCcJQwMmzMwWWQrrwttp"
    "bvdDNdnvNbnHDdnDHHRSbnqhqhWfjWFVTVhRVjfjFTfP"
    "hTThfWNCDRfsVCDhpgzgbpPZZwbnZQns"
    "GSjGGcCBGmdjdSlGBcmZwzJzpPpJzwPwQbzgPd"
    "BGmcrcStcMMMmrSLmSMCvFVRFDhfFhhNDWWTqFqTvf" "ZmjDTTbmqQCCQQSwvhsL"
    "FGVJPmPmtRVRsCvvRLwwhC" "JgdHJgmfbjzTpTMf" "fTbsVCsssgLNrfNrgm"
    "zQvzZlRvddvpNLpZrMNNLZ"
    "HLvWFHHlFQvzHnnlnvQqhzWvstBwbGVtstjGqjjwqGGCcwGq"
    "JNpNdzzdJhNnfNGBZLqZqlhvSZSG" "QswtcmmwwmTmwwcwZSLlZLDSvSvlBZQD"
    "FsVFBbFgFsPwtVBTwgTPcsmpzdNngfzfpCzJdzCJzNCndn"
    "qcvrLBppgpWWWgLcpzPfhNDqdzqwDDzwhV"
    "MZFjFnHFMHbMntMtnwStfddPhDffDfzDfS"
    "QmnjMZnlHjmnMGFnFlMmjlZWzLgsGgcrspBBLCBcgvgBRC" "sdfWHjZfrZrSPMCQ"
    "zqtWRDDDRMbrQJPQ" "zwhwzmqwzmFpWzvFqBmFvjNHlHfgVLBgdfVfNVjLsl"
    "lRlBTlvlZfhtbGBWtFBz"
    "cqCNjjqjrNrcNjwDqNPCVrSQStSWshFhtQhbQzGzmFCG"
    "HjPPzMcdNqjcNHMqPjdpgpZflfdgnTfdlvlJ"
    "VpwQJVRtHplnnwtppHhqWBCfVdNNPqPBPWsBDq"
    "jzLZCrvvrZjZvqNffvDNDcWDWd"
    "LTrZZLFZbgTzgjZZjFClJhTHTplQpmnQlpmpQR"
    "JGJnSWLGSpWHVHwGGJHpZdwPdTTPMdTMDdlzccPMPv"
    "gqrrmtbrbgggqgBtqmRSrFgNCzvMDvlMPDdddvzBcPMMMDBd"
    "gjrmRgmtRggFtqjbhgbjrtnJJHWLHQWZZLhZsLLGHhSL" "BtTDNggLRPdWQHqggg"
    "wrVpVVlCJVGMMJVdHWSdPSqqRwSQSP" "vCVrpvvGjlphBRmZBhmBhBND"
    "lqDcZGcSSqSqbDnccSLJgHgLRfnvvJRLmvWJ"
    "FVCFPChQzVhmsFBgddRgJBfdNfJdfv" "FzCpmTQzjQCThppTSttqDccMTDGcDG"
    "QCSGBGCrCsMBTCQwMGSfvvLNNnnVLDlNVNDdVdlr"
    "ZHtPffjWbqgtmnNdvljFnFhdVv" "JRWbmgmRJtmJMGGwSBBRRRfQ"
    "LqNrCfCQQhtgnPnc" "JWBrWrVlbWgbbtcb" "VwvTBprdrVJVNLNMNNqfqpjN"
    "bjVqdHrdqVHPsPNbqHbqNdjFGRwRGlttRtMtRtFFGMLHJw"
    "cfSpZnBZWQBZJlGRJJcwGMGL" "WWBhTMgDTZghVjgjssbrbddd" ))

#+END_SRC

#+RESULTS: 2022-day3-input
: aoc22/day3input

#+CALL: 2022-day3-input
#+NAME: 2022-day3-solution
#+BEGIN_SRC emacs-lisp :session "day3"
;;; Code:

(defun aoc22/day3-part1 (input)
  "Takes INPUT list of strings and computes the priority.
  Each string is split in the middle and the common letter among
  the strings is computed.  This common letter gives a priority
  value, and these priorities need to be added for the final value
  to be computed.  Priority values are as follows:
  a through z have priorities 1 through 26
  A through Z have priorities 27 through 52.

  The final result is the sum of all priorities."

  (let ((priority 0))
    (dolist (rucksack input)
      (let* ((room (/ (length rucksack) 2))
             (left-compartment (aoc22/compartment rucksack 0 room))
             (right-compartment (aoc22/compartment rucksack room nil))
             (priority-char (car (cl-intersection left-compartment right-compartment))))
        (cl-incf priority (aoc22/compute-priority priority-char))))
    priority))

(defun aoc22/day3-part2 (rucksacks)
  "Take the RUCKSACKS and find the sticker priorities.
  Now I have to find the common character among three lines, which
  is going to be the sticker that the elves must have, and from
  this common character I will have to compute the priority."
  (let ((priority 0))
    (dolist (triad (number-sequence 0 (1- (length rucksacks)) 3))
      (let* ((first-compartment (aoc22/compartment (nth triad rucksacks) nil nil))
             (second-compartment (aoc22/compartment (nth (+ triad 1) rucksacks) nil nil))
             (third-compartment (aoc22/compartment (nth (+ triad 2) rucksacks) nil nil))
             (priority-char (car (cl-intersection first-compartment (cl-intersection
                                                                     second-compartment
                                                                     third-compartment)))))
        (cl-incf priority (aoc22/compute-priority priority-char))))
    priority))

;;; Helper functions

(defun aoc22/compute-priority (character)
  "Take a CHARACTER and return the priority of the character.
  This is defined as follows:
  a through z have priorities 1 through 26
  A through Z have priorities 27 through 52"
  (if (> character 96)
      (- character 96)
    (- character 38)))

(defun aoc22/compartment (rucksack start end)
  "Get RUCKSACK, START and END and return a compartment.
  This is basically a helper function to get the code outside the
  priority functions."
  (mapcar #'string-to-char
          (split-string (substring rucksack start end) "" t)))

;;; Results vector

(vector (aoc22/day3-part1 aoc22/day3test)
        (aoc22/day3-part1 aoc22/day3input)
        (aoc22/day3-part2 aoc22/day3test)
        (aoc22/day3-part2 aoc22/day3input))
#+END_SRC

#+RESULTS:
: [157 8401 70 2641]

#+RESULTS: 2022-day3-solution
: [157 8401 70 2641]

** day 4
#+NAME: 2022-day4-input
#+BEGIN_SRC emacs-lisp :session "day4"
(defconst aoc22/day4test '(((2 4).(6 8))
                           ((2 3).(4 5))
                           ((5 7).(7 9))
                           ((2 8).(3 7))
                           ((6 6).(4 6))
                           ((2 6).(4 8))))

(defconst aoc22/day4input '(((30 31).(2 31))
                            ((6 92).(4 5))
                            ((35 39).(42 44))
                            ((35 95).(35 95))
                            ((12 98).(99 99))
                            ((10 15).(16 94))
                            ((37 85).(84 84))
                            ((2 23).(31 56))
                            ((52 68).(51 69))
                            ((47 62).(25 52))
                            ((9 62).(61 61))
                            ((78 99).(77 99))
                            ((92 94).(11 93))
                            ((77 83).(62 76))
                            ((3 7).(29 59))
                            ((12 96).(96 97))
                            ((48 48).(12 47))
                            ((72 86).(71 86))
                            ((6 90).(90 95))
                            ((5 92).(2 4))
                            ((11 63).(1 64))
                            ((72 72).(72 82))
                            ((65 68).(68 69))
                            ((3 99).(5 99))
                            ((5 80).(5 5))
                            ((40 93).(41 93))
                            ((27 31).(25 58))
                            ((6 93).(93 93))
                            ((25 75).(75 76))
                            ((31 78).(79 79))
                            ((16 60).(33 86))
                            ((38 65).(39 97))
                            ((46 52).(45 88))
                            ((13 64).(12 80))
                            ((53 53).(35 52))
                            ((32 38).(12 30))
                            ((43 49).(42 96))
                            ((4 23).(24 77))
                            ((32 63).(27 64))
                            ((46 72).(23 73))
                            ((78 89).(56 88))
                            ((42 78).(79 79))
                            ((2 87).(2 88))
                            ((51 57).(57 58))
                            ((56 63).(55 63))
                            ((2 12).(21 62))
                            ((5 7).(6 41))
                            ((57 86).(87 92))
                            ((17 18).(17 42))
                            ((11 84).(7 10))
                            ((13 75).(4 75))
                            ((15 76).(14 14))
                            ((96 96).(2 97))
                            ((68 94).(43 95))
                            ((57 66).(67 85))
                            ((5 52).(20 88))
                            ((25 62).(25 62))
                            ((3 82).(81 83))
                            ((88 89).(85 88))
                            ((31 49).(30 68))
                            ((58 60).(59 61))
                            ((16 33).(15 16))
                            ((13 97).(13 66))
                            ((4 87).(10 86))
                            ((6 6).(7 99))
                            ((33 35).(34 98))
                            ((48 88).(82 89))
                            ((31 73).(30 74))
                            ((1 95).(2 95))
                            ((11 87).(10 86))
                            ((60 61).(21 60))
                            ((51 91).(51 52))
                            ((15 37).(16 38))
                            ((5 10).(10 32))
                            ((23 25).(24 34))
                            ((21 40).(21 40))
                            ((12 52).(13 31))
                            ((10 10).(10 94))
                            ((41 82).(4 82))
                            ((5 48).(6 34))
                            ((73 81).(42 72))
                            ((62 77).(76 82))
                            ((41 82).(56 83))
                            ((19 52).(18 39))
                            ((19 92).(54 93))
                            ((2 39).(2 40))
                            ((95 96).(3 95))
                            ((7 70).(6 92))
                            ((7 89).(6 58))
                            ((67 88).(68 80))
                            ((14 74).(73 86))
                            ((41 41).(33 40))
                            ((2 91).(8 90))
                            ((69 81).(11 80))
                            ((8 90).(9 98))
                            ((62 87).(86 86))
                            ((7 70).(39 69))
                            ((4 9).(3 12))
                            ((4 96).(11 95))
                            ((1 21).(3 22))
                            ((18 24).(92 99))
                            ((34 87).(7 90))
                            ((96 99).(82 88))
                            ((6 50).(6 34))
                            ((13 53).(12 54))
                            ((2 98).(3 95))
                            ((8 11).(17 91))
                            ((26 92).(3 56))
                            ((36 61).(46 84))
                            ((86 86).(22 85))
                            ((20 76).(76 76))
                            ((21 80).(21 30))
                            ((34 78).(55 90))
                            ((12 96).(11 95))
                            ((43 43).(15 44))
                            ((54 88).(53 89))
                            ((37 37).(50 66))
                            ((23 95).(7 11))
                            ((7 58).(21 59))
                            ((3 5).(4 68))
                            ((5 75).(8 76))
                            ((42 68).(42 67))
                            ((36 36).(36 47))
                            ((9 69).(9 92))
                            ((30 56).(36 80))
                            ((12 85).(13 84))
                            ((11 64).(65 87))
                            ((41 60).(60 61))
                            ((2 30).(31 41))
                            ((23 60).(9 35))
                            ((87 89).(15 88))
                            ((4 97).(96 98))
                            ((9 92).(9 91))
                            ((40 66).(66 66))
                            ((39 95).(69 96))
                            ((48 87).(23 47))
                            ((5 96).(6 95))
                            ((18 66).(19 65))
                            ((5 38).(39 61))
                            ((12 92).(93 93))
                            ((9 97).(10 97))
                            ((16 51).(50 67))
                            ((3 14).(14 28))
                            ((7 7).(8 88))
                            ((6 45).(5 36))
                            ((58 58).(40 58))
                            ((8 56).(7 56))
                            ((5 15).(6 14))
                            ((97 97).(7 96))
                            ((26 70).(27 94))
                            ((20 21).(20 91))
                            ((3 16).(3 13))
                            ((9 10).(9 92))
                            ((16 81).(67 94))
                            ((72 88).(6 73))
                            ((4 88).(3 68))
                            ((25 53).(24 54))
                            ((63 75).(63 74))
                            ((31 31).(31 56))
                            ((1 84).(1 83))
                            ((41 89).(40 67))
                            ((4 53).(5 54))
                            ((13 83).(13 14))
                            ((11 87).(11 86))
                            ((4 63).(4 63))
                            ((9 96).(8 97))
                            ((2 74).(1 88))
                            ((40 83).(39 83))
                            ((46 71).(45 75))
                            ((4 74).(74 75))
                            ((99 99).(72 98))
                            ((33 51).(52 82))
                            ((22 69).(22 23))
                            ((35 36).(36 91))
                            ((8 97).(97 98))
                            ((18 20).(19 94))
                            ((6 16).(7 17))
                            ((35 36).(36 97))
                            ((4 78).(79 79))
                            ((14 69).(4 14))
                            ((50 64).(19 51))
                            ((10 31).(15 17))
                            ((52 74).(74 74))
                            ((42 91).(90 91))
                            ((35 69).(10 70))
                            ((1 3).(4 4))
                            ((37 66).(67 67))
                            ((6 92).(73 74))
                            ((21 96).(21 97))
                            ((6 37).(6 68))
                            ((25 78).(79 92))
                            ((78 88).(65 75))
                            ((14 99).(8 8))
                            ((39 66).(54 67))
                            ((33 80).(79 91))
                            ((15 83).(84 84))
                            ((51 51).(10 50))
                            ((72 80).(72 81))
                            ((4 92).(2 24))
                            ((33 93).(92 94))
                            ((4 10).(4 68))
                            ((8 94).(7 96))
                            ((1 39).(38 69))
                            ((6 36).(36 37))
                            ((86 86).(31 85))
                            ((77 94).(76 96))
                            ((8 75).(17 76))
                            ((7 93).(7 45))
                            ((8 61).(40 70))
                            ((17 29).(32 94))
                            ((26 26).(12 25))
                            ((14 94).(10 12))
                            ((29 42).(32 39))
                            ((2 91).(2 3))
                            ((12 85).(28 86))
                            ((57 70).(71 90))
                            ((9 16).(17 87))
                            ((17 55).(18 55))
                            ((18 98).(19 19))
                            ((88 88).(22 87))
                            ((5 93).(4 92))
                            ((75 76).(76 84))
                            ((5 6).(6 41))
                            ((42 94).(36 41))
                            ((52 66).(1 62))
                            ((5 82).(4 4))
                            ((1 87).(3 88))
                            ((47 58).(56 61))
                            ((7 57).(7 97))
                            ((39 93).(33 93))
                            ((31 48).(20 32))
                            ((18 81).(19 82))
                            ((16 77).(17 78))
                            ((2 2).(4 43))
                            ((22 23).(23 93))
                            ((10 11).(15 68))
                            ((89 95).(15 88))
                            ((19 69).(18 18))
                            ((85 98).(34 84))
                            ((47 73).(29 52))
                            ((56 56).(23 55))
                            ((2 97).(2 94))
                            ((34 64).(17 63))
                            ((46 46).(47 75))
                            ((15 90).(91 91))
                            ((63 63).(35 62))
                            ((46 56).(52 89))
                            ((82 90).(82 90))
                            ((17 23).(5 7))
                            ((7 79).(8 79))
                            ((40 76).(39 71))
                            ((81 82).(11 99))
                            ((31 41).(37 44))
                            ((97 98).(1 98))
                            ((13 92).(11 16))
                            ((63 63).(3 62))
                            ((10 23).(27 46))
                            ((18 99).(19 80))
                            ((43 65).(55 56))
                            ((14 14).(14 20))
                            ((14 75).(15 74))
                            ((24 75).(12 45))
                            ((32 32).(33 83))
                            ((4 92).(2 3))
                            ((35 50).(34 72))
                            ((11 90).(91 91))
                            ((62 84).(78 97))
                            ((64 64).(24 65))
                            ((13 93).(12 94))
                            ((70 89).(58 88))
                            ((35 44).(36 43))
                            ((57 90).(91 91))
                            ((19 20).(20 96))
                            ((33 96).(26 87))
                            ((9 61).(10 62))
                            ((2 81).(1 3))
                            ((69 98).(69 98))
                            ((60 66).(64 97))
                            ((8 8).(4 7))
                            ((33 76).(32 77))
                            ((35 96).(34 86))
                            ((87 92).(66 86))
                            ((5 39).(8 67))
                            ((27 78).(79 80))
                            ((5 98).(1 1))
                            ((6 79).(5 95))
                            ((65 87).(88 88))
                            ((50 98).(49 49))
                            ((55 58).(54 60))
                            ((13 97).(12 96))
                            ((74 74).(1 73))
                            ((12 61).(64 74))
                            ((10 98).(10 11))
                            ((68 70).(17 69))
                            ((41 58).(13 65))
                            ((7 77).(6 77))
                            ((50 95).(41 49))
                            ((4 68).(2 4))
                            ((14 54).(14 40))
                            ((59 93).(60 82))
                            ((21 95).(26 95))
                            ((41 81).(41 62))
                            ((41 89).(40 88))
                            ((21 39).(22 40))
                            ((30 94).(29 88))
                            ((1 93).(1 93))
                            ((5 78).(4 79))
                            ((15 86).(85 87))
                            ((89 90).(17 89))
                            ((47 85).(48 85))
                            ((84 84).(83 85))
                            ((6 98).(6 6))
                            ((3 92).(3 93))
                            ((9 9).(8 60))
                            ((36 90).(6 35))
                            ((57 61).(56 58))
                            ((4 92).(3 93))
                            ((7 69).(8 69))
                            ((78 78).(4 79))
                            ((52 93).(53 93))
                            ((30 90).(30 91))
                            ((58 78).(77 79))
                            ((21 41).(42 53))
                            ((16 37).(6 38))
                            ((2 77).(3 77))
                            ((6 55).(17 69))
                            ((36 73).(37 71))
                            ((93 94).(26 93))
                            ((22 79).(22 79))
                            ((11 92).(91 93))
                            ((1 62).(3 65))
                            ((9 65).(8 64))
                            ((11 32).(7 33))
                            ((5 94).(2 5))
                            ((80 82).(80 81))
                            ((46 77).(45 76))
                            ((2 98).(1 99))
                            ((2 4).(6 68))
                            ((56 83).(55 82))
                            ((12 14).(13 98))
                            ((78 90).(5 80))
                            ((3 69).(2 2))
                            ((83 83).(76 82))
                            ((3 99).(1 1))
                            ((28 72).(28 50))
                            ((57 67).(32 54))
                            ((4 99).(7 98))
                            ((18 18).(19 48))
                            ((79 85).(84 84))
                            ((83 89).(81 87))
                            ((31 89).(30 87))
                            ((49 72).(49 71))
                            ((28 29).(28 51))
                            ((48 97).(1 47))
                            ((13 45).(8 12))
                            ((24 75).(25 75))
                            ((63 89).(76 86))
                            ((16 23).(15 16))
                            ((25 49).(26 48))
                            ((17 94).(16 88))
                            ((6 95).(7 96))
                            ((87 90).(86 89))
                            ((11 93).(3 95))
                            ((6 66).(5 65))
                            ((97 99).(39 98))
                            ((23 66).(24 65))
                            ((54 56).(55 70))
                            ((92 97).(26 90))
                            ((7 86).(7 87))
                            ((60 78).(77 79))
                            ((90 95).(71 94))
                            ((32 87).(33 87))
                            ((13 13).(14 72))
                            ((12 86).(6 87))
                            ((24 44).(45 75))
                            ((5 96).(5 97))
                            ((2 83).(7 79))
                            ((95 97).(1 90))
                            ((72 80).(73 75))
                            ((11 85).(12 86))
                            ((7 50).(8 8))
                            ((35 99).(55 79))
                            ((56 98).(57 99))
                            ((6 87).(7 87))
                            ((28 72).(27 71))
                            ((20 77).(78 83))
                            ((8 67).(68 83))
                            ((10 68).(9 9))
                            ((35 63).(35 64))
                            ((90 90).(90 90))
                            ((5 97).(1 99))
                            ((10 93).(9 19))
                            ((6 90).(4 77))
                            ((46 75).(80 97))
                            ((9 77).(10 82))
                            ((73 88).(74 81))
                            ((43 65).(43 44))
                            ((66 82).(66 81))
                            ((62 63).(63 77))
                            ((35 76).(11 77))
                            ((22 93).(89 90))
                            ((3 96).(2 3))
                            ((11 29).(2 33))
                            ((75 82).(62 81))
                            ((46 47).(46 53))
                            ((9 99).(8 98))
                            ((32 93).(33 87))
                            ((47 51).(52 60))
                            ((18 83).(84 84))
                            ((31 70).(31 69))
                            ((26 93).(19 92))
                            ((93 93).(4 92))
                            ((2 14).(4 35))
                            ((1 98).(36 99))
                            ((7 83).(82 96))
                            ((95 95).(32 95))
                            ((34 39).(9 38))
                            ((2 63).(62 93))
                            ((24 98).(99 99))
                            ((26 50).(89 93))
                            ((82 97).(35 81))
                            ((22 33).(16 33))
                            ((1 5).(11 66))
                            ((9 63).(9 63))
                            ((36 36).(36 77))
                            ((5 98).(6 99))
                            ((22 93).(50 92))
                            ((89 92).(89 93))
                            ((48 90).(91 91))
                            ((6 88).(7 89))
                            ((27 38).(38 84))
                            ((9 87).(11 40))
                            ((24 83).(23 82))
                            ((1 69).(1 68))
                            ((16 67).(62 65))
                            ((13 15).(1 85))
                            ((41 65).(40 42))
                            ((19 77).(20 77))
                            ((44 93).(45 93))
                            ((27 94).(94 97))
                            ((12 97).(12 96))
                            ((9 38).(8 48))
                            ((22 49).(6 49))
                            ((12 18).(13 52))
                            ((14 52).(13 14))
                            ((12 51).(13 52))
                            ((10 36).(37 37))
                            ((14 72).(13 15))
                            ((2 99).(72 81))
                            ((21 34).(22 22))
                            ((86 86).(60 85))
                            ((20 36).(20 20))
                            ((10 96).(11 96))
                            ((14 24).(15 23))
                            ((8 96).(8 95))
                            ((16 22).(22 23))
                            ((32 90).(33 97))
                            ((7 31).(32 67))
                            ((35 68).(22 77))
                            ((3 69).(5 69))
                            ((13 62).(12 61))
                            ((26 32).(27 32))
                            ((68 77).(67 76))
                            ((5 99).(6 98))
                            ((2 56).(8 65))
                            ((96 99).(11 67))
                            ((3 25).(15 24))
                            ((25 91).(84 90))
                            ((9 39).(10 38))
                            ((24 94).(23 24))
                            ((78 80).(29 79))
                            ((4 47).(5 85))
                            ((39 81).(81 82))
                            ((33 33).(13 32))
                            ((31 69).(32 83))
                            ((19 95).(17 21))
                            ((75 75).(74 74))
                            ((14 89).(15 98))
                            ((4 99).(6 98))
                            ((60 90).(59 66))
                            ((50 72).(46 73))
                            ((26 84).(25 49))
                            ((9 77).(8 77))
                            ((48 99).(49 94))
                            ((91 95).(10 90))
                            ((7 63).(24 64))
                            ((79 85).(11 80))
                            ((98 99).(20 82))
                            ((2 98).(1 97))
                            ((56 68).(54 67))
                            ((30 30).(31 87))
                            ((89 96).(58 88))
                            ((6 56).(3 5))
                            ((12 49).(15 62))
                            ((26 33).(26 66))
                            ((18 18).(19 98))
                            ((13 27).(14 26))
                            ((12 15).(3 19))
                            ((5 98).(46 98))
                            ((4 89).(3 90))
                            ((5 15).(5 19))
                            ((85 88).(45 87))
                            ((94 97).(97 98))
                            ((24 34).(34 77))
                            ((55 56).(2 55))
                            ((6 86).(7 87))
                            ((42 50).(43 50))
                            ((16 57).(17 58))
                            ((3 22).(2 3))
                            ((56 57).(56 96))
                            ((5 91).(82 92))
                            ((30 53).(53 54))
                            ((12 25).(13 47))
                            ((72 90).(90 91))
                            ((15 49).(49 89))
                            ((5 81).(6 37))
                            ((57 58).(58 82))
                            ((11 65).(2 10))
                            ((41 97).(42 96))
                            ((55 71).(54 70))
                            ((4 81).(1 98))
                            ((2 65).(1 49))
                            ((7 45).(6 45))
                            ((98 98).(8 98))
                            ((8 93).(41 92))
                            ((1 90).(2 98))
                            ((14 93).(43 92))
                            ((66 97).(98 98))
                            ((36 87).(87 88))
                            ((2 62).(4 61))
                            ((22 76).(23 76))
                            ((49 54).(50 55))
                            ((50 53).(52 94))
                            ((45 95).(75 96))
                            ((22 77).(78 78))
                            ((71 73).(72 86))
                            ((9 83).(10 82))
                            ((1 56).(53 54))
                            ((71 71).(63 70))
                            ((7 73).(7 8))
                            ((6 9).(6 66))
                            ((10 98).(97 98))
                            ((4 50).(50 50))
                            ((7 95).(7 91))
                            ((6 7).(7 96))
                            ((73 73).(1 73))
                            ((43 68).(44 77))
                            ((26 30).(25 31))
                            ((92 92).(9 92))
                            ((88 89).(1 88))
                            ((12 97).(96 98))
                            ((91 91).(59 90))
                            ((4 9).(3 16))
                            ((16 97).(96 96))
                            ((50 89).(49 90))
                            ((94 96).(84 95))
                            ((55 71).(70 72))
                            ((16 90).(5 16))
                            ((1 96).(3 95))
                            ((5 35).(7 34))
                            ((16 72).(16 54))
                            ((3 99).(1 2))
                            ((8 87).(10 88))
                            ((10 98).(10 98))
                            ((8 67).(4 69))
                            ((23 79).(72 72))
                            ((17 74).(17 75))
                            ((57 77).(77 78))
                            ((74 84).(85 98))
                            ((22 64).(30 65))
                            ((3 73).(1 72))
                            ((1 78).(31 91))
                            ((4 93).(4 94))
                            ((51 88).(51 79))
                            ((5 19).(19 99))
                            ((68 68).(31 67))
                            ((2 98).(3 3))
                            ((48 63).(47 64))
                            ((67 71).(72 73))
                            ((9 42).(9 54))
                            ((2 50).(2 39))
                            ((53 53).(3 54))
                            ((36 37).(36 69))
                            ((63 74).(64 73))
                            ((14 65).(13 65))
                            ((41 94).(98 98))
                            ((1 60).(6 99))
                            ((95 98).(80 94))
                            ((71 74).(32 78))
                            ((31 31).(31 31))
                            ((6 7).(6 33))
                            ((5 95).(96 98))
                            ((5 93).(6 94))
                            ((52 88).(51 89))
                            ((55 76).(55 77))
                            ((4 98).(3 96))
                            ((59 89).(58 94))
                            ((10 88).(9 86))
                            ((13 97).(13 96))
                            ((18 97).(10 16))
                            ((7 98).(4 97))
                            ((84 85).(14 84))
                            ((26 88).(76 87))
                            ((52 72).(71 81))
                            ((38 52).(39 52))
                            ((22 88).(1 89))
                            ((7 97).(2 7))
                            ((4 25).(3 25))
                            ((43 73).(42 74))
                            ((26 26).(25 47))
                            ((34 84).(40 84))
                            ((8 69).(7 68))
                            ((2 52).(1 85))
                            ((52 60).(52 61))
                            ((38 71).(37 70))
                            ((28 86).(27 85))
                            ((99 99).(7 98))
                            ((45 67).(8 81))
                            ((7 93).(7 58))
                            ((37 56).(28 56))
                            ((29 99).(66 98))
                            ((78 98).(7 97))
                            ((4 72).(3 77))
                            ((1 3).(2 73))
                            ((1 14).(2 35))
                            ((12 13).(12 95))
                            ((40 84).(84 84))
                            ((12 56).(28 47))
                            ((3 96).(1 39))
                            ((58 74).(74 74))
                            ((24 32).(24 32))
                            ((11 91).(5 10))
                            ((41 69).(36 97))
                            ((9 92).(8 59))
                            ((40 51).(39 52))
                            ((97 99).(16 96))
                            ((34 96).(33 69))
                            ((68 86).(30 87))
                            ((45 96).(44 98))
                            ((12 89).(6 12))
                            ((5 81).(32 89))
                            ((5 8).(6 9))
                            ((4 42).(1 2))
                            ((32 42).(79 96))
                            ((5 96).(4 95))
                            ((54 62).(12 62))
                            ((30 86).(86 86))
                            ((50 58).(58 58))
                            ((41 61).(40 62))
                            ((1 99).(2 99))
                            ((21 52).(20 20))
                            ((17 69).(1 17))
                            ((3 97).(2 96))
                            ((35 37).(36 57))
                            ((8 32).(9 11))
                            ((3 4).(4 99))
                            ((92 96).(72 92))
                            ((2 3).(2 90))
                            ((34 40).(41 69))
                            ((81 98).(65 80))
                            ((12 57).(58 58))
                            ((39 40).(14 39))
                            ((47 77).(78 93))
                            ((5 5).(6 91))
                            ((24 87).(86 93))
                            ((31 80).(30 80))
                            ((32 82).(33 55))
                            ((61 75).(62 74))
                            ((16 98).(16 99))
                            ((19 21).(22 86))
                            ((54 54).(16 53))
                            ((40 74).(21 28))
                            ((20 28).(28 76))
                            ((94 96).(47 71))
                            ((25 74).(74 75))
                            ((39 81).(3 67))
                            ((5 97).(2 52))
                            ((21 63).(62 62))
                            ((7 53).(6 84))
                            ((60 88).(59 60))
                            ((23 61).(24 61))
                            ((76 93).(77 94))
                            ((17 30).(30 86))
                            ((10 23).(9 77))
                            ((6 90).(5 96))
                            ((38 69).(37 39))
                            ((1 3).(4 94))
                            ((73 74).(3 74))
                            ((70 83).(41 84))
                            ((72 79).(78 83))
                            ((56 76).(15 67))
                            ((92 92).(6 93))
                            ((2 90).(89 89))
                            ((19 19).(20 90))
                            ((18 79).(17 80))
                            ((11 11).(2 16))
                            ((95 95).(57 95))
                            ((51 93).(52 86))
                            ((47 52).(53 96))
                            ((1 5).(13 43))
                            ((44 63).(62 64))
                            ((43 97).(42 42))
                            ((46 54).(45 53))
                            ((7 61).(8 21))
                            ((18 79).(41 80))
                            ((54 56).(28 55))
                            ((7 54).(11 54))
                            ((12 61).(62 62))
                            ((80 81).(80 94))
                            ((38 39).(38 76))
                            ((8 94).(26 83))
                            ((3 66).(2 4))
                            ((6 27).(7 26))
                            ((2 96).(71 86))
                            ((67 99).(66 98))
                            ((28 73).(27 90))
                            ((2 93).(1 93))
                            ((80 95).(72 94))
                            ((88 90).(24 89))
                            ((93 93).(22 93))
                            ((36 86).(51 92))
                            ((25 63).(24 63))
                            ((90 91).(12 84))
                            ((9 46).(10 46))
                            ((31 31).(17 31))
                            ((51 52).(49 51))
                            ((14 18).(2 12))
                            ((72 73).(64 73))
                            ((6 82).(10 81))
                            ((58 84).(15 15))
                            ((51 78).(52 68))
                            ((54 56).(60 68))
                            ((78 79).(6 78))
                            ((96 96).(95 96))
                            ((28 81).(43 82))
                            ((5 95).(5 5))
                            ((2 17).(1 99))
                            ((10 94).(9 61))
                            ((85 87).(3 91))
                            ((2 73).(14 72))
                            ((95 95).(21 94))
                            ((17 57).(37 81))
                            ((95 95).(4 95))
                            ((28 84).(12 93))
                            ((4 98).(1 1))
                            ((96 97).(7 97))
                            ((60 99).(61 99))
                            ((97 97).(7 98))
                            ((73 74).(5 74))
                            ((59 94).(60 60))
                            ((83 85).(84 91))
                            ((2 5).(5 40))
                            ((29 79).(28 78))
                            ((37 67).(26 54))
                            ((28 39).(10 41))
                            ((84 84).(85 85))
                            ((19 69).(12 68))
                            ((29 31).(30 32))
                            ((58 77).(57 59))
                            ((17 25).(24 26))
                            ((37 80).(36 81))
                            ((16 84).(16 97))
                            ((3 97).(1 96))
                            ((7 63).(7 64))
                            ((7 54).(6 54))
                            ((14 47).(13 46))
                            ((13 64).(55 67))
                            ((19 36).(35 35))
                            ((67 80).(67 79))
                            ((8 66).(5 35))
                            ((56 93).(44 55))
                            ((6 74).(15 90))
                            ((64 85).(21 71))
                            ((22 22).(23 27))
                            ((16 87).(87 88))
                            ((80 82).(81 84))
                            ((3 89).(2 89))
                            ((43 95).(16 96))
                            ((67 69).(3 88))
                            ((8 82).(4 95))
                            ((28 93).(28 93))
                            ((23 62).(22 24))
                            ((73 98).(73 73))
                            ((84 92).(91 91))
                            ((55 81).(54 55))
                            ((52 60).(40 59))
                            ((19 20).(20 95))
                            ((30 90).(29 90))
                            ((57 72).(23 71))
                            ((71 74).(74 75))
                            ((9 88).(38 92))
                            ((44 89).(43 90))
                            ((17 80).(79 85))
                            ((60 67).(59 67))
                            ((44 51).(31 84))
                            ((79 80).(15 79))
                            ((79 84).(68 85))
                            ((97 98).(30 96))
                            ((22 94).(23 95))
                            ((95 95).(1 95))
                            ((11 98).(11 99))
                            ((49 92).(82 91))
                            ((43 52).(44 51))
                            ((76 86).(51 81))
                            ((23 68).(32 69))
                            ((22 40).(22 23))
                            ((65 94).(81 94))
                            ((36 89).(88 90))
                            ((7 96).(4 97))
                            ((6 6).(9 19))
                            ((82 85).(33 85))
                            ((65 67).(66 93))
                            ((94 95).(67 89))
                            ((85 85).(77 84))
                            ((60 89).(83 90))
                            ((6 21).(2 75))
                            ((20 91).(16 19))
                            ((95 97).(51 94))
                            ((21 82).(8 8))
                            ((16 19).(20 83))
                            ((96 97).(8 81))
                            ((34 90).(5 94))
                            ((94 95).(70 94))
                            ((27 80).(27 81))
                            ((12 83).(13 13))
                            ((91 94).(8 92))
                            ((6 80).(5 79))
                            ((12 21).(12 20))
                            ((29 64).(28 63))
                            ((32 72).(23 71))
                            ((54 56).(54 57))
                            ((68 69).(11 68))
                            ((5 99).(4 95))
                            ((34 55).(35 56))
                            ((42 71).(42 72))
                            ((21 94).(93 96))
                            ((8 8).(8 96))
                            ((26 99).(25 97))
                            ((30 75).(2 29))
                            ((27 58).(28 52))
                            ((29 75).(28 76))
                            ((3 77).(3 78))
                            ((11 35).(11 36))
                            ((26 43).(38 41))
                            ((51 56).(33 57))
                            ((19 21).(20 98))
                            ((48 93).(47 48))
                            ((2 81).(31 75))
                            ((17 75).(16 16))
                            ((57 82).(48 48))
                            ((24 74).(25 65))
                            ((20 20).(21 21))
                            ((78 96).(77 79))
                            ((4 97).(4 98))
                            ((4 30).(19 31))
                            ((11 97).(10 89))
                            ((21 64).(1 64))
                            ((31 99).(16 98))
                            ((38 47).(40 40))
                            ((27 95).(12 17))
                            ((51 93).(51 92))
                            ((90 91).(6 91))
                            ((26 27).(16 26))
                            ((3 78).(1 1))
                            ((51 51).(52 92))
                            ((38 42).(32 36))
                            ((36 46).(10 67))
                            ((7 70).(6 71))
                            ((52 81).(51 81))
                            ((74 74).(75 84))
                            ((28 64).(29 29))
                            ((15 47).(15 16))
                            ((4 94).(95 95))
                            ((15 65).(15 97))
                            ((98 98).(1 99))
                            ((41 97).(42 98))
                            ((84 94).(90 95))
                            ((15 82).(83 83))
                            ((3 10).(10 73))
                            ((90 97).(5 96))
                            ((29 81).(29 45))
                            ((64 93).(5 99))
                            ((26 95).(25 26))
                            ((37 49).(38 50))
                            ((32 96).(10 33))
                            ((28 30).(28 31))
                            ((18 75).(19 75))
                            ((49 51).(17 50))
                            ((16 46).(15 17))
                            ((3 4).(3 95))
                            ((7 30).(30 31))
                            ((9 96).(9 95))
                            ((22 38).(18 39))
                            ((29 32).(50 89))
                            ((98 99).(1 99))
                            ((81 97).(9 83))
                            ((32 38).(64 69))
                            ((35 52).(51 53))
                            ((17 96).(17 98))
                            ((14 97).(98 98))
                            ((10 66).(11 65))
                            ((4 91).(4 91))
                            ((52 76).(73 74))
                            ((17 17).(16 17))
                            ((6 73).(7 74))
                            ((9 90).(9 89))
                            ((42 74).(42 84))
                            ((68 77).(69 77))
                            ((42 79).(40 51))
                            ((15 89).(15 90))
                            ((4 86).(3 3))
                            ((43 46).(40 46))
                            ((3 97).(2 98))
                            ((13 26).(12 97))
                            ((91 93).(15 92))
                            ((4 89).(4 99))
                            ((41 66).(14 40))
                            ((30 71).(31 71))
                            ((57 61).(38 60))
                            ((36 99).(35 98))
                            ((36 91).(20 36))
                            ((80 81).(16 80))
                            ((1 99).(4 96))
                            ((24 80).(25 80))
                            ((1 98).(2 99))
                            ((17 43).(17 44))
                            ((4 99).(2 2))
                            ((11 46).(11 45))
                            ((70 92).(69 86))
                            ((15 15).(3 14))
                            ((5 80).(7 81))
                            ((33 91).(52 60))
                            ((62 68).(4 62))
                            ((23 33).(22 33))
                            ((21 71).(7 72))
                            ((41 63).(40 62))
                            ((19 20).(20 26))
                            ((9 87).(8 86))
                            ((90 90).(91 96))
                            ((31 32).(50 68))
                            ((21 35).(31 85))
                            ((14 98).(15 15))
                            ((95 96).(46 95))
                            ((9 64).(10 21))
                            ((92 98).(30 66))
                            ((66 86).(79 95))
                            ((1 71).(34 71))
                            ((31 92).(91 93))
                            ((21 25).(8 17))
                            ((17 49).(1 69))
                            ((3 88).(2 98))
                            ((54 86).(53 55))
                            ((29 79).(95 96))
                            ((4 25).(3 25))
                            ((2 44).(3 61))
                            ((34 85).(33 35))
                            ((8 10).(8 11))
                            ((95 97).(45 98))
                            ((63 92).(62 93))
                            ((61 79).(60 80))
                            ((36 85).(20 36))
                            ((45 71).(10 53))
                            ((56 85).(52 84))
                            ((40 86).(41 86))
                            ((6 83).(4 78))
                            ((18 53).(19 54))
                            ((69 73).(69 72))
                            ((3 76).(75 75))
                            ((28 88).(19 60))
                            ((3 85).(10 85))
                            ((36 69).(35 69))
                            ((58 82).(57 82))
                            ((16 98).(15 99))
                            ((71 84).(84 85))
                            ((7 68).(42 67))
                            ((3 69).(70 70))
                            ((2 10).(7 11))
                            ((59 91).(27 91))
                            ((4 99).(5 94))
                            ((71 84).(30 70))
                            ((28 28).(12 27))
                            ((52 88).(14 26))
                            ((91 91).(42 90))
                            ((6 56).(5 42))
                            ((15 37).(17 53))
                            ((10 86).(86 87))
                            ((11 91).(4 92))
                            ((46 46).(19 45))
                            ((37 92).(37 96))
                            ((58 60).(35 59))
                            ((6 33).(5 33))
                            ((34 34).(13 34))
                            ((3 62).(1 1))
                            ((33 64).(49 61))
                            ((37 45).(36 52))
                            ((13 96).(8 82))
                            ((3 99).(2 3))
                            ((41 66).(27 67))
                            ((85 87).(20 86))
                            ((9 26).(8 25))))
#+END_SRC

#+RESULTS: 2022-day4-input
: aoc22/day4input

#+NAME: 2022-day4-solution
#+BEGIN_SRC emacs-lisp :session "day4"
;;; Code:

(defun aoc22/day4-part1 (input)
  "Takes INPUT a list of list pairs and counts which pair contain each other.
In order for a pair to be eligible for inclusion, one of them
should include the other in whole.  The comparison of pair edges
should include equality also."
  (let ((pairs 0))
    (dolist (pair input)
      (let ((left (car pair))
            (right (cdr pair)))
        (cond
         ((= (car left) (car right))
          (cl-incf pairs))
         ((= (cadr left) (cadr right))
          (cl-incf pairs))
         ((< (car left) (car right))
          (if (> (cadr left) (cadr right))
              (cl-incf pairs)))
         (t
          (if (< (cadr left) (cadr right))
              (cl-incf pairs))))))
    pairs))

(defun aoc22/day4-part2 (input)
  "Takes INPUT and solve the puzzle.
To be replaced with actual docstring."
  (let ((pairs 0))
    (dolist (pair input)
      (let ((left (car pair))
            (right (cdr pair)))
        (if (not (or (< (cadr left) (car right)) (< (cadr right) (car left))))
            (cl-incf pairs))))
    pairs))

;;; Helper functions:

;;; Results vector

(vector (aoc22/day4-part1 aoc22/day4test)
        (aoc22/day4-part1 aoc22/day4input)
        (aoc22/day4-part2 aoc22/day4test)
        (aoc22/day4-part2 aoc22/day4input))
#+END_SRC

#+RESULTS: 2022-day4-solution
: [2 444 4 801]
** day 5
#+NAME: 2022-day5-input
#+BEGIN_SRC emacs-lisp :session "day5"
(defconst aoc22/day5test '((N Z)
                           (D C M)
                           (P)))

(defconst aoc22/day5test-inst '((1 2 1)
                                (3 1 3)
                                (2 2 1)
                                (1 1 2)))

(defconst aoc22/day5input '((F G V R J L D)
                            (S J H V B M P T)
                            (C P G D F M H V)
                            (Q G N P D M)
                            (F N H L J)
                            (Z T G D Q V F N)
                            (L B D F)
                            (N D V S B J M)
                            (D L G)))

(defconst aoc22/day5input-inst '((3 4 6)
                                 (1 5 8)
                                 (3 7 3)
                                 (4 5 7)
                                 (1 7 8)
                                 (3 9 4)
                                 (2 8 2)
                                 (4 4 5)
                                 (2 5 1)
                                 (2 5 6)
                                 (7 8 1)
                                 (9 3 9)
                                 (11 6 5)
                                 (2 6 7)
                                 (12 1 4)
                                 (10 2 9)
                                 (2 3 9)
                                 (1 7 5)
                                 (4 7 6)
                                 (2 6 1)
                                 (5 1 6)
                                 (10 9 1)
                                 (9 9 8)
                                 (13 4 3)
                                 (7 6 2)
                                 (2 8 5)
                                 (9 3 9)
                                 (8 9 8)
                                 (4 8 4)
                                 (1 7 5)
                                 (3 9 1)
                                 (7 2 1)
                                 (1 3 1)
                                 (1 3 6)
                                 (1 6 1)
                                 (2 3 6)
                                 (5 4 1)
                                 (1 6 1)
                                 (3 8 7)
                                 (8 8 4)
                                 (3 5 4)
                                 (1 6 7)
                                 (1 5 8)
                                 (4 5 2)
                                 (7 5 8)
                                 (3 2 7)
                                 (7 4 8)
                                 (11 8 4)
                                 (15 4 1)
                                 (25 1 6)
                                 (4 8 7)
                                 (1 2 4)
                                 (11 6 4)
                                 (12 6 3)
                                 (1 1 9)
                                 (1 9 8)
                                 (16 1 3)
                                 (1 8 7)
                                 (12 4 6)
                                 (9 6 5)
                                 (3 6 5)
                                 (6 7 5)
                                 (3 3 5)
                                 (2 6 3)
                                 (11 5 8)
                                 (2 8 3)
                                 (2 1 4)
                                 (7 3 1)
                                 (2 4 6)
                                 (2 6 2)
                                 (5 7 3)
                                 (1 1 6)
                                 (1 1 8)
                                 (2 2 5)
                                 (1 7 4)
                                 (1 1 2)
                                 (10 3 5)
                                 (11 3 6)
                                 (1 4 9)
                                 (1 9 4)
                                 (1 4 2)
                                 (2 5 9)
                                 (2 2 8)
                                 (2 1 6)
                                 (2 1 2)
                                 (2 3 6)
                                 (3 8 1)
                                 (3 1 4)
                                 (7 8 3)
                                 (2 9 5)
                                 (2 4 9)
                                 (7 5 6)
                                 (2 8 6)
                                 (1 4 8)
                                 (2 2 4)
                                 (21 6 3)
                                 (10 5 7)
                                 (7 7 6)
                                 (1 9 3)
                                 (1 4 9)
                                 (1 9 4)
                                 (1 8 4)
                                 (8 6 4)
                                 (1 4 5)
                                 (1 5 8)
                                 (4 3 6)
                                 (1 8 2)
                                 (1 4 2)
                                 (2 7 3)
                                 (2 2 7)
                                 (22 3 5)
                                 (4 6 2)
                                 (2 6 9)
                                 (7 3 9)
                                 (6 9 1)
                                 (18 5 3)
                                 (2 5 4)
                                 (20 3 5)
                                 (3 7 3)
                                 (5 1 2)
                                 (11 5 7)
                                 (1 1 7)
                                 (3 9 3)
                                 (16 5 8)
                                 (7 8 7)
                                 (1 9 2)
                                 (8 2 3)
                                 (2 2 4)
                                 (3 3 1)
                                 (9 3 8)
                                 (1 6 3)
                                 (9 7 3)
                                 (3 1 8)
                                 (1 7 9)
                                 (1 9 4)
                                 (1 7 5)
                                 (10 4 5)
                                 (2 4 2)
                                 (19 8 5)
                                 (1 8 3)
                                 (4 3 5)
                                 (2 4 8)
                                 (4 7 8)
                                 (4 3 9)
                                 (4 7 6)
                                 (2 2 5)
                                 (2 3 2)
                                 (6 8 7)
                                 (1 8 4)
                                 (2 6 4)
                                 (3 4 8)
                                 (3 9 2)
                                 (4 7 8)
                                 (28 5 8)
                                 (16 8 4)
                                 (11 8 4)
                                 (3 3 4)
                                 (7 5 8)
                                 (13 8 7)
                                 (1 5 6)
                                 (1 6 7)
                                 (1 9 2)
                                 (2 6 2)
                                 (12 4 9)
                                 (4 4 1)
                                 (2 9 8)
                                 (4 8 3)
                                 (3 4 5)
                                 (4 4 1)
                                 (4 4 7)
                                 (3 7 9)
                                 (5 9 7)
                                 (7 2 3)
                                 (1 5 7)
                                 (8 1 5)
                                 (1 2 4)
                                 (11 3 1)
                                 (10 5 3)
                                 (3 9 1)
                                 (3 9 6)
                                 (5 1 6)
                                 (7 6 9)
                                 (8 9 7)
                                 (9 3 4)
                                 (1 6 9)
                                 (8 7 1)
                                 (9 4 2)
                                 (2 1 6)
                                 (3 2 6)
                                 (4 4 6)
                                 (2 9 8)
                                 (2 1 2)
                                 (1 3 8)
                                 (2 8 4)
                                 (1 6 8)
                                 (11 1 6)
                                 (1 1 5)
                                 (3 2 9)
                                 (2 9 3)
                                 (1 1 7)
                                 (2 4 9)
                                 (4 2 9)
                                 (2 8 5)
                                 (10 6 1)
                                 (2 5 6)
                                 (5 9 8)
                                 (5 8 7)
                                 (1 2 1)
                                 (7 1 2)
                                 (2 9 4)
                                 (1 3 5)
                                 (15 7 2)
                                 (8 6 3)
                                 (2 4 3)
                                 (2 6 4)
                                 (4 7 1)
                                 (4 7 5)
                                 (1 6 4)
                                 (3 1 7)
                                 (5 7 6)
                                 (4 7 5)
                                 (18 2 4)
                                 (5 6 4)
                                 (4 1 2)
                                 (8 3 8)
                                 (2 8 4)
                                 (2 3 7)
                                 (1 5 7)
                                 (3 8 4)
                                 (2 7 2)
                                 (1 3 8)
                                 (9 2 6)
                                 (2 8 6)
                                 (1 7 3)
                                 (1 3 5)
                                 (3 6 8)
                                 (1 8 5)
                                 (1 5 9)
                                 (1 1 2)
                                 (5 4 6)
                                 (10 6 2)
                                 (5 2 6)
                                 (5 6 4)
                                 (1 6 3)
                                 (6 4 6)
                                 (3 2 6)
                                 (2 2 3)
                                 (11 4 6)
                                 (1 9 5)
                                 (4 6 7)
                                 (1 4 3)
                                 (12 4 3)
                                 (1 8 6)
                                 (9 5 7)
                                 (1 5 2)
                                 (1 8 5)
                                 (1 4 9)
                                 (9 7 9)
                                 (1 3 4)
                                 (2 3 6)
                                 (2 5 6)
                                 (2 8 5)
                                 (11 3 4)
                                 (2 3 1)
                                 (1 2 3)
                                 (1 3 8)
                                 (3 7 9)
                                 (5 4 2)
                                 (2 5 8)
                                 (6 4 2)
                                 (1 1 3)
                                 (12 9 1)
                                 (6 1 6)
                                 (1 8 4)
                                 (1 8 3)
                                 (5 2 7)
                                 (2 3 9)
                                 (5 7 1)
                                 (1 7 5)
                                 (2 9 1)
                                 (14 1 7)
                                 (2 4 7)
                                 (7 2 4)
                                 (1 2 1)
                                 (1 1 3)
                                 (1 5 4)
                                 (1 9 6)
                                 (16 6 5)
                                 (2 5 4)
                                 (12 6 8)
                                 (10 4 8)
                                 (9 7 3)
                                 (4 7 6)
                                 (11 5 8)
                                 (2 5 2)
                                 (14 8 9)
                                 (1 5 1)
                                 (3 9 4)
                                 (2 2 1)
                                 (7 8 3)
                                 (6 3 5)
                                 (8 9 8)
                                 (1 6 1)
                                 (1 4 2)
                                 (4 3 8)
                                 (1 7 2)
                                 (3 1 5)
                                 (2 5 7)
                                 (3 9 2)
                                 (1 1 8)
                                 (5 5 4)
                                 (2 7 8)
                                 (4 2 5)
                                 (1 2 4)
                                 (2 7 8)
                                 (4 6 2)
                                 (6 5 3)
                                 (1 6 5)
                                 (1 5 3)
                                 (1 3 8)
                                 (8 8 3)
                                 (9 8 5)
                                 (9 8 2)
                                 (2 8 9)
                                 (2 3 8)
                                 (5 5 8)
                                 (1 3 7)
                                 (2 9 5)
                                 (7 2 4)
                                 (14 4 6)
                                 (2 2 7)
                                 (1 7 3)
                                 (1 7 9)
                                 (3 5 2)
                                 (1 7 1)
                                 (3 2 4)
                                 (7 8 2)
                                 (3 6 1)
                                 (17 3 1)
                                 (2 8 3)
                                 (6 2 7)
                                 (2 7 9)
                                 (3 6 8)
                                 (2 8 6)
                                 (4 2 1)
                                 (3 4 7)
                                 (1 8 7)
                                 (1 8 9)
                                 (1 4 2)
                                 (3 5 7)
                                 (2 3 1)
                                 (2 3 5)
                                 (5 7 4)
                                 (5 7 3)
                                 (1 4 8)
                                 (3 3 1)
                                 (6 1 3)
                                 (1 7 5)
                                 (2 9 2)
                                 (3 5 8)
                                 (1 8 1)
                                 (8 3 5)
                                 (1 4 9)
                                 (3 6 5)
                                 (3 6 3)
                                 (2 3 7)
                                 (1 4 7)
                                 (3 6 4)
                                 (2 7 2)
                                 (1 7 8)
                                 (2 5 4)
                                 (1 6 1)
                                 (7 4 7)
                                 (7 5 2)
                                 (10 2 3)
                                 (3 2 6)
                                 (3 8 1)
                                 (1 8 7)
                                 (2 6 3)
                                 (1 6 9)
                                 (4 7 5)
                                 (16 1 5)
                                 (1 9 7)
                                 (3 7 6)
                                 (11 5 6)
                                 (2 7 9)
                                 (12 6 4)
                                 (2 6 9)
                                 (6 3 2)
                                 (1 5 7)
                                 (5 9 5)
                                 (1 9 6)
                                 (4 3 7)
                                 (1 4 2)
                                 (7 2 5)
                                 (3 5 2)
                                 (6 5 6)
                                 (3 2 6)
                                 (9 6 8)
                                 (5 5 9)
                                 (5 7 1)
                                 (4 1 9)
                                 (2 9 4)
                                 (1 6 7)
                                 (9 4 1)
                                 (7 5 9)
                                 (18 1 3)
                                 (9 9 5)
                                 (8 8 2)
                                 (1 2 5)
                                 (4 2 3)
                                 (4 9 6)
                                 (1 4 8)
                                 (2 5 7)
                                 (2 9 2)
                                 (10 3 9)
                                 (5 5 9)
                                 (1 7 2)
                                 (2 8 7)
                                 (2 3 5)
                                 (2 9 1)
                                 (2 7 3)
                                 (1 2 1)
                                 (5 5 8)
                                 (1 2 1)
                                 (15 3 6)
                                 (1 7 6)
                                 (10 6 5)
                                 (1 7 8)
                                 (4 1 6)
                                 (1 8 3)
                                 (2 1 5)
                                 (3 8 1)
                                 (1 4 6)
                                 (1 4 2)
                                 (4 9 7)
                                 (6 5 7)
                                 (3 1 9)
                                 (10 6 8)
                                 (2 1 3)
                                 (8 7 9)
                                 (1 9 6)
                                 (2 7 9)
                                 (3 3 5)
                                 (1 2 6)
                                 (2 6 5)
                                 (5 9 4)
                                 (4 8 2)
                                 (1 1 3)
                                 (4 5 9)
                                 (3 6 1)
                                 (2 1 5)
                                 (3 5 2)
                                 (8 8 3)
                                 (11 9 4)
                                 (13 4 8)
                                 (2 9 2)
                                 (2 3 1)
                                 (1 4 1)
                                 (1 3 8)
                                 (2 6 9)
                                 (7 8 1)
                                 (3 2 5)
                                 (7 2 5)
                                 (3 4 6)
                                 (4 9 2)
                                 (2 3 5)
                                 (9 5 6)
                                 (5 2 7)
                                 (2 9 2)
                                 (2 9 7)
                                 (12 6 8)
                                 (5 5 7)
                                 (1 9 8)
                                 (3 1 6)
                                 (5 5 8)
                                 (6 1 9)
                                 (2 1 5)
                                 (1 6 9)
                                 (5 9 7)
                                 (2 5 8)
                                 (11 7 6)
                                 (20 8 1)
                                 (2 9 8)
                                 (4 7 6)
                                 (6 8 3)
                                 (13 6 9)
                                 (4 3 2)
                                 (4 6 3)
                                 (2 3 6)
                                 (5 9 8)
                                 (2 7 1)
                                 (2 6 9)
                                 (6 8 3)
                                 (6 3 6)
                                 (5 2 9)
                                 (22 1 3)
                                 (3 2 1)
                                 (5 9 3)
                                 (1 1 6)
                                 (3 6 2)
                                 (1 2 4)
                                 (33 3 5)
                                 (1 8 7)))
#+END_SRC

#+RESULTS: 2022-day5-input
: aoc22/day5input

#+NAME: 2022-day5-solution
#+BEGIN_SRC emacs-lisp :session "day5" :var x=2022-day5-input
;;; Code:

(defun aoc22/day5-part1 (stacks instructions)
  "Follows INSTRUCTIONS to organize STACKS.
It follows all instructions pushing and popping on stacks and
finally prints out stacks to get the letters that are on top."
  (let ((stack (mapcar #'copy-sequence stacks)))
    (dolist (instr instructions)
      (let ((items (car instr))
            (source (1- (cadr instr)))
            (dest (1- (caddr instr))))
        (dotimes (it items)
          (push (pop (nth source stack)) (nth dest stack)))))
    (let (results)
      (dolist (result stack)
        (setq results (append results (list (car result)))))
      results)))

(defun aoc22/day5-part2 (stacks instructions)
  "Follows INSTRUCTIONS to organize STACKS.
The difference with previous function is that, items are not
moved one at a time, but all together in one instruction,
therefore keeping the order of them.  So we need an intermediate
move stack?"
  (let ((stack (mapcar #'copy-sequence stacks)))
    (dolist (instr instructions)
      (let ((items (car instr))
            (source (1- (cadr instr)))
            (dest (1- (caddr instr)))
            (intstack nil))
        (dotimes (it items)
          (push (pop (nth source stack)) intstack))
        (dotimes (it items)
          (push (pop intstack) (nth dest stack)))
        ))
    (let (results)
      (dolist (result stack)
        (setq results (append results (list (car result)))))
      results)))

;;; Helper functions:

;;; Results vector
(vector (aoc22/day5-part1 aoc22/day5test aoc22/day5test-inst)
        (aoc22/day5-part1 aoc22/day5input aoc22/day5input-inst)
        (aoc22/day5-part2 aoc22/day5test aoc22/day5test-inst)
        (aoc22/day5-part2 aoc22/day5input aoc22/day5input-inst))
#+END_SRC

#+RESULTS: 2022-day5-solution
: [(C M Z) (Q M B M J D F T D) (M C D) (N B T V T J N F J)]
** day 6
#+NAME: 2022-day6-input
#+BEGIN_SRC emacs-lisp :session "day6"
(defconst aoc22/day6test "nznrnfrfntjfmvfwmzdfjlvtqnbhcprsg")

(defconst aoc22/day6input "mgtgddtfdtffzvznvnrncrrbqqhlhhffzqqzpqqthhrhhfphfphhcppcddnwdnwwtmwttfvvthvvrrbvbmvmssrlslfslflppblllwrlrzlldwdllqblqbqbsscmsmwwffjpppnlnhllbblvbvsbbzvzrzzsmsjsddfpftfvtffgjjfzjfjqfqjfjsscvcccgttgtzgzmgmtmbbwzzjqzzdfzfmzmzfzwzvwvggqcqrrcwrcrzrccqcwwbgbqqwdqqzjzsjjwbjjssmmcfcbcddlhhtltmtlljffvjffhghmggmvvfgfqgfgppnpllmvmfvvzjjzrztztvvstsvvppqdpprjjmtmjtmjjdrdcrdccgsccnsccqsqzszqsqgqwggbhbllvclljrrlrqlljtjcjjlrlhrhjhjnnnpllwtwstttlnlqnlnmnqnpqpbqqbgbzzrhzrhzhrzhrzhzshhqvqgqgbbcqccqmcqccvgccrwrgwrgrdrhhbshbhwbhwbhhvthvttfrrqsstqssqmmpnpwpfpcffcdchhrsshrhggtcttmrrhvvjfvjvvclvllmqmvvhddrdjjhdhvhlvhlltlstltffbbqbwqbbbnsbnbwbssjwsjsfjjsjwwzttqzzsdspprlrblrltrrfrsfffwqwpwddddnqqtbtwwhwpwdwmmcrmrsmmwppjzpjpcpdpjpdpdqppmjjlqqjfqqhgqhhbddtccthhwjhhlfftvtppwzpwzpznpzpqpgqpgpnpdndnbnddqrrjdjwwdmmtnntvnnrhrfhfrfwfvwffmnfnlfldfdjjwgwqqwwsslrrvhhrqqsfqfllrmrqmrrbppwjppmlmggvppdhppspjjzljjrzzrlzrrlldllvlpvpfprfprrhdrdlllpqqfhqqhchzzzwpwjpjjgzzwqqtqdqbdbdgggbrgrzzznwwbvbnbpnbpprnrvvfvsscncrczcbchhjqhjjzrznndwnnvttmtthssgvvbvfvtvptpthhzggnjjhrjdqzjbtfpqdtwtmgnngqdzhdrfzqvcqggmcdbsdrdrmgqhmvfvdgbvrnlbhfsbpjhwgzfndqgcjdbpsffcslfcltsbclspdjhscqrncfrjrbjfzspccshtrdggjbhthrrhgnjvsptfnjvjvhhdjfbtfgpfgszhhbcvzplclrnsrpffpjhbthnfsfflqphhjjdpcfwzhfdpnsftrnfhrdhndlrnfrnvprtvnmgclzlrdjrzdcllvlwdlrcfbsgcbwcnbvjztzfsgcgqlmgcbsgwbbrmrcthfpvmbfvtbhqstccfntmphqpjwpbcdpnffqpszlnqdcqtfhvlvpgdpljvcschdtpvcswfzcbpqdhfjzzdjvgldspcvlnfnwffhjzdnbmjjtnrqlgnggsvdltnrpcfwqvphtsmrfzhflwjjbnpwlzhhmdnpqptgcjnrrgcnhwllqsbsjjvzmqsghlzvhdfbrnfhrqjswrpgcctsqvdwzgpqdssfmtgwvsznlbhsgppwdhhtjmscjfrjdgflwcrlbsfwrnvtnmcwpndhtttgqfvmvmfnwdrrvgmgdqlqvvlphwzgmwcphjvcfsqbbwttntmgvfmlmctggmtlwtmfsmczbgdvbsjstzgflnjplgrlhbbgldlchwmhclzbcwpqzlzbjzbplnvpbzjhmwfmrfnwlnsvpzhrgjdpqvnjtbfjfsvdqcfwdjftsmfqdrqllwlbnbmgtswrhbtbqlchznbgnphgntrtwbtmsjtphhqpbngwmmsdnsdqcctrsrzbrtpwtvhvqbrjldfldllpvspthdhdljfvjzcjsltwflscfqsrvzhgvzhqnnjwdwdtnsvgchzrnbzfscvsmrmqsqjmrjjdhtspbzpqtqqbfbzrddwqzwpqjbpbbbghlwmzhqvqdwwwwvltvvcpgzlwzvmqzfcgnjpjnpgsccvzpnzjwwnnjrcpbvwljfrjqzwsrvdmqwwfpldqcdwlchvggclmwnbhlrlzvsrtrqmzchqfqfhqfjgqsfvclnchdnnvdbqpcddnldggwrpbgrwwtssfndhrhnwtqmgrwpggntlqmfgbzjhwwsclvfmwgzzfrsccdfddntnlldpnwzhnzlssnnfbvjjhnrvclmphgfpvnwjzznbvgqnpljcrjpndgrlbdzsbfrrrfztbqcbphlppwcvhmrrmtrlvfjcddtznlmflrpsclgjpqczwrptfsccmdpzfvwnfsvshcnzrjrmstrslhgtrsmgplvcwptfqrgzgwhvtvrqlrjpcbztgtfwpnzqpmctvpdlgrtzzlsmgnftqvtvcmndspjqbdnmrttwhdrncsntntmrwjrqstdrptnhbqgtlqsdqfmbjtvgstndlvndqqsbqvcghwwjdzpszrsfpdzvnmnbzngczndtwtmprbzjdzbthslttzwwfptbphqwczsrqcbcbqnhbtcpjpbcqpjgjmhmfnggcbvctslpmqrpqzbcfrcgzmzpbpwzsjlrmpfzhgnnbqfrbslrfsthgtmsdfhzgdmjwwsgcdptssmbvffhlmfvwnmbpnzbvpsvnwsvsgrcmhpclwsbvtfqstnpzvgmgfcrmjhbccwcptssjhbfmzsqljjcrnnszvffzfwgcpnqrtjnqdltwnbglwlwpschvqwfdztvcwsqtwmgwccgsqbsvlwdhlnqphwtcmdpvvrqfwmlbptbvghvjntqbcsqjspwnmvdqcfbqzqchhhwqgdcmdhfvtzprscpshpbmzhwsznlpvzrwvmhtqsclzffgnvvrfbzmvqmnrrzjbmhdbspjprrmflgrwhnhcqpczchpnrnfjgdlnlrnzwnvjpmzgpfzspwmfnwcrrdczdhtnscmwqwqbcrdrsndpwbdvpgpbpsfzbmvjlsrdcgnwgrvmjnzlpnwtcrmnfcqgmlnhqbwlrnzlbdrnzfhnqddsfmnhnrrrdjgqprmgvrnhzrlccjthhfzdbltgrbrjpmbhvgrlwngdlfsljhfvwhvpmltdfnzwzcgzdpppnzcnpjttdgpzzqppnfzlmhrngbmcmshtgzbjllwstdbnmmwlrlllgfgshvcsjbpnggzrvvmvdqhjhvhmmpvrdqbrfpdtcdbqrvwhdrtqgftnwwzrcgzwmwjmdgmfswqwlgmvmvhscjmzshtbzmfmbqtbsjppzbczwcqpqhhqdggcntdchjgwsvfnzfqdzvhpnwbjhbqnldzbzmctcdqgjsmbqdzmmtjzvqzdqzsfpmncdmqlnpsrwcznbtzqtbcwwdqjftcdmmwdjdnwvpchffsmqmmwvqfgcnfhbjsttwnwppssmvrrhrbqwsncpfnbfggdqjwbgtvgtwsmlqbwzlghnzhjwphswjtbtptmhlzhvvrwqqcgwnmcqtcjlndwgjrpschhhsmrvvwtrjplwrtswhrjlgjhzgzrjhsbrjhtgnmfdvbjlntcrphsnmdcjzgwtvgldrfpcfgpzlgsfthdmpbnhmlsbnbqzpqvzzmvswbbnbtzvbsznqdgqlbbwzhjrzndltfgswtszsmmrhrcrcrcpgtqfcrmjrtflsbcbbmrsrfgnsrmbrpcvfpmqtmbrbbqtzrjntnvbvwjwqmwmcvmzccmwcnhrfpgghlqczcfszfhqgrdnfpnrrzpzbnjqjtvbglvqlhpstpzzcwrdgfhghqtsgzgsmgnpgvbsvsjtnwbvtqpcfdvhnjjvwjwglplthmghrwpmsgbdbfpvqsmsdvjgchlnlnczlzczqmjsnpgrgqgndwzdtlmmgzjpqvbqmcmhnhpqvpjjsftctwsrfmhrlctrvhczjbfsvqnshmchdsrmlrlqdnfsvhlblwghsdnrtwnpdtqgczmghqcmfzvsgqvrngjvbjsvnpzvpsplhvndvqpjjrtmrqscjrhvdmqcgwjmrgsdmgswgnbpdtgvvbrzrcwtvvwhpmcqwdtsmwwfgdpdrjsbvtbdvbhwftqznpssnsnjnclblslfgz")

#+END_SRC

#+RESULTS: 2022-day6-input
: aoc22/day6input

#+NAME: 2022-day6-solution
#+BEGIN_SRC emacs-lisp :session "day6" :val x=2022-day6-input
;;; Code:

(defun aoc22/day6-part1 (input)
  "Find in INPUT the start of packet marker.
This marker is the index of the last character in INPUT
that a four letter substring has all letters unique."
  (aoc22/find-uniq input 0 4))

(defun aoc22/day6-part2 (input)
  "Find in INPUT the start of message marker.
This marker is the index of the last character in INPUT that a
fourteen letter substring has all letters unique."
  (let ((index (aoc22/day6-part1 input)))
    (aoc22/find-uniq input (- index 4) 14)))

;;; Helper functions:
(defun aoc22/find-uniq (stream index step)
  "Find in STEP chars of STREAM, starting from INDEX, if they are all unique."
  (let ((buffer (aoc22/string-to-list (substring stream index (+ index step))))
        (space (aoc22/string-to-list (substring stream (+ index step)))))
    (cl-dolist (item space)
      (if (equal buffer (seq-uniq buffer))
          (cl-return (+ index step))
        (setq buffer (append buffer (list item)))
        (pop buffer)
        (cl-incf index)))))


(defun aoc22/string-to-list (stream)
  "Convert STREAM to a list of numbers.
STREAM is a string of ASCII letters."
  (mapcar #'string-to-char
          (split-string stream "" t)))
;;; Results vector

(vector (aoc22/day6-part1 aoc22/day6test)
        (aoc22/day6-part1 aoc22/day6input)
        (aoc22/day6-part2 aoc22/day6test)
        (aoc22/day6-part2 aoc22/day6input)
        )
#+END_SRC

#+RESULTS: 2022-day6-solution
: [10 1042 29 2980]
** day 7
#+NAME: 2022-day7-input
#+BEGIN_SRC emacs-lisp :session "day7"
(defconst aoc22/day7test '(($ cd /)
                           ($ ls)
                           (dir a)
                           (14848514 b.txt)
                           (8504156 c.dat)
                           (dir d)
                           ($ cd a)
                           ($ ls)
                           (dir e)
                           (29116 f)
                           (2557 g)
                           (62596 h.lst)
                           ($ cd e)
                           ($ ls)
                           (584 i)
                           ($ cd ..)
                           ($ cd ..)
                           ($ cd d)
                           ($ ls)
                           (4060174 j)
                           (8033020 d.log)
                           (5626152 d.ext)
                           (7214296 k)))

(defconst aoc22/day7input '(($ cd /)
                            ($ ls)
                            (dir plws)
                            (dir pwlbgbz)
                            (dir pwtpltr)
                            (dir szn)
                            ($ cd plws)
                            ($ ls)
                            (dir ffpzc)
                            (dir frcmjzts)
                            (92461 nbvnzg)
                            (dir phqcg)
                            (21621 vqgsglwq)
                            ($ cd ffpzc)
                            ($ ls)
                            (48459 dzdfc.vqq)
                            (143107 jql.jzl)
                            (208330 mmnvqn.hqb)
                            (290122 svjvhflz)
                            (218008 wjlmgq)
                            ($ cd ..)
                            ($ cd frcmjzts)
                            ($ ls)
                            (dir bsltmjz)
                            (dir jfzgrbm)
                            ($ cd bsltmjz)
                            ($ ls)
                            (34237 dzdfc.vqq)
                            (58741 mdgdhqgw)
                            ($ cd ..)
                            ($ cd jfzgrbm)
                            ($ ls)
                            (132811 fcmpng)
                            (103661 lgt.swt)
                            (173031 vqgsglwq)
                            (29134 wprjfg.zbr)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd phqcg)
                            ($ ls)
                            (955 jgfs.zjw)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd pwlbgbz)
                            ($ ls)
                            (dir gbg)
                            (dir mjzhcwrd)
                            (dir njcscpj)
                            (dir sphbzn)
                            (dir tbgjpphc)
                            (55938 tvrfpczc.djm)
                            (4840 twd)
                            ($ cd gbg)
                            ($ ls)
                            (287003 fcsjl.bzm)
                            (dir wgq)
                            ($ cd wgq)
                            ($ ls)
                            (22963 fcsjl.fcm)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd mjzhcwrd)
                            ($ ls)
                            (228632 clfnpmbq.zmb)
                            (28276 dzdfc.vqq)
                            (2982 tdbg.wgn)
                            ($ cd ..)
                            ($ cd njcscpj)
                            ($ ls)
                            (dir dqzgqgv)
                            (275186 ffpzc)
                            (192491 gjnflc.plq)
                            ($ cd dqzgqgv)
                            ($ ls)
                            (70309 dzdfc.vqq)
                            (56139 fcsjl)
                            (142095 sgwz.cdz)
                            (dir snjntth)
                            (dir sphbzn)
                            (284618 wjlmgq)
                            ($ cd snjntth)
                            ($ ls)
                            (51918 ffpzc)
                            (dir vrfgfds)
                            ($ cd vrfgfds)
                            ($ ls)
                            (155233 jlscz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd sphbzn)
                            ($ ls)
                            (dir qbzwrrw)
                            (dir qwpzn)
                            ($ cd qbzwrrw)
                            ($ ls)
                            (278531 fcsjl.tqj)
                            (211591 snjntth.gpd)
                            ($ cd ..)
                            ($ cd qwpzn)
                            ($ ls)
                            (174183 vqgsglwq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd sphbzn)
                            ($ ls)
                            (185471 bsltmjz.fqz)
                            (dir bsvh)
                            (dir fvzcs)
                            (dir ndw)
                            (dir nlml)
                            (dir pcbt)
                            (286260 zhcmrpvt)
                            ($ cd bsvh)
                            ($ ls)
                            (130814 wjlmgq)
                            ($ cd ..)
                            ($ cd fvzcs)
                            ($ ls)
                            (dir cgmv)
                            (dir ggzwljr)
                            (298241 qvzghdpw.lms)
                            (dir snjntth)
                            (dir sphbzn)
                            ($ cd cgmv)
                            ($ ls)
                            (46843 dzdfc.vqq)
                            (dir lmqcbbm)
                            (dir rstcqsmd)
                            (215261 snjntth)
                            ($ cd lmqcbbm)
                            ($ ls)
                            (229898 bdmbvgp)
                            (25529 ffpzc.stm)
                            (16871 lnpjzvg.qlj)
                            ($ cd ..)
                            ($ cd rstcqsmd)
                            ($ ls)
                            (289038 zrbbbwng.smf)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ggzwljr)
                            ($ ls)
                            (198200 bcthn)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (191672 fwp.phf)
                            (68229 hzs.zpg)
                            (dir pggcwb)
                            (222426 qbv.bwj)
                            (dir snjntth)
                            (155354 vmqcm)
                            ($ cd pggcwb)
                            ($ ls)
                            (154272 fqztwvnv.lvv)
                            (dir pdjg)
                            (62393 vqgsglwq)
                            (dir wjhrtg)
                            ($ cd pdjg)
                            ($ ls)
                            (260644 gvhlrcf)
                            (209906 wpls.pbd)
                            ($ cd ..)
                            ($ cd wjhrtg)
                            ($ ls)
                            (148640 dljf.zrq)
                            (172168 dzdfc.vqq)
                            (196203 hjdphcfm)
                            (247620 sgwz.cdz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (37467 ndlshlmj.cjq)
                            (257404 snjntth.nsf)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd sphbzn)
                            ($ ls)
                            (64082 bfdv.lwv)
                            (dir bsltmjz)
                            (58942 dzdfc.vqq)
                            (dir snjntth)
                            ($ cd bsltmjz)
                            ($ ls)
                            (dir bsqqdr)
                            (266007 fcsjl.gfm)
                            (dir ffpzc)
                            (dir frsmrd)
                            (72122 nthnhzwf)
                            (286705 wjlmgq)
                            ($ cd bsqqdr)
                            ($ ls)
                            (117496 wcqt)
                            ($ cd ..)
                            ($ cd ffpzc)
                            ($ ls)
                            (280224 mmnvqn.hqb)
                            (105346 vrr)
                            ($ cd ..)
                            ($ cd frsmrd)
                            ($ ls)
                            (111509 sphbzn.shz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (177491 mplj)
                            (9029 pvbz.jwn)
                            (92891 snjntth.zrv)
                            (203356 vnnnw.gql)
                            (134728 vqgsglwq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ndw)
                            ($ ls)
                            (241303 bht.rpj)
                            (173068 vqgsglwq)
                            ($ cd ..)
                            ($ cd nlml)
                            ($ ls)
                            (228982 hzglfpvq.ftt)
                            (114981 sgwz.cdz)
                            ($ cd ..)
                            ($ cd pcbt)
                            ($ ls)
                            (dir bsltmjz)
                            (dir ffpzc)
                            (dir fjsjwfg)
                            (dir fwm)
                            (dir jvwt)
                            (227943 tmr.jdc)
                            (dir vwpqzdwh)
                            (31258 wjlmgq)
                            ($ cd bsltmjz)
                            ($ ls)
                            (177750 bsltmjz.spj)
                            (dir ffpzc)
                            (dir flrpwfs)
                            (138824 mtmdtcpv.cfj)
                            (165770 wzqwczj.qwn)
                            ($ cd ffpzc)
                            ($ ls)
                            (179645 snjntth.dss)
                            ($ cd ..)
                            ($ cd flrpwfs)
                            ($ ls)
                            (60566 wvjq.gmm)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ffpzc)
                            ($ ls)
                            (97847 qzhhtmd.bhw)
                            (1197 vqgsglwq)
                            ($ cd ..)
                            ($ cd fjsjwfg)
                            ($ ls)
                            (152232 dnsdd.jgz)
                            (181301 gsb.wsh)
                            (dir jqpb)
                            (dir jscbg)
                            (dir snjntth)
                            (227677 snjntth.vvg)
                            (dir sphbzn)
                            (75358 vqgsglwq)
                            (2589 wjlmgq)
                            ($ cd jqpb)
                            ($ ls)
                            (253403 mmnvqn.hqb)
                            (108325 rvq.mrc)
                            ($ cd ..)
                            ($ cd jscbg)
                            ($ ls)
                            (dir dtm)
                            (dir gsdnz)
                            (208269 prh)
                            (25977 qdzljgh)
                            (169262 vmnq.mth)
                            ($ cd dtm)
                            ($ ls)
                            (80072 gzqnb)
                            ($ cd ..)
                            ($ cd gsdnz)
                            ($ ls)
                            (dir dsqzjs)
                            (297895 sgwz.cdz)
                            (129983 vqgsglwq)
                            ($ cd dsqzjs)
                            ($ ls)
                            (2621 jqrlsf.gzs)
                            (164844 snjntth)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (118553 cbhql)
                            (dir ffpzc)
                            (dir snjntth)
                            ($ cd ffpzc)
                            ($ ls)
                            (dir lmn)
                            (12104 tvlwn.vhh)
                            ($ cd lmn)
                            ($ ls)
                            (46401 bsltmjz)
                            (96888 shrnqhvq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (dir snjntth)
                            (dir vlnfhbq)
                            (dir wpwl)
                            ($ cd snjntth)
                            ($ ls)
                            (dir ctj)
                            ($ cd ctj)
                            ($ ls)
                            (82485 fcsjl.lfl)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd vlnfhbq)
                            ($ ls)
                            (250106 qvf)
                            ($ cd ..)
                            ($ cd wpwl)
                            ($ ls)
                            (153950 cmsd.rlg)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd sphbzn)
                            ($ ls)
                            (dir glgq)
                            ($ cd glgq)
                            ($ ls)
                            (285182 wjlmgq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd fwm)
                            ($ ls)
                            (251865 ffpzc.qgb)
                            (279522 zvvpfqtp)
                            ($ cd ..)
                            ($ cd jvwt)
                            ($ ls)
                            (48990 bsltmjz.nzp)
                            (219604 ffpzc)
                            (69573 mvmdfzr.lwb)
                            ($ cd ..)
                            ($ cd vwpqzdwh)
                            ($ ls)
                            (267581 pvcch)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd tbgjpphc)
                            ($ ls)
                            (255571 dstpcgr.tfq)
                            (dir fdbwbrpp)
                            (dir gjzwh)
                            (dir hjvrtjt)
                            (dir rhzczj)
                            (292888 sgwz.cdz)
                            (dir wlzhr)
                            (149395 wnfzrqgz.dtn)
                            ($ cd fdbwbrpp)
                            ($ ls)
                            (dir ffpzc)
                            (dir qbrth)
                            (51164 qprp)
                            (dir slpt)
                            (117026 sphbzn)
                            (295685 vqgsglwq)
                            (dir znmj)
                            ($ cd ffpzc)
                            ($ ls)
                            (dir jhnzrdvb)
                            ($ cd jhnzrdvb)
                            ($ ls)
                            (217775 ffpzc.sgw)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd qbrth)
                            ($ ls)
                            (183969 lpbwgfjv.vcg)
                            (47333 wjlmgq)
                            ($ cd ..)
                            ($ cd slpt)
                            ($ ls)
                            (32343 tqhtj.jwz)
                            ($ cd ..)
                            ($ cd znmj)
                            ($ ls)
                            (55058 mmnvqn.hqb)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd gjzwh)
                            ($ ls)
                            (dir dvcbcd)
                            (202530 dzdfc.vqq)
                            (dir fsgz)
                            (dir hfrrqq)
                            (54897 jlzn.qsn)
                            (16097 ldzqsbb.jzl)
                            (225078 pswccrd)
                            (dir rqqmldw)
                            (292464 rzrdhbp.vld)
                            (dir ssqbqqp)
                            (dir zsztqrc)
                            ($ cd dvcbcd)
                            ($ ls)
                            (187837 dzdfc.vqq)
                            (dir jlwtvf)
                            (dir jnjvshs)
                            (164053 nrf.fqd)
                            (5665 tlp.jmt)
                            (13801 wjlmgq)
                            ($ cd jlwtvf)
                            ($ ls)
                            (219985 sphbzn.dvj)
                            ($ cd ..)
                            ($ cd jnjvshs)
                            ($ ls)
                            (dir bsltmjz)
                            (dir nrpm)
                            ($ cd bsltmjz)
                            ($ ls)
                            (152972 qgdqj)
                            ($ cd ..)
                            ($ cd nrpm)
                            ($ ls)
                            (18509 wjlmgq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd fsgz)
                            ($ ls)
                            (224576 mmnvqn.hqb)
                            ($ cd ..)
                            ($ cd hfrrqq)
                            ($ ls)
                            (dir bwgsnfvb)
                            (dir fcsjl)
                            (294608 ffpzc.gvm)
                            (136880 qjcgtw)
                            (dir sphbzn)
                            ($ cd bwgsnfvb)
                            ($ ls)
                            (29735 dzdfc.vqq)
                            (dir wstmzfml)
                            ($ cd wstmzfml)
                            ($ ls)
                            (158447 bnvhbvvc.nrt)
                            (59889 jclclgd)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd fcsjl)
                            ($ ls)
                            (138297 ffpzc.szw)
                            ($ cd ..)
                            ($ cd sphbzn)
                            ($ ls)
                            (dir wqdths)
                            ($ cd wqdths)
                            ($ ls)
                            (8326 cgvtw.jpz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd rqqmldw)
                            ($ ls)
                            (226757 dzdfc.vqq)
                            (115055 mwb.btc)
                            (dir qpts)
                            (298524 sgwz.cdz)
                            ($ cd qpts)
                            ($ ls)
                            (60860 bsltmjz.frp)
                            (dir fcsjl)
                            (94904 sgwz.cdz)
                            (dir wnmqqspz)
                            ($ cd fcsjl)
                            ($ ls)
                            (25082 mmnvqn.hqb)
                            ($ cd ..)
                            ($ cd wnmqqspz)
                            ($ ls)
                            (165529 sgwz.cdz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ssqbqqp)
                            ($ ls)
                            (192477 pvrgm)
                            ($ cd ..)
                            ($ cd zsztqrc)
                            ($ ls)
                            (254053 lht.htn)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd hjvrtjt)
                            ($ ls)
                            (189942 fwps)
                            ($ cd ..)
                            ($ cd rhzczj)
                            ($ ls)
                            (36502 bmtfr)
                            (dir ffjz)
                            (35148 nctfhmzm.vsz)
                            (dir qdgjzcz)
                            (208196 rwql)
                            (79863 sgwz.cdz)
                            (dir snjntth)
                            ($ cd ffjz)
                            ($ ls)
                            (dir grsvhwm)
                            ($ cd grsvhwm)
                            ($ ls)
                            (50231 fwj.rdv)
                            (dir snjntth)
                            ($ cd snjntth)
                            ($ ls)
                            (dir dtbgb)
                            ($ cd dtbgb)
                            ($ ls)
                            (150245 vdflm.lmq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd qdgjzcz)
                            ($ ls)
                            (222389 dzdfc.vqq)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (56794 mmnvqn.hqb)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd wlzhr)
                            ($ ls)
                            (116628 bsltmjz)
                            (60122 jqpbsgnr.fgb)
                            (252605 lfss)
                            (300065 qwjdl.vhr)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd pwtpltr)
                            ($ ls)
                            (dir dplsvrhl)
                            (140951 gwtfzqvd.znb)
                            (dir jbvdb)
                            (dir jst)
                            (dir qhjv)
                            (dir snjntth)
                            ($ cd dplsvrhl)
                            ($ ls)
                            (272101 fcsjl)
                            (dir ffpzc)
                            (58852 mmnvqn.hqb)
                            (dir mnhntjz)
                            (91899 sgwz.cdz)
                            (228077 snjntth.btv)
                            ($ cd ffpzc)
                            ($ ls)
                            (5499 bsltmjz)
                            (dir qmfwpjhl)
                            (dir rsrb)
                            (dir wgt)
                            ($ cd qmfwpjhl)
                            ($ ls)
                            (300362 dzdfc.vqq)
                            ($ cd ..)
                            ($ cd rsrb)
                            ($ ls)
                            (252983 dzdfc.vqq)
                            (107744 ltssrgqb.zvj)
                            (214895 rhglgcwr.wpw)
                            (249727 sgwz.cdz)
                            ($ cd ..)
                            ($ cd wgt)
                            ($ ls)
                            (141984 dzdfc.vqq)
                            (194686 mmnvqn.hqb)
                            (258023 pgr)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd mnhntjz)
                            ($ ls)
                            (dir bdvght)
                            (dir jprwchh)
                            (dir snjntth)
                            ($ cd bdvght)
                            ($ ls)
                            (243166 vpsvjdq.wsn)
                            ($ cd ..)
                            ($ cd jprwchh)
                            ($ ls)
                            (178943 bmpc.bjb)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (dir nlbm)
                            (dir zjmjntff)
                            ($ cd nlbm)
                            ($ ls)
                            (33050 fcsjl.rcc)
                            (dir sphbzn)
                            (17446 wjlmgq)
                            ($ cd sphbzn)
                            ($ ls)
                            (214563 prrfhff.pbp)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd zjmjntff)
                            ($ ls)
                            (82134 sgwz.cdz)
                            (52203 vrtlgdq.crp)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd jbvdb)
                            ($ ls)
                            (dir wmtjh)
                            ($ cd wmtjh)
                            ($ ls)
                            (dir ggvwn)
                            ($ cd ggvwn)
                            ($ ls)
                            (192285 spqvmf.sdh)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd jst)
                            ($ ls)
                            (dir bsltmjz)
                            (212740 dzdfc.vqq)
                            (dir gncztvtb)
                            (dir jsqjcqnt)
                            (286257 jvs)
                            (36654 sdcsm.mbg)
                            (192040 sgwz.cdz)
                            (dir tbqphzb)
                            (dir vdcqgts)
                            (285843 wjlmgq)
                            ($ cd bsltmjz)
                            ($ ls)
                            (215705 snjntth.gpv)
                            (213665 wjlmgq)
                            ($ cd ..)
                            ($ cd gncztvtb)
                            ($ ls)
                            (229298 vqgsglwq)
                            ($ cd ..)
                            ($ cd jsqjcqnt)
                            ($ ls)
                            (dir bsltmjz)
                            (dir fcsjl)
                            (dir ffpzc)
                            (dir sphbzn)
                            (70864 vqgsglwq)
                            ($ cd bsltmjz)
                            ($ ls)
                            (14981 pqzffzjc)
                            ($ cd ..)
                            ($ cd fcsjl)
                            ($ ls)
                            (140328 jwhczwbc)
                            ($ cd ..)
                            ($ cd ffpzc)
                            ($ ls)
                            (213650 mmnvqn.hqb)
                            ($ cd ..)
                            ($ cd sphbzn)
                            ($ ls)
                            (dir psmtphhq)
                            (dir sphbzn)
                            ($ cd psmtphhq)
                            ($ ls)
                            (dir ffpzc)
                            (123131 tzgwd)
                            ($ cd ffpzc)
                            ($ ls)
                            (49737 cfngvmd)
                            (dir gcnrp)
                            (172799 gmd.cwl)
                            (dir llnztjf)
                            (dir nbqs)
                            (79661 rrqz)
                            ($ cd gcnrp)
                            ($ ls)
                            (283 vqnrgl.vwp)
                            ($ cd ..)
                            ($ cd llnztjf)
                            ($ ls)
                            (63263 tjhm.bwh)
                            ($ cd ..)
                            ($ cd nbqs)
                            ($ ls)
                            (dir vssmq)
                            ($ cd vssmq)
                            ($ ls)
                            (88980 dzdfc.vqq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd sphbzn)
                            ($ ls)
                            (20140 fcsjl.zrs)
                            (260579 snjntth)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd tbqphzb)
                            ($ ls)
                            (93470 sgwz.cdz)
                            ($ cd ..)
                            ($ cd vdcqgts)
                            ($ ls)
                            (223564 dzdfc.vqq)
                            (dir ffpzc)
                            (dir gwhfgwf)
                            (dir nbjtqnng)
                            (dir snjntth)
                            ($ cd ffpzc)
                            ($ ls)
                            (42813 qwwmw.nmt)
                            ($ cd ..)
                            ($ cd gwhfgwf)
                            ($ ls)
                            (59918 jvfv.mpm)
                            (dir mjl)
                            (211039 pcwl)
                            ($ cd mjl)
                            ($ ls)
                            (13004 pgjb.tpq)
                            (195995 tms.fjz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd nbjtqnng)
                            ($ ls)
                            (107058 dzdfc.vqq)
                            (dir ldrsd)
                            (111631 vqgsglwq)
                            (104599 wbzmdljw.tjq)
                            (155747 wjlmgq)
                            ($ cd ldrsd)
                            ($ ls)
                            (107439 jvjm)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (242680 fgrt.gng)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd qhjv)
                            ($ ls)
                            (dir bmnm)
                            (68453 hjjpdgn.hwl)
                            (dir sjlbj)
                            (dir vqnrj)
                            ($ cd bmnm)
                            ($ ls)
                            (1238 vqgsglwq)
                            ($ cd ..)
                            ($ cd sjlbj)
                            ($ ls)
                            (44239 wzzbtmrz.gml)
                            ($ cd ..)
                            ($ cd vqnrj)
                            ($ ls)
                            (3286 bsltmjz.qlc)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (130833 blm.wmt)
                            (dir snjntth)
                            (dir tcnmbcgg)
                            (218869 wjlmgq)
                            ($ cd snjntth)
                            ($ ls)
                            (dir snmrdfbt)
                            ($ cd snmrdfbt)
                            ($ ls)
                            (281025 bzrsds.lfg)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd tcnmbcgg)
                            ($ ls)
                            (194998 fcsjl)
                            (dir qdrmpqgn)
                            (dir rzqd)
                            (dir tcsds)
                            ($ cd qdrmpqgn)
                            ($ ls)
                            (165713 qmzgt.tnc)
                            ($ cd ..)
                            ($ cd rzqd)
                            ($ ls)
                            (dir cwhnmlv)
                            (57819 fcsjl)
                            (246864 pjnzdvd.gjm)
                            ($ cd cwhnmlv)
                            ($ ls)
                            (287539 mmnvqn.hqb)
                            (215636 pbnjt.zbn)
                            (124638 sqd)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd tcsds)
                            ($ ls)
                            (78812 gfmgb.wqj)
                            (218987 hnhfvz.dln)
                            (209640 mzzhqlq.zqp)
                            (102492 nml.ppg)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd szn)
                            ($ ls)
                            (dir fcsjl)
                            (dir snjntth)
                            (dir zjbp)
                            ($ cd fcsjl)
                            ($ ls)
                            (158019 jsv.pmz)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (229510 dfvpvp)
                            (191061 fgplbptq.jlt)
                            (dir lfb)
                            (234911 lfsrwr.wcb)
                            (dir lrfcgzl)
                            (48031 stbbw)
                            (219691 vqgsglwq)
                            (dir zshh)
                            ($ cd lfb)
                            ($ ls)
                            (dir btj)
                            (99591 dhrjbvvg.gwm)
                            (137224 dzdfc.vqq)
                            (201972 jtzmqsvj.wnd)
                            (9704 mmnvqn.hqb)
                            (dir pwg)
                            (200308 snjntth.css)
                            (dir wcmhcfm)
                            (dir zwhvmln)
                            ($ cd btj)
                            ($ ls)
                            (dir rnbzdfgn)
                            (51799 wdhsm)
                            (dir wvf)
                            ($ cd rnbzdfgn)
                            ($ ls)
                            (117095 bsltmjz.tlv)
                            ($ cd ..)
                            ($ cd wvf)
                            ($ ls)
                            (dir ffpzc)
                            (dir ncbmgpsc)
                            (dir wtwrmjnt)
                            ($ cd ffpzc)
                            ($ ls)
                            (249919 lsth.fmf)
                            ($ cd ..)
                            ($ cd ncbmgpsc)
                            ($ ls)
                            (147899 dzdfc.vqq)
                            ($ cd ..)
                            ($ cd wtwrmjnt)
                            ($ ls)
                            (252366 pvpdv.jwz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd pwg)
                            ($ ls)
                            (280845 fcsjl.fjz)
                            (44300 sgwz.cdz)
                            (dir snjntth)
                            (229605 vqgsglwq)
                            ($ cd snjntth)
                            ($ ls)
                            (2053 pflvsnzs)
                            (143522 sgwz.cdz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd wcmhcfm)
                            ($ ls)
                            (229329 qsznhwlw.vjg)
                            ($ cd ..)
                            ($ cd zwhvmln)
                            ($ ls)
                            (dir ffpzc)
                            (dir tjjzbf)
                            (dir wzcq)
                            ($ cd ffpzc)
                            ($ ls)
                            (dir ncnj)
                            (37497 vqgsglwq)
                            ($ cd ncnj)
                            ($ ls)
                            (40920 htbjhjq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd tjjzbf)
                            ($ ls)
                            (47522 mczn.spd)
                            ($ cd ..)
                            ($ cd wzcq)
                            ($ ls)
                            (56662 ffpzc.vwp)
                            (dir snjntth)
                            ($ cd snjntth)
                            ($ ls)
                            (117276 wjlmgq)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd lrfcgzl)
                            ($ ls)
                            (267485 rsjmpph.qqz)
                            ($ cd ..)
                            ($ cd zshh)
                            ($ ls)
                            (dir ffpzc)
                            (dir gmn)
                            (dir snjntth)
                            (150048 tgtlh)
                            (32020 thfr)
                            (72152 vqgsglwq)
                            ($ cd ffpzc)
                            ($ ls)
                            (dir snjntth)
                            ($ cd snjntth)
                            ($ ls)
                            (224945 dpfpz)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd gmn)
                            ($ ls)
                            (238996 sgwz.cdz)
                            ($ cd ..)
                            ($ cd snjntth)
                            ($ ls)
                            (86775 dzdfc.vqq)
                            (19560 vshcmjj)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd ..)
                            ($ cd zjbp)
                            ($ ls)
                            (dir fcsjl)
                            (41522 nlvpb.fpf)
                            (dir nmtjtd)
                            ($ cd fcsjl)
                            ($ ls)
                            (276802 fcsjl.psm)
                            (197934 sgwz.cdz)
                            ($ cd ..)
                            ($ cd nmtjtd)
                            ($ ls)
                            (47477 dvqmqlgw.ths)
                            (51081 vqgsglwq)
                            ))

#+END_SRC


#+RESULTS: 2022-day7-input
: aoc22/day7input

#+NAME: 2022-day7-solution
#+BEGIN_SRC emacs-lisp :session "day7" :val day7=2022-day7-input
;;; Code:
(require 'cl-lib)
(defun aoc22/day7-part1 (commands)
  "Parse COMMANDS and return the sum of candidate dirs to delete.
I need to find all dirs with size at most 100000, and return the
sum of these sizes.  Directories that include directories also
get the size of the included directories, so I have to update the
size of the current directory and the size of all parent
directories."
  (let ((dirs (make-hash-table :test 'equal))
        (parents '("")))
    (dolist (entry commands)
      (let ((type (car entry)))
        (cond
         ((eq type '$)
          (let ((command (cadr entry)))
            (if (eq command 'cd)
                (let ((directory (symbol-name (caddr entry))))
                  (if (equal directory "..")
                      (pop parents)
                    (push (concat (car parents) "/" directory) parents))))))
         ((numberp type)
          (dolist (dire parents)
            (let ((current (gethash dire dirs 0)))
              (puthash dire (+ current type) dirs)))))))
    (let ((sum 0))
      (dolist (value (hash-table-values dirs))
        (if (<= value 100000)
            (setq sum (+ sum value))))
      sum)))

(defun aoc22/day7-part2 (commands)
  "Parse COMMANDS, create the dirs and find the smallest to delete.
We need the smallest dir that we can delete, that will free
enough space to reach 70000000."
  (let ((dirs (make-hash-table :test 'equal))
        (parents '("")))
    (dolist (entry commands)
      (let ((type (car entry)))
        (cond
         ((eq type '$)
          (let ((command (cadr entry)))
            (if (eq command 'cd)
                (let ((directory (symbol-name (caddr entry))))
                  (if (equal directory "..")
                      (pop parents)
                    (push (concat (car parents) "/" directory) parents))))))
         ((numberp type)
          (dolist (dire parents)
            (let ((current (gethash dire dirs 0)))
              (puthash dire (+ current type) dirs)))))))
    (let* ((values (sort (hash-table-values dirs) '<))
           (dirs-size (nth (1- (length values)) values))
           (unused (- 70000000 dirs-size))
           (freeup (- 30000000 unused)))
      (cl-dolist (directory values)
        (if (> directory freeup)
            (cl-return directory))))))

;;; Helper functions:

;;; Results vector

(vector (aoc22/day7-part1 aoc22/day7test)
        (aoc22/day7-part1 aoc22/day7input)
        (aoc22/day7-part2 aoc22/day7test)
        (aoc22/day7-part2 aoc22/day7input))


#+END_SRC

#+RESULTS: 2022-day7-solution
: [95437 1432936 24933642 272298]
** day 8
#+NAME: 2022-day8-input
#+BEGIN_SRC emacs-lisp :session "day8"
(defconst aoc22/day8test [[3 0 3 7 3]
                          [2 5 5 1 2]
                          [6 5 3 3 2]
                          [3 3 5 4 9]
                          [3 5 3 9 0]])

(defconst aoc22/day8input
  [[1 0 0 0 2 1 1 1 2 1 1 0 2 0 2 3 1 2 0 2 2 0 1 0 3 3 0 2 0 4 3 1 2 0 4 0 0 0 0 1 1 1 0 1 2 1 4 3 4 4 5 1 4 2 2 2 1 4 1 4 2 4 0 2 2 0 2 4 0 4 4 2 3 3 2 0 4 0 0 1 0 3 2 0 1 3 3 1 2 0 2 3 0 0 1 1 0 2 0]
   [1 1 1 1 1 0 2 0 1 3 3 2 3 2 3 2 1 0 2 1 1 1 4 3 1 2 3 2 1 4 3 2 1 3 4 3 3 3 2 1 2 4 2 1 1 4 1 3 1 1 5 5 1 4 1 5 5 1 1 5 5 1 1 0 3 3 4 2 1 0 0 1 2 2 2 1 0 1 2 0 4 3 3 0 0 0 1 3 0 0 3 3 3 0 1 1 0 1 0]
   [2 2 2 1 0 0 1 2 3 3 0 0 2 3 1 2 3 0 1 2 2 2 0 3 4 3 2 3 1 0 2 2 4 4 4 1 5 5 1 4 3 4 2 3 1 3 5 2 1 1 2 5 3 2 3 5 4 2 5 2 2 4 4 3 3 4 4 1 0 0 4 2 2 1 2 4 4 1 2 3 3 2 4 3 2 2 0 1 0 2 0 3 3 1 1 0 0 2 0]
   [2 1 2 2 1 0 3 1 1 3 1 0 1 0 2 3 3 4 3 2 1 2 4 3 1 0 4 1 3 3 0 1 2 5 3 5 1 4 4 1 5 1 5 3 2 5 5 5 1 5 5 3 4 1 3 2 5 3 5 2 5 1 2 5 4 4 4 5 3 4 0 2 4 0 0 4 1 1 3 4 0 2 0 2 1 3 3 2 3 1 0 0 0 1 0 2 0 2 0]
   [1 1 2 0 0 2 1 0 2 3 2 2 0 0 1 0 0 3 3 0 4 2 3 3 3 0 2 0 4 0 1 2 4 5 4 4 4 1 1 2 2 5 5 2 3 5 3 3 5 3 4 2 3 5 1 1 3 3 5 3 5 2 2 2 3 3 5 3 5 5 5 0 4 3 2 2 3 2 2 0 2 4 0 1 2 2 1 0 2 2 1 1 0 3 1 1 1 1 0]
   [1 1 2 1 0 2 1 3 1 3 3 1 2 0 1 4 3 2 3 2 0 3 1 2 2 3 3 1 2 4 4 3 4 2 3 2 5 4 4 1 4 4 2 3 3 2 4 1 1 2 3 3 3 4 1 1 2 2 3 2 5 3 1 5 2 1 5 4 2 5 5 1 3 3 2 4 3 4 2 2 4 2 1 1 2 3 4 1 3 3 1 3 2 3 3 0 3 0 0]
   [2 0 1 2 1 2 2 3 1 0 0 1 3 1 4 0 0 1 2 3 2 0 2 0 0 1 1 5 2 1 5 4 3 4 4 5 1 5 2 2 5 1 4 1 3 2 2 5 3 3 4 1 5 1 1 5 5 3 3 2 4 4 3 1 4 4 3 1 5 4 3 3 4 4 4 3 2 1 4 0 3 0 2 2 3 0 1 1 1 0 2 3 1 1 3 3 3 2 0]
   [2 2 2 2 0 0 2 1 2 0 1 2 2 3 4 0 2 1 4 4 0 3 2 3 5 2 2 2 5 1 2 2 2 1 1 4 2 5 5 4 3 5 3 2 1 2 4 5 4 6 3 6 5 2 6 3 4 4 5 4 4 4 5 4 4 1 3 1 3 3 3 1 3 3 4 2 2 1 4 0 3 3 1 4 1 2 1 3 4 0 3 2 2 2 0 1 3 2 3]
   [0 1 1 1 0 1 3 1 3 0 3 0 1 2 4 0 3 4 0 1 1 0 5 3 1 3 2 4 1 1 3 5 2 3 1 3 1 3 5 4 3 2 2 6 5 2 2 3 5 6 4 6 4 4 5 6 3 4 3 5 5 4 1 3 1 4 3 1 4 4 5 3 5 1 1 3 5 5 1 3 2 4 4 1 2 4 2 2 2 0 2 1 2 3 0 1 2 1 0]
   [3 3 0 1 2 0 3 2 0 0 0 4 4 1 4 2 2 4 0 0 1 2 2 5 3 4 2 3 2 5 1 3 3 5 4 1 1 2 5 6 2 2 6 6 5 5 6 3 2 6 3 4 4 4 4 3 4 2 3 2 6 3 5 4 4 2 1 2 3 4 2 3 5 1 4 2 2 4 5 1 3 3 2 1 3 2 4 3 2 4 3 2 1 2 2 1 2 0 1]
   [2 3 2 2 0 1 0 0 2 2 0 3 1 4 2 0 1 3 2 1 3 5 4 1 4 1 5 5 2 1 3 3 1 1 3 6 2 5 2 3 6 5 3 4 2 5 4 4 5 5 2 3 6 5 4 4 2 6 2 5 3 2 2 5 5 5 5 1 5 2 3 4 3 1 5 2 5 1 3 3 4 1 4 3 1 1 0 1 1 4 4 3 3 0 1 1 3 3 0]
   [2 3 1 0 3 2 0 3 2 1 3 3 2 0 3 3 3 0 1 3 5 1 3 4 5 2 4 1 1 3 3 1 2 3 5 3 4 6 6 3 2 2 5 4 3 6 4 3 5 4 3 3 6 4 6 6 5 6 3 6 3 6 5 3 4 4 6 4 5 1 2 3 2 1 4 2 5 5 4 3 3 4 2 3 4 2 0 4 4 3 4 1 1 1 0 2 1 1 3]
   [3 2 3 2 1 0 1 3 4 4 1 4 1 3 1 3 2 4 3 2 5 5 5 4 2 4 5 2 2 4 6 5 3 4 3 5 3 6 5 4 5 3 3 6 4 4 5 6 2 4 3 2 4 3 4 2 6 5 2 6 4 3 2 4 6 2 3 4 4 5 5 1 4 4 2 4 3 3 2 2 4 5 5 4 1 1 0 3 4 2 3 4 3 1 0 3 0 0 2]
   [2 3 2 2 1 1 3 0 4 4 0 2 4 3 2 4 5 4 5 3 3 4 3 5 2 5 2 1 4 5 6 6 2 6 6 5 5 3 2 3 5 5 6 3 6 3 2 6 4 2 3 5 6 3 4 2 3 4 3 3 5 5 5 2 3 6 5 6 5 4 5 5 3 4 5 4 2 1 4 5 3 3 1 3 3 0 1 2 4 3 0 3 0 2 0 1 0 3 3]
   [3 0 1 3 3 4 4 0 4 4 4 4 1 1 3 4 3 2 4 4 4 1 5 4 5 2 6 6 2 2 5 6 5 5 3 4 6 2 2 4 5 3 4 5 2 4 6 5 6 5 6 3 7 3 3 6 3 3 4 6 2 3 6 3 5 2 2 6 4 4 3 2 2 4 2 2 5 5 5 1 1 4 4 1 5 3 1 3 0 1 2 0 1 4 3 0 3 1 0]
   [0 2 1 0 3 1 4 0 2 0 1 4 3 2 2 5 1 4 3 3 1 5 5 4 3 4 2 4 2 3 5 2 2 2 4 4 6 4 3 2 4 5 3 4 7 4 6 3 5 3 7 3 5 3 5 4 6 7 3 3 3 4 4 3 5 3 6 6 5 2 6 4 6 3 2 6 5 1 2 5 5 4 2 2 4 4 5 2 0 1 2 4 1 3 2 4 2 3 1]
   [3 1 1 3 4 1 4 3 3 4 2 3 1 4 3 5 2 5 3 3 2 4 2 4 2 4 3 2 2 6 6 5 3 3 2 4 5 5 4 4 5 5 4 4 4 3 3 7 6 6 4 3 7 5 7 4 6 5 6 6 6 4 4 3 6 3 3 4 2 2 5 4 5 2 4 3 6 5 5 4 4 4 5 4 5 1 2 5 3 3 4 1 2 2 2 1 0 0 3]
   [1 0 0 1 4 1 0 4 4 4 2 1 1 3 2 3 3 1 5 2 4 1 4 6 4 3 2 6 2 6 6 2 6 2 2 2 7 4 6 3 7 7 3 4 4 7 7 5 3 3 7 6 7 5 4 7 4 3 7 4 6 6 7 7 3 6 3 4 6 5 2 6 3 4 5 5 2 5 5 3 1 1 1 2 5 1 5 5 2 4 2 2 0 3 3 2 3 4 2]
   [1 0 3 1 0 0 4 2 4 0 1 3 3 5 5 2 4 3 4 2 3 5 3 2 3 6 3 6 5 3 5 6 3 3 5 5 7 6 3 6 4 6 6 6 7 3 4 5 6 5 7 7 5 4 3 6 6 3 7 4 6 4 6 5 3 5 6 2 6 6 4 2 3 2 6 3 6 6 6 5 5 3 3 1 5 5 2 5 1 1 4 1 3 2 3 2 0 3 3]
   [0 1 0 4 1 1 4 0 2 3 2 5 2 4 2 2 1 2 3 3 2 6 6 2 6 6 2 5 6 6 3 6 5 3 6 3 7 3 3 4 4 4 4 3 4 3 4 4 4 5 4 7 3 6 6 3 5 4 3 5 5 6 5 5 4 4 4 3 6 4 4 5 4 3 2 5 6 2 2 2 3 3 5 2 2 5 5 1 2 5 4 3 2 2 1 4 4 1 3]
   [3 2 1 3 1 3 0 2 3 2 3 1 1 4 1 2 3 2 5 3 6 4 4 2 2 6 3 5 3 4 7 7 3 7 7 5 5 3 7 4 5 4 3 4 6 4 5 4 6 6 3 6 5 6 6 5 6 3 6 5 3 6 4 5 5 7 3 3 4 3 6 3 3 6 2 4 4 6 4 6 3 5 3 1 5 5 3 4 4 5 1 0 1 2 1 4 4 1 4]
   [2 4 0 0 1 4 2 3 3 4 4 5 3 2 5 4 2 3 4 5 5 4 6 2 5 5 3 4 2 5 3 6 4 6 5 3 6 5 3 6 4 5 3 3 3 4 3 6 5 5 6 4 5 5 4 7 4 7 4 6 6 3 3 7 6 7 7 5 6 6 4 4 2 5 6 6 2 5 6 4 5 2 6 1 1 1 1 5 5 1 1 3 4 4 0 1 1 0 2]
   [1 4 1 2 4 3 1 0 3 1 2 1 4 4 1 4 5 2 4 5 3 3 2 2 3 3 4 2 7 4 3 5 6 6 3 4 4 5 3 6 7 4 6 5 4 4 7 5 7 7 4 7 7 6 6 6 5 7 6 6 7 5 5 3 3 5 4 7 3 6 3 7 6 5 5 3 5 5 3 2 4 5 5 2 4 4 2 4 4 1 5 5 5 4 0 4 4 2 2]
   [3 2 2 0 3 2 1 2 2 4 5 4 4 2 3 4 4 6 3 2 6 6 2 4 6 5 2 6 5 7 5 5 5 7 7 5 7 4 3 5 5 8 4 6 7 8 7 4 7 7 7 8 6 4 8 8 7 7 6 7 5 5 6 3 3 3 6 3 5 6 4 5 3 4 2 4 6 6 2 3 2 5 4 2 4 5 2 3 4 4 2 2 3 0 2 1 0 3 0]
   [3 4 1 0 1 2 0 3 5 4 4 2 5 4 5 2 6 6 6 6 6 5 4 2 4 5 5 5 6 3 5 3 3 5 7 7 7 3 5 8 8 5 8 6 6 7 8 4 8 6 8 6 8 4 4 8 6 8 6 8 8 6 4 6 5 7 3 6 7 5 7 4 5 5 7 5 4 3 6 3 4 6 3 4 4 4 5 4 3 2 3 5 2 1 0 1 3 3 3]
   [0 2 0 3 3 2 1 3 3 5 4 5 2 2 5 6 4 6 6 5 3 6 4 5 4 5 3 3 4 7 7 3 7 7 5 6 7 5 4 5 6 7 8 8 6 7 7 8 5 7 7 4 6 8 6 4 4 4 7 6 7 7 7 4 7 5 5 3 7 4 5 4 4 5 4 7 3 4 3 5 4 4 6 6 6 4 4 2 2 2 1 4 2 3 4 3 0 1 4]
   [4 4 3 3 1 2 4 2 5 1 4 4 1 2 3 2 3 5 5 6 4 3 2 5 3 6 3 4 3 4 3 7 7 4 8 6 6 8 5 5 8 8 4 8 4 4 8 8 4 5 7 8 8 8 7 4 8 8 5 4 7 5 6 6 6 8 6 4 6 7 4 5 4 6 5 3 6 6 6 3 5 4 4 5 2 2 6 1 4 3 5 3 5 3 5 0 4 0 3]
   [4 0 1 0 1 1 3 4 3 5 4 4 4 5 5 4 6 5 6 4 5 2 3 4 7 7 3 7 5 7 5 6 7 8 5 7 7 8 6 8 5 8 7 4 4 6 6 7 8 4 7 8 8 7 6 7 8 8 6 5 6 8 4 5 5 7 6 5 7 6 7 3 3 3 6 7 6 5 3 5 3 2 5 2 2 5 4 1 2 4 5 3 5 1 4 4 3 0 1]
   [2 3 1 0 2 3 1 1 1 5 4 1 2 3 2 6 4 6 6 5 4 3 6 4 6 7 6 6 5 5 5 5 4 4 7 8 4 4 8 8 8 7 4 4 7 7 8 8 6 5 6 5 8 6 8 5 8 6 8 6 8 7 4 5 5 5 5 4 4 7 5 6 3 5 5 3 5 5 4 2 5 6 6 3 6 3 4 4 4 5 4 4 4 2 3 1 0 4 1]
   [4 4 0 4 1 4 5 1 1 2 3 2 1 6 3 3 3 5 5 2 4 7 6 3 4 5 4 7 4 3 3 6 6 6 7 6 6 5 6 7 7 8 4 4 5 5 9 7 6 6 9 9 6 9 7 5 5 4 4 6 5 7 8 8 8 5 7 8 5 4 7 7 4 3 3 5 6 5 3 6 6 4 6 4 4 6 2 4 1 1 3 1 4 1 2 1 2 1 3]
   [4 2 3 1 3 3 1 1 5 3 1 1 2 4 2 2 3 2 2 2 6 3 3 4 3 5 6 6 7 6 5 7 7 5 4 6 8 6 7 4 4 5 7 9 9 8 6 8 8 6 6 9 5 8 5 5 6 6 7 7 6 4 4 5 6 4 8 5 8 5 7 3 5 3 7 4 5 5 6 5 3 3 5 5 2 2 6 4 4 5 1 5 5 2 3 3 3 0 1]
   [2 0 3 3 1 2 2 4 5 1 3 1 4 6 2 2 2 2 5 5 4 7 4 6 6 4 6 7 4 6 5 6 7 7 8 8 7 5 7 6 9 8 7 5 9 7 5 9 5 8 8 9 9 7 6 5 6 9 5 7 7 8 5 7 8 8 8 5 6 4 7 5 6 5 3 6 4 4 6 3 3 4 6 4 5 5 4 3 5 5 1 2 5 4 4 3 5 0 3]
   [2 3 2 5 1 5 1 1 4 5 2 5 3 3 5 6 5 4 4 5 7 5 4 3 4 4 3 5 5 5 5 6 5 8 6 8 7 8 6 5 7 6 5 9 5 8 7 8 5 7 5 8 7 6 5 9 8 9 6 6 8 5 8 5 4 7 6 6 6 8 4 6 4 5 5 3 7 3 7 6 5 7 4 5 4 2 4 4 4 4 1 2 4 4 5 3 5 2 1]
   [2 2 2 3 3 5 4 2 3 1 4 6 2 4 5 5 5 3 6 4 4 5 5 4 7 5 7 7 4 8 8 4 6 8 6 7 4 6 7 9 7 9 8 9 5 5 6 8 9 7 6 5 7 8 9 6 5 9 5 5 8 7 7 9 8 5 8 8 5 4 7 8 8 5 3 3 4 4 5 7 5 3 5 6 2 2 5 4 3 2 3 4 2 2 5 5 4 3 3]
   [1 0 1 5 4 2 4 1 4 3 4 5 6 4 2 5 2 3 3 5 3 5 6 7 5 6 5 7 7 4 6 8 7 6 6 8 9 9 6 5 8 6 8 5 7 8 5 7 6 6 7 8 7 8 7 8 6 8 7 9 9 8 5 7 9 8 8 7 5 7 6 8 5 4 7 7 4 5 6 4 3 4 5 6 5 6 4 2 6 6 3 1 3 3 3 2 2 2 4]
   [3 0 1 1 4 4 3 4 4 4 6 2 6 6 3 4 3 6 3 3 7 5 3 6 3 4 5 8 4 5 8 5 6 8 5 8 7 5 7 8 7 5 7 7 7 7 6 8 9 6 6 7 8 7 9 7 9 5 7 7 7 6 7 8 7 6 4 4 8 6 4 6 6 5 4 4 6 5 3 3 3 6 4 6 3 2 6 5 6 6 3 3 2 3 5 2 1 4 3]
   [4 2 1 5 2 4 3 5 1 2 3 2 4 6 5 4 3 4 6 5 4 5 7 6 5 6 5 7 6 7 4 4 6 5 7 5 6 6 6 7 5 5 9 6 8 6 8 7 9 8 6 9 6 9 6 7 5 6 7 6 8 7 5 5 6 9 8 4 6 4 8 8 6 7 6 7 5 4 7 5 3 3 5 7 4 4 2 3 3 2 4 4 2 4 3 3 4 1 1]
   [4 1 3 3 2 5 2 4 2 3 3 3 4 5 4 4 2 4 6 5 6 3 3 4 6 6 5 5 5 8 7 5 4 6 5 7 8 8 7 8 6 8 8 8 8 7 8 8 6 9 6 8 7 7 9 8 6 5 5 9 7 8 6 6 8 9 5 8 7 4 5 5 8 6 4 4 6 5 3 4 3 7 7 5 6 6 2 4 5 2 6 3 2 4 5 1 4 3 3]
   [1 5 4 2 4 4 5 4 3 4 4 2 4 6 4 6 7 4 6 3 3 3 4 6 6 5 7 8 5 6 8 6 8 9 9 7 8 7 7 9 8 5 6 9 8 8 7 7 8 6 7 8 7 6 9 6 6 9 9 7 8 5 9 9 5 7 8 7 9 6 4 6 6 6 4 8 4 4 3 4 3 3 6 4 3 2 3 3 2 2 4 4 3 5 2 2 4 3 5]
   [4 1 3 1 1 2 3 2 2 3 2 2 2 3 5 6 7 5 5 4 7 3 4 5 5 4 7 4 7 4 8 5 9 5 8 9 6 5 8 5 9 8 7 9 6 8 6 6 6 6 9 7 6 6 6 9 9 9 7 8 5 8 9 7 8 5 8 6 6 4 5 4 7 5 7 7 7 5 4 7 7 6 6 4 5 2 3 4 3 3 3 3 3 4 3 4 4 4 2]
   [4 2 4 3 3 3 1 2 2 4 3 4 6 2 6 4 5 6 7 7 7 6 3 5 7 6 8 5 7 8 6 8 6 8 6 8 7 5 9 6 9 6 6 8 7 6 8 8 9 6 7 9 7 7 6 8 8 9 9 6 6 7 8 7 9 5 6 8 5 5 8 6 5 5 7 4 7 5 5 5 4 4 5 4 6 5 2 2 3 5 5 6 6 3 3 3 1 2 3]
   [4 5 5 2 1 1 2 2 5 2 6 5 4 2 4 4 7 7 3 4 7 4 4 4 6 8 5 5 4 4 6 9 9 8 8 7 8 7 6 9 7 7 8 9 7 8 7 6 9 7 8 7 7 8 9 9 8 9 8 8 6 8 5 7 9 7 9 9 8 6 4 7 4 5 8 8 5 6 7 7 3 6 3 4 5 2 2 5 2 5 4 4 3 1 1 4 4 5 5]
   [2 1 5 2 5 4 1 4 6 3 6 6 3 6 3 7 4 7 4 7 3 7 5 5 8 8 7 4 4 5 8 7 7 8 6 8 6 5 6 7 8 9 9 6 6 7 6 6 6 7 6 8 9 8 7 9 9 6 8 8 7 8 6 5 6 7 5 6 9 8 5 5 5 7 4 6 8 4 6 7 3 7 3 3 5 3 3 2 4 3 6 2 6 1 4 5 2 5 4]
   [2 3 2 2 1 4 3 3 6 4 3 5 3 4 4 4 6 4 3 3 7 3 6 5 8 5 5 7 4 5 6 6 5 7 6 7 9 6 8 8 8 8 6 6 9 9 6 9 7 8 8 8 9 8 6 6 8 7 9 7 7 6 7 7 7 7 8 9 9 5 5 4 7 5 7 8 6 5 6 4 4 6 3 5 6 5 5 5 5 2 3 5 2 2 3 5 2 4 1]
   [4 3 1 4 4 5 5 1 3 2 4 2 6 4 2 6 3 4 3 7 3 3 8 7 4 4 4 4 6 6 6 5 6 5 8 5 6 8 6 7 7 6 9 7 9 7 8 7 9 9 8 7 7 8 7 7 8 8 7 6 6 8 8 7 9 7 7 7 6 9 8 7 5 7 5 7 8 5 5 4 7 4 3 4 6 3 6 4 3 6 2 5 2 1 3 5 4 2 5]
   [3 4 1 2 5 4 1 3 5 4 5 3 6 2 5 7 6 4 5 5 5 4 5 4 7 8 4 5 5 8 6 9 7 7 5 8 9 9 6 7 6 8 7 8 9 8 9 8 8 7 9 8 8 7 9 7 9 7 7 6 9 8 8 6 6 7 8 9 5 8 6 6 4 6 7 5 4 4 5 3 7 4 6 7 3 5 2 4 6 5 5 5 4 2 3 1 3 4 1]
   [3 5 3 5 1 1 3 5 6 5 2 2 2 3 2 7 5 4 3 3 3 6 6 5 8 4 6 8 7 5 7 5 6 8 8 5 5 9 7 9 7 9 9 8 7 9 7 9 7 9 7 9 9 8 7 8 8 8 6 7 8 9 8 7 5 5 9 6 6 9 6 6 7 4 7 7 7 7 8 6 3 3 3 5 4 6 5 6 5 3 6 2 2 3 1 2 5 2 1]
   [3 4 2 1 3 1 4 2 5 4 5 5 2 5 2 5 4 7 3 7 4 5 5 7 4 5 4 6 7 6 8 8 9 5 8 5 7 6 9 8 9 9 9 7 9 8 7 7 9 8 8 8 7 8 7 8 7 6 7 8 9 9 8 6 6 6 8 5 7 6 7 6 4 7 8 6 5 4 8 5 7 5 4 4 5 5 3 3 4 4 3 2 4 5 4 5 5 3 3]
   [4 2 3 5 1 4 5 5 4 6 2 2 2 6 5 3 6 4 5 3 5 7 5 8 6 5 6 7 5 7 7 7 9 5 8 6 6 7 7 8 6 8 6 6 8 8 9 7 7 8 9 7 8 9 8 8 8 8 8 7 9 8 7 8 8 5 7 6 6 7 7 5 4 8 4 6 4 7 4 6 6 7 3 3 7 6 6 5 4 4 4 4 4 6 4 1 3 1 1]
   [4 4 3 2 2 3 3 3 5 5 6 2 4 6 7 6 7 4 6 4 4 6 8 4 7 8 5 4 5 9 6 7 5 7 9 7 8 7 7 7 9 8 7 8 7 8 9 9 8 7 9 8 8 8 9 9 7 7 9 9 6 7 7 6 9 8 7 9 9 5 5 7 5 6 7 6 5 7 7 4 4 5 6 4 5 7 5 4 5 5 5 6 4 2 2 1 3 2 4]
   [4 3 4 3 3 4 5 2 5 5 5 6 6 2 5 3 3 5 5 6 5 4 4 5 7 4 4 4 4 9 6 7 9 7 6 6 8 7 9 8 8 7 8 9 8 7 9 9 8 8 8 7 7 9 7 7 7 9 6 9 7 9 7 6 6 6 6 7 7 8 9 7 8 7 6 6 6 6 5 7 7 3 5 3 5 3 4 6 6 5 4 4 4 6 3 3 5 2 5]
   [2 5 4 4 5 2 2 2 6 4 3 6 6 5 3 7 3 5 3 6 5 6 7 6 8 4 5 6 6 6 6 6 7 6 5 9 8 6 9 8 7 8 9 9 8 7 7 7 9 8 9 7 8 9 7 8 7 8 6 8 6 8 9 9 9 9 9 9 5 8 5 6 8 6 4 6 7 5 4 6 5 3 5 6 7 7 3 2 5 4 4 5 5 6 4 3 4 3 3]
   [5 4 1 3 4 3 2 3 5 6 6 4 6 2 6 4 5 3 4 5 4 4 5 4 8 5 8 5 6 7 7 7 8 5 5 9 8 8 8 9 7 6 6 6 7 8 7 7 7 9 7 7 8 8 9 8 9 9 8 9 9 7 8 8 7 9 8 8 7 5 9 6 7 8 7 8 6 5 6 4 6 3 5 4 3 5 6 2 4 5 3 4 2 4 2 1 3 2 3]
   [5 2 2 4 1 2 2 2 6 6 2 2 3 2 5 7 5 3 7 4 4 5 4 5 5 5 6 8 5 5 7 6 6 9 8 5 6 8 7 7 6 8 9 7 9 7 9 7 8 9 7 7 9 9 9 8 7 6 9 8 9 8 9 8 9 7 7 7 9 6 9 6 7 6 5 7 5 6 5 4 4 6 3 4 6 7 2 5 5 5 4 5 3 3 5 3 2 1 3]
   [4 1 2 5 2 2 2 5 4 4 4 4 5 6 4 6 3 5 7 3 7 6 7 7 8 4 5 5 4 5 9 5 6 6 9 8 8 8 9 6 9 8 6 7 7 8 8 9 7 9 9 9 7 9 9 8 9 7 7 9 8 9 8 9 5 6 9 7 6 7 7 7 7 5 8 8 7 8 5 3 7 6 3 4 6 4 2 4 2 5 5 2 6 2 4 1 5 5 1]
   [4 5 4 2 2 2 1 3 6 2 6 3 2 2 2 7 6 5 6 5 5 7 7 5 6 4 7 7 7 9 5 6 8 8 6 6 5 7 7 8 8 6 9 7 6 8 8 8 9 8 7 9 8 9 8 7 7 8 6 9 6 7 8 9 7 5 5 8 5 6 9 7 8 4 8 4 7 6 4 5 5 5 5 7 5 4 5 3 5 4 6 3 5 3 5 1 4 4 2]
   [1 3 5 1 2 1 5 5 2 5 3 5 4 6 5 3 6 3 7 3 6 4 7 4 6 6 8 8 7 8 9 7 9 5 9 9 6 7 9 9 9 6 9 6 7 9 7 8 7 7 8 9 8 8 7 6 7 7 7 9 6 6 8 6 5 5 5 9 9 5 5 7 5 6 8 5 7 8 8 6 7 6 6 6 4 4 6 3 3 2 3 6 3 5 4 1 2 4 1]
   [4 4 3 1 2 1 4 2 5 5 5 5 3 3 5 7 7 4 6 6 3 6 4 8 7 5 4 6 8 7 7 6 8 6 6 8 7 7 9 9 9 8 7 7 9 8 8 6 6 7 7 8 6 6 7 9 7 8 6 8 8 9 6 5 9 8 9 7 7 9 7 5 7 4 4 5 7 7 7 5 7 4 6 6 7 4 4 2 5 2 4 2 6 3 1 3 2 3 2]
   [4 1 3 5 4 4 2 3 5 5 4 4 6 2 3 4 7 4 4 4 5 6 3 6 7 8 5 8 8 6 8 6 5 8 5 6 9 7 8 9 7 7 8 9 8 8 8 6 9 7 9 8 6 7 6 6 7 6 8 7 9 7 9 6 6 5 5 5 9 7 8 5 8 5 6 8 8 4 3 5 4 3 5 5 3 7 3 4 5 6 5 3 3 4 3 3 4 4 4]
   [1 3 1 5 1 3 4 5 5 3 2 3 4 3 3 4 5 3 3 6 5 5 7 5 4 4 5 4 6 8 7 7 6 6 6 5 9 7 5 6 6 7 7 6 7 6 7 9 6 6 6 6 6 6 6 7 6 6 9 9 7 9 5 8 8 9 8 7 8 8 5 5 6 7 7 7 8 4 3 7 5 6 7 7 7 2 6 2 3 5 2 2 6 3 2 2 4 2 5]
   [4 3 4 4 4 2 2 1 5 6 2 5 3 6 4 4 5 6 4 6 4 6 6 7 5 6 4 8 6 6 6 9 7 9 8 6 9 8 5 6 9 8 7 6 8 6 9 8 8 6 7 7 9 7 8 8 8 9 6 9 9 7 6 9 7 6 5 5 7 9 7 4 4 7 7 4 5 6 6 4 5 5 5 3 4 5 4 5 6 3 4 3 3 5 1 5 2 4 1]
   [4 5 3 5 3 1 2 1 5 6 4 4 6 2 3 5 4 7 4 6 5 3 7 6 4 6 8 6 4 5 8 4 5 5 8 8 9 5 5 5 5 6 7 9 6 6 8 9 6 6 7 7 9 6 9 6 6 6 7 9 7 9 8 8 9 7 5 8 9 8 4 5 5 4 7 8 5 5 3 5 3 7 5 7 6 6 2 5 5 6 3 4 2 4 4 1 5 3 2]
   [3 3 2 3 5 5 4 3 5 6 3 5 6 5 4 4 4 5 7 5 5 3 6 6 5 4 6 6 6 8 8 5 7 7 7 7 9 9 5 8 9 7 8 7 7 8 6 6 6 7 6 9 8 9 7 7 9 6 7 9 6 9 8 5 5 6 6 7 5 6 4 8 6 6 5 8 6 3 7 6 7 4 5 4 3 2 4 4 4 3 2 3 5 1 5 1 2 2 5]
   [2 1 3 5 3 4 3 1 3 2 5 4 2 3 2 5 6 4 5 7 6 5 3 5 4 4 4 5 4 4 7 6 4 8 9 8 5 6 8 8 7 5 8 5 6 6 7 6 9 9 9 8 6 7 8 6 7 6 5 7 5 5 7 9 8 9 7 6 8 5 4 7 6 8 4 4 4 5 7 3 6 3 5 5 4 2 3 2 4 4 3 2 4 4 1 3 5 4 3]
   [1 2 4 5 2 2 5 2 2 2 3 5 2 4 4 3 4 6 5 6 7 7 4 7 5 8 4 5 4 4 5 5 7 7 6 9 5 7 9 7 9 6 8 7 8 5 8 9 7 6 6 9 9 6 7 6 8 7 8 8 6 8 5 9 9 5 8 7 5 4 4 4 6 4 5 8 3 5 3 7 3 4 3 7 3 6 2 3 5 5 6 5 2 1 4 4 2 4 5]
   [4 4 2 4 1 4 3 3 2 4 6 2 6 4 5 4 6 4 4 5 7 3 7 6 6 4 7 5 8 5 8 4 8 8 4 8 9 6 5 5 7 7 6 6 5 8 5 5 8 5 7 8 8 5 6 9 8 7 6 8 7 9 8 6 9 6 5 7 5 5 4 6 6 7 4 4 7 5 5 7 3 6 4 6 5 6 6 2 2 2 3 1 4 1 1 4 4 4 5]
   [1 1 2 3 1 5 2 3 3 2 5 6 6 5 2 3 4 3 7 3 7 6 6 7 6 3 7 8 5 8 4 5 8 5 7 6 9 6 8 7 7 7 5 5 9 8 6 8 5 9 7 5 7 9 9 6 7 7 5 9 6 7 7 5 8 8 4 5 8 8 4 6 6 4 8 6 5 5 4 5 4 3 3 4 2 4 5 2 4 5 3 4 5 5 5 4 2 2 4]
   [1 3 0 2 2 4 4 2 2 1 1 2 5 4 6 6 5 4 4 6 5 4 6 4 3 6 3 7 6 4 4 5 7 4 4 6 5 7 9 8 8 5 7 9 5 8 5 7 5 8 6 5 7 9 7 8 9 7 7 9 8 8 8 5 6 6 4 7 8 8 6 6 8 6 6 7 4 3 3 5 5 3 3 5 2 2 6 2 6 4 2 1 2 5 3 5 3 2 2]
   [2 4 3 1 5 5 5 5 3 5 5 5 3 4 2 6 2 4 6 7 6 4 3 6 4 5 5 3 7 5 8 7 4 7 6 5 4 8 9 6 8 7 6 9 9 5 8 8 7 9 8 7 9 6 7 5 9 7 6 6 6 7 5 6 7 5 5 6 7 7 7 4 6 4 6 7 5 3 6 3 4 3 5 5 3 4 6 4 5 4 4 2 4 4 3 1 2 5 3]
   [3 1 3 4 4 2 3 1 3 4 2 3 3 2 2 5 3 5 3 2 5 3 7 5 3 7 7 3 4 4 6 8 7 6 5 8 4 5 7 5 7 6 6 9 9 7 7 6 8 5 6 7 7 6 7 8 7 5 9 9 7 7 4 4 7 4 6 7 7 5 7 5 3 3 7 7 4 3 3 3 4 4 2 2 2 3 3 4 2 3 4 3 1 4 2 1 2 1 1]
   [2 3 4 0 5 1 1 3 1 4 1 1 5 2 2 6 2 3 3 3 7 4 7 4 7 5 7 6 7 7 8 5 7 6 8 5 4 6 4 8 5 7 5 9 6 6 6 7 5 5 7 5 7 9 6 6 6 7 8 7 5 5 5 7 4 4 4 8 7 5 7 4 5 4 4 6 7 3 3 6 4 6 6 3 6 4 3 4 3 5 2 1 1 2 5 5 2 4 0]
   [4 3 4 3 1 4 1 3 4 4 2 2 5 2 4 3 2 2 4 4 3 7 4 7 3 3 7 6 3 3 6 5 8 5 7 4 4 4 4 4 6 8 8 4 5 5 9 9 7 9 7 8 8 8 8 6 7 4 5 6 4 8 7 6 7 6 7 4 4 7 5 4 3 3 6 4 7 3 6 5 6 3 5 2 2 3 5 3 4 4 4 1 1 2 4 2 1 1 0]
   [0 0 4 1 0 1 1 4 5 2 1 5 3 3 5 2 2 2 3 2 5 4 7 5 5 4 6 3 4 3 7 4 5 8 5 5 4 8 4 8 4 8 8 7 7 5 7 5 5 4 6 8 4 5 8 6 7 8 8 5 8 4 5 4 5 5 7 4 6 4 5 7 4 3 3 4 5 7 4 3 6 4 6 6 5 6 5 3 3 2 3 5 2 1 2 4 1 2 3]
   [2 3 3 4 4 1 4 3 4 1 4 4 1 1 2 5 6 4 6 2 4 6 4 5 5 4 4 6 4 6 5 5 7 5 5 7 6 5 5 6 6 7 8 4 5 4 4 6 6 7 7 6 7 5 5 8 8 7 8 4 8 6 6 6 4 5 4 7 5 3 4 3 6 4 3 5 7 4 5 5 2 2 4 3 6 5 6 5 2 3 4 4 4 5 3 4 0 3 0]
   [1 2 1 2 2 4 1 4 3 5 5 5 1 3 5 5 5 5 5 6 4 5 4 4 7 7 6 7 3 4 5 5 5 4 5 5 6 7 4 5 5 6 5 7 5 7 5 4 6 7 5 4 8 6 8 8 8 4 6 5 8 4 5 4 5 8 8 3 5 7 4 3 3 6 7 3 3 3 4 2 5 3 5 4 5 2 6 3 3 1 4 3 4 4 4 4 0 3 1]
   [4 2 1 2 4 4 4 2 2 3 4 4 3 2 1 4 4 6 3 6 4 6 3 4 2 5 7 3 6 6 4 3 3 4 4 5 7 4 7 8 8 5 5 7 7 7 7 4 6 6 4 5 4 6 5 6 5 6 4 7 5 7 8 7 6 7 3 3 3 4 4 6 7 4 6 3 5 6 4 4 2 2 4 3 4 3 3 4 1 1 4 1 5 2 1 0 4 3 0]
   [1 3 4 2 1 4 2 4 3 5 2 2 2 3 1 1 4 4 4 6 2 4 6 5 3 5 3 5 6 6 5 7 7 7 6 3 5 3 6 7 4 6 4 7 8 8 5 5 8 7 6 8 4 8 4 6 8 8 4 6 6 8 7 6 4 4 6 6 3 7 5 6 3 6 4 2 2 4 2 2 4 4 6 4 6 3 5 4 5 1 2 3 4 2 1 4 1 1 1]
   [1 4 1 1 3 2 2 0 3 4 2 1 2 1 5 2 1 3 2 3 5 4 6 4 2 2 4 6 6 3 6 6 6 4 3 3 5 3 4 6 7 8 8 6 5 5 6 6 5 5 4 8 8 7 4 5 8 7 8 4 5 7 5 7 4 3 3 7 3 3 3 5 3 3 6 4 6 4 6 6 2 2 5 6 4 2 5 1 2 3 3 2 1 4 3 4 0 1 4]
   [2 1 3 2 3 1 3 3 3 4 1 1 3 5 1 4 1 2 3 4 4 3 5 2 5 2 4 2 7 7 7 6 3 6 6 5 5 4 3 7 7 4 6 7 4 7 7 5 5 4 5 8 7 5 7 4 4 7 5 4 5 7 6 3 6 7 4 6 4 7 3 7 6 6 3 5 6 4 2 6 2 6 6 3 1 1 2 5 4 4 4 1 5 1 3 1 1 1 3]
   [3 1 0 3 2 0 3 1 2 4 4 4 2 4 5 3 3 2 3 5 3 4 4 3 5 5 5 3 4 4 5 3 4 4 5 6 4 5 7 4 5 6 3 6 4 7 5 3 6 5 7 4 7 3 4 4 7 4 3 5 5 4 3 3 6 4 6 4 6 3 6 4 2 6 4 4 2 5 3 3 6 6 3 5 3 3 5 3 5 4 2 2 3 2 3 3 2 3 1]
   [3 1 4 2 4 2 3 3 2 1 2 3 4 3 4 3 4 5 2 6 6 4 5 6 2 2 6 2 2 5 3 6 7 6 7 7 7 3 7 3 5 6 5 6 3 3 3 6 7 6 5 7 3 5 5 5 5 5 5 4 5 4 6 7 6 4 5 5 6 5 4 3 6 5 2 3 6 4 5 5 5 6 3 2 4 3 5 4 1 5 4 1 1 3 4 2 3 3 4]
   [2 2 0 1 4 4 4 1 0 2 3 1 4 3 3 5 3 1 5 4 6 2 3 2 4 2 4 6 2 5 3 3 6 5 6 6 3 7 3 3 7 6 4 7 4 6 7 6 4 5 4 6 4 7 6 6 5 6 6 6 4 3 7 4 5 5 7 6 6 3 2 3 3 5 5 3 4 5 5 6 3 4 2 1 3 4 5 4 2 2 4 4 4 4 1 3 1 1 2]
   [3 3 1 4 4 2 4 3 4 4 2 1 1 4 2 2 5 2 2 1 2 4 6 6 5 6 3 3 5 2 2 6 6 5 4 5 3 3 4 6 3 3 3 7 4 6 3 7 7 3 5 3 7 6 6 4 3 4 3 5 6 7 5 5 5 3 5 4 4 3 6 6 5 6 4 2 4 4 5 2 5 1 3 2 1 5 1 2 2 3 0 1 1 3 4 2 2 0 2]
   [2 0 3 3 3 4 2 1 1 3 4 4 3 2 2 3 3 3 5 4 2 4 3 3 6 5 4 4 3 4 6 5 5 3 3 5 6 3 3 7 3 4 4 7 5 6 6 4 7 5 6 7 4 7 7 6 6 3 7 5 6 5 5 4 5 6 2 2 5 6 2 2 2 2 5 3 3 3 3 4 3 3 2 4 2 1 5 5 2 1 2 0 0 0 0 1 4 0 1]
   [1 3 3 0 0 1 0 4 4 1 3 0 0 2 5 2 1 1 4 3 3 3 3 5 6 2 6 5 5 2 5 2 5 2 6 6 3 6 7 3 3 4 3 7 7 7 3 6 4 6 6 4 7 3 3 6 4 4 4 4 5 4 3 2 3 6 4 4 6 6 5 3 2 5 3 6 6 2 2 2 2 3 2 2 4 1 5 4 1 2 0 0 4 4 0 4 2 0 3]
   [1 0 2 3 3 1 0 3 1 2 0 1 2 2 5 1 3 5 4 4 3 4 2 4 2 4 6 5 5 3 3 6 5 3 4 6 6 6 4 5 3 6 3 5 3 3 6 7 4 3 4 5 4 6 4 7 3 7 4 3 3 3 4 3 5 6 4 5 4 6 5 4 5 5 2 2 3 3 1 4 5 5 3 4 3 4 5 2 3 1 1 1 3 2 1 4 1 0 2]
   [2 1 2 2 3 0 0 1 0 3 4 2 1 3 1 5 5 3 5 3 2 4 5 1 5 2 6 3 2 2 2 5 5 6 6 6 6 6 3 2 2 3 3 6 6 3 3 2 6 7 4 6 5 3 6 3 3 4 4 6 4 5 6 5 2 5 2 6 2 5 4 3 2 4 6 5 1 1 3 1 2 2 1 5 1 2 3 1 4 3 1 0 0 4 1 4 3 2 2]
   [2 3 2 1 0 1 0 4 4 2 4 3 4 4 1 1 3 3 1 5 4 1 5 1 5 2 3 5 4 2 3 3 6 6 5 5 4 6 4 5 6 3 3 2 5 4 4 4 4 3 6 3 2 3 6 4 6 5 3 4 5 2 6 5 4 2 2 4 5 5 4 2 6 1 3 5 5 2 5 3 1 3 2 1 4 4 1 4 0 4 2 1 1 2 2 0 2 3 1]
   [2 3 0 2 1 0 1 1 3 1 3 4 2 3 1 4 4 2 3 1 2 1 3 3 5 2 3 2 3 1 4 2 6 4 2 3 6 4 5 5 6 2 2 3 3 5 2 2 6 6 2 3 2 2 6 4 5 5 5 6 3 2 5 5 5 5 4 2 4 5 6 5 2 2 5 5 5 3 1 3 3 1 1 5 0 2 0 2 3 1 1 4 2 4 2 2 3 0 3]
   [1 1 2 1 2 2 1 3 2 4 3 4 1 2 3 4 2 4 4 5 4 5 5 2 4 3 5 5 4 1 1 1 6 5 3 6 4 3 6 3 5 4 3 4 3 3 6 4 3 6 6 2 5 3 4 5 2 3 4 3 2 4 5 5 2 6 4 3 6 5 4 3 2 5 3 4 3 5 1 2 2 4 2 3 0 4 1 0 2 2 1 3 0 1 3 1 0 3 2]
   [3 0 3 3 3 3 0 1 1 0 2 4 1 2 2 0 1 1 4 3 5 4 5 5 2 4 1 1 3 4 3 2 1 3 3 2 5 5 5 6 6 4 3 5 2 6 5 2 5 2 3 2 5 6 2 5 5 6 4 3 2 2 4 2 2 5 6 4 4 4 2 5 2 3 3 2 2 1 3 4 4 0 1 4 2 2 0 4 4 4 4 0 0 3 3 0 0 2 3]
   [1 0 3 3 0 2 2 3 1 3 1 0 3 0 1 3 1 3 2 3 4 3 5 4 1 4 1 3 1 2 3 2 3 4 3 4 5 3 2 2 4 6 5 2 6 6 3 6 3 2 2 5 4 2 3 6 4 3 3 6 3 4 2 5 3 3 3 3 1 4 4 5 5 5 4 2 5 3 3 1 4 0 3 0 2 1 4 2 2 3 4 2 3 2 1 1 0 0 3]
   [1 1 0 1 2 3 1 2 2 3 2 1 4 2 4 3 0 1 4 0 3 3 4 5 3 2 5 4 2 5 1 1 5 5 4 4 5 5 1 4 4 5 4 6 2 6 3 6 3 6 2 3 3 6 4 4 4 4 2 5 4 3 5 3 1 2 2 3 3 5 4 1 5 5 2 2 1 2 1 4 3 2 3 1 0 4 3 3 2 0 2 1 1 1 0 0 2 1 3]
   [2 0 2 2 1 1 3 1 2 2 1 0 4 0 2 0 2 0 0 3 3 4 1 0 4 3 2 3 2 4 4 3 1 2 5 3 1 4 4 3 2 5 5 2 3 2 3 5 4 6 3 6 2 5 3 3 2 4 5 1 1 3 1 5 2 1 4 1 4 4 1 4 3 3 3 3 2 2 2 1 1 1 4 4 3 4 4 2 3 0 2 2 1 3 2 3 1 0 2]
   [2 1 0 1 0 0 1 1 2 0 3 0 1 1 4 4 3 0 3 2 3 3 2 4 0 0 2 5 5 4 1 2 5 4 3 5 3 2 1 1 2 3 3 3 4 3 4 2 5 5 1 2 3 5 4 5 1 4 5 3 4 4 2 5 1 2 1 5 3 4 1 1 1 1 2 4 2 3 4 1 1 4 2 4 1 2 3 3 2 2 3 0 0 3 2 0 1 0 2]
   [2 0 2 2 2 0 2 0 3 2 2 0 0 3 2 0 0 0 0 0 4 3 1 4 4 3 4 4 2 3 3 3 1 2 5 3 2 4 5 5 3 4 4 5 4 1 2 3 4 2 5 1 1 4 4 2 3 5 5 3 1 3 3 4 1 4 1 5 1 2 3 2 2 4 0 3 0 4 4 1 4 1 0 1 4 0 2 3 1 1 3 3 0 0 0 2 0 2 0]
   [0 1 2 2 1 1 1 3 1 0 0 1 2 0 1 0 0 0 1 3 4 4 3 3 1 4 2 0 2 1 5 1 1 2 5 3 3 1 4 4 1 3 3 5 3 1 5 2 5 5 3 4 4 3 4 4 3 3 4 2 4 2 5 4 3 5 4 2 1 1 3 2 0 2 4 2 4 2 0 2 4 2 1 4 3 2 2 3 3 0 3 1 3 3 0 0 1 1 0]
   [2 0 0 0 1 1 1 1 1 0 2 2 1 2 0 3 2 2 1 4 3 3 4 2 0 4 0 4 4 3 3 3 4 5 5 2 2 3 5 4 3 5 2 1 1 5 1 1 2 3 1 4 5 1 4 5 2 2 2 2 2 5 2 2 2 2 1 1 3 2 1 4 2 3 3 0 0 2 4 1 3 4 2 4 1 1 2 0 0 1 2 1 1 1 3 0 1 1 2]
   [2 0 2 0 0 0 2 1 3 3 3 1 3 1 1 2 2 2 1 4 2 2 0 3 2 4 2 1 1 0 3 2 1 1 2 3 2 3 4 5 5 2 5 4 5 3 2 1 4 2 5 1 2 2 1 4 5 4 2 4 4 5 1 3 2 1 3 0 4 2 0 0 3 3 2 1 2 3 0 4 2 0 1 3 1 2 0 3 2 3 0 2 2 2 1 1 0 1 2]])

#+END_SRC

#+RESULTS: 2022-day8-input
: aoc22/day8input

#+NAME: 2022-day8-solution
#+BEGIN_SRC emacs-lisp :session "day8" :val x=2022-day8-input
;;; Code:
(require 'cl-lib)
(defun aoc22/day8-part1 (forest)
  "Takes FOREST and solve the puzzle.
To be replaced with actual docstring."
  (let* ((rows (length forest))
         (cols (length (aref forest 0)))
         (lit (+ (* cols 2) (- (* rows 2) 4))))
    ;; check visibility inside
    (dolist (row (number-sequence 1 (- rows 2)))
      (dolist (column (number-sequence 1 (- cols 2)))
        (let ((cell (aref (aref forest row) column)))
          (cl-block CHECK

            ;; check to the left
            (if (> cell (aref (aref forest row) (1- column)))
                (let ((leftcol (- column 2)))
                  (while (and (>= leftcol 0) (> cell (aref (aref forest row) leftcol)))
                    (setq leftcol (1- leftcol)))
                  (if (< leftcol 0)
                      (progn (cl-incf lit)
                             (cl-return-from CHECK)))))

            ;; check upwards
            (if (> cell (aref (aref forest (1- row)) column))
                (let ((uprow (- row 2)))
                  (while (and (>= uprow 0) (> cell (aref (aref forest uprow) column)))
                    (setq uprow (1- uprow)))
                  (if (< uprow 0)
                      (progn (cl-incf lit)
                             (cl-return-from CHECK)))))

            ;; check to the right
            (if (> cell (aref (aref forest row) (1+ column)))
                (let ((rightcol (+ column 2)))
                  (while (and (<= rightcol (1- cols)) (> cell (aref (aref forest row) rightcol)))
                    (setq rightcol (1+ rightcol)))
                  (if (> rightcol (1- cols))
                      (progn (cl-incf lit)
                             (cl-return-from CHECK)))))

            ;; check downwards
            (if (> cell (aref (aref forest (1+ row)) column))
                (let ((downrow (+ row 2)))
                  (while (and (<= downrow (1- rows)) (> cell (aref (aref forest downrow) column)))
                    (setq downrow (1+ downrow)))
                  (if (> downrow (1- rows))
                      (progn (cl-incf lit)
                             (cl-return-from CHECK)))))))))
    lit))

(defun aoc22/day8-part2 (forest)
  "Takes INPUT and solve the puzzle.
To be replaced with actual docstring."
  (let* ((rows (length forest))
         (cols (length (aref forest 0)))
         (scenics ()))
    ;; check visibility inside
    (dolist (row (number-sequence 1 (- rows 2)))
      (dolist (column (number-sequence 1 (- cols 2)))
        (let ((cell (aref (aref forest row) column))
              (distance 1))

          ;; check to the left
          (let ((leftcol (1- column)))
            (while (and (> leftcol 0) (> cell (aref (aref forest row) leftcol)))
              (setq leftcol (1- leftcol)))
            (setq distance (* distance (- column leftcol))))

          ;; check upwards
          (let ((uprow (1- row)))
            (while (and (> uprow 0) (> cell (aref (aref forest uprow) column)))
              (setq uprow (1- uprow)))
            (setq distance (* distance (- row uprow))))

          ;; check to the right
          (let ((rightcol (1+ column)))
            (while (and (< rightcol (1- cols)) (> cell (aref (aref forest row) rightcol)))
              (setq rightcol (1+ rightcol)))
            (setq distance (* distance (- rightcol column))))

          ;; check downwards
          (let ((downrow (1+ row)))
            (while (and (< downrow (1- rows)) (> cell (aref (aref forest downrow) column)))
              (setq downrow (1+ downrow)))
            (setq distance (* distance (- downrow row))))
          (push distance scenics))))
    (cl-reduce #'max scenics)))

;;; Helper functions:

;;; Results vector

(vector (aoc22/day8-part1 aoc22/day8test)
        (aoc22/day8-part1 aoc22/day8input)
        (aoc22/day8-part2 aoc22/day8test)
        (aoc22/day8-part2 aoc22/day8input))
#+END_SRC

#+RESULTS: 2022-day8-solution
: [21 1796 8 288120]
** day 9
#+NAME: 2022-day9-input
#+BEGIN_SRC emacs-lisp :session "day9"
(defconst aoc22/day9test '(;; (R 4)
                           ;; (U 4)
                           ;; (L 3)
                           ;; (D 1)
                           ;; (R 4)
                           ;; (D 1)
                           ;; (L 5)
                           ;; (R 2)
                           (R 5)
                           (U 8)
                           (L 8)
                           (D 3)
                           (R 17)
                           (D 10)
                           (L 25)
                           (U 20)
                           ))

(defconst aoc22/day9input '((U 1)
                            (L 2)
                            (U 2)
                            (D 2)
                            (L 2)
                            (U 1)
                            (D 1)
                            (U 2)
                            (D 1)
                            (U 2)
                            (D 1)
                            (R 2)
                            (U 2)
                            (L 1)
                            (U 2)
                            (D 2)
                            (R 1)
                            (U 1)
                            (R 2)
                            (L 1)
                            (R 2)
                            (D 2)
                            (R 2)
                            (D 2)
                            (U 1)
                            (R 1)
                            (D 2)
                            (L 2)
                            (D 1)
                            (R 2)
                            (D 2)
                            (R 1)
                            (L 2)
                            (R 1)
                            (L 2)
                            (R 1)
                            (U 1)
                            (D 2)
                            (L 1)
                            (D 1)
                            (R 1)
                            (U 1)
                            (D 2)
                            (L 1)
                            (U 1)
                            (L 2)
                            (R 1)
                            (D 2)
                            (U 1)
                            (L 1)
                            (D 1)
                            (L 1)
                            (R 2)
                            (D 1)
                            (L 1)
                            (R 1)
                            (L 2)
                            (D 2)
                            (U 2)
                            (D 1)
                            (R 2)
                            (U 1)
                            (L 1)
                            (U 2)
                            (L 1)
                            (U 2)
                            (R 2)
                            (U 1)
                            (D 1)
                            (L 2)
                            (R 2)
                            (D 2)
                            (L 1)
                            (D 2)
                            (R 2)
                            (D 1)
                            (L 1)
                            (D 2)
                            (L 1)
                            (R 1)
                            (L 1)
                            (R 2)
                            (U 1)
                            (R 1)
                            (D 1)
                            (R 1)
                            (D 2)
                            (R 2)
                            (D 2)
                            (U 1)
                            (L 1)
                            (D 1)
                            (R 1)
                            (L 2)
                            (D 1)
                            (U 2)
                            (D 1)
                            (R 1)
                            (D 2)
                            (U 2)
                            (D 1)
                            (R 1)
                            (D 1)
                            (R 1)
                            (U 2)
                            (L 1)
                            (U 1)
                            (R 1)
                            (L 2)
                            (R 1)
                            (L 1)
                            (D 2)
                            (L 2)
                            (R 1)
                            (D 3)
                            (L 3)
                            (U 1)
                            (R 2)
                            (U 1)
                            (R 2)
                            (L 1)
                            (D 1)
                            (L 3)
                            (U 2)
                            (L 3)
                            (D 1)
                            (U 2)
                            (L 3)
                            (U 1)
                            (R 2)
                            (L 1)
                            (R 1)
                            (L 2)
                            (D 2)
                            (R 3)
                            (L 1)
                            (U 1)
                            (L 1)
                            (R 1)
                            (U 1)
                            (D 3)
                            (L 3)
                            (D 2)
                            (R 2)
                            (L 2)
                            (D 1)
                            (U 2)
                            (L 2)
                            (U 1)
                            (R 3)
                            (D 3)
                            (L 3)
                            (R 2)
                            (D 3)
                            (L 3)
                            (U 1)
                            (D 3)
                            (L 2)
                            (R 2)
                            (D 3)
                            (R 2)
                            (L 1)
                            (U 3)
                            (D 2)
                            (R 2)
                            (D 3)
                            (U 1)
                            (D 3)
                            (R 3)
                            (D 2)
                            (U 1)
                            (L 2)
                            (D 2)
                            (U 2)
                            (R 1)
                            (L 3)
                            (U 2)
                            (R 2)
                            (U 1)
                            (R 2)
                            (D 1)
                            (R 2)
                            (D 3)
                            (U 1)
                            (L 1)
                            (U 2)
                            (L 1)
                            (D 2)
                            (R 1)
                            (U 1)
                            (D 1)
                            (R 3)
                            (U 3)
                            (R 1)
                            (U 1)
                            (L 3)
                            (D 2)
                            (R 2)
                            (U 1)
                            (R 2)
                            (D 2)
                            (R 3)
                            (L 2)
                            (U 2)
                            (R 1)
                            (L 3)
                            (U 2)
                            (R 1)
                            (D 3)
                            (L 2)
                            (U 2)
                            (R 3)
                            (U 3)
                            (L 1)
                            (R 3)
                            (D 3)
                            (L 2)
                            (R 3)
                            (D 2)
                            (R 3)
                            (U 3)
                            (R 1)
                            (U 2)
                            (D 4)
                            (L 3)
                            (D 2)
                            (L 4)
                            (R 2)
                            (D 4)
                            (L 1)
                            (R 3)
                            (L 1)
                            (D 4)
                            (U 4)
                            (D 1)
                            (R 4)
                            (U 2)
                            (D 2)
                            (R 1)
                            (U 2)
                            (D 1)
                            (L 3)
                            (D 2)
                            (U 2)
                            (L 1)
                            (R 3)
                            (L 3)
                            (U 3)
                            (L 2)
                            (R 1)
                            (D 2)
                            (R 3)
                            (L 2)
                            (D 4)
                            (U 2)
                            (L 3)
                            (R 3)
                            (L 3)
                            (U 4)
                            (D 4)
                            (L 1)
                            (U 3)
                            (R 4)
                            (L 4)
                            (D 4)
                            (U 3)
                            (R 4)
                            (L 2)
                            (D 1)
                            (U 1)
                            (L 4)
                            (D 3)
                            (U 3)
                            (R 2)
                            (D 3)
                            (U 4)
                            (L 2)
                            (R 1)
                            (L 2)
                            (R 2)
                            (U 3)
                            (L 1)
                            (D 4)
                            (U 1)
                            (L 4)
                            (R 3)
                            (L 3)
                            (R 2)
                            (D 4)
                            (U 4)
                            (L 4)
                            (D 3)
                            (R 1)
                            (D 3)
                            (R 4)
                            (L 4)
                            (R 2)
                            (L 2)
                            (D 2)
                            (R 2)
                            (L 2)
                            (U 3)
                            (R 3)
                            (D 2)
                            (R 4)
                            (L 1)
                            (R 2)
                            (U 4)
                            (L 2)
                            (R 1)
                            (U 2)
                            (R 3)
                            (D 2)
                            (U 1)
                            (R 4)
                            (L 3)
                            (U 3)
                            (D 4)
                            (U 1)
                            (L 1)
                            (R 1)
                            (D 2)
                            (R 1)
                            (D 1)
                            (L 2)
                            (D 4)
                            (U 4)
                            (L 4)
                            (U 3)
                            (D 4)
                            (U 4)
                            (D 3)
                            (U 3)
                            (L 5)
                            (U 4)
                            (L 4)
                            (U 5)
                            (D 1)
                            (L 5)
                            (U 2)
                            (D 4)
                            (U 5)
                            (L 4)
                            (U 2)
                            (D 4)
                            (R 3)
                            (L 5)
                            (U 2)
                            (L 1)
                            (U 5)
                            (L 4)
                            (D 2)
                            (U 5)
                            (R 3)
                            (D 2)
                            (U 3)
                            (L 3)
                            (R 3)
                            (D 5)
                            (U 4)
                            (D 5)
                            (U 4)
                            (R 1)
                            (L 1)
                            (U 3)
                            (L 3)
                            (R 4)
                            (L 1)
                            (U 2)
                            (D 3)
                            (U 5)
                            (L 3)
                            (R 5)
                            (D 3)
                            (U 4)
                            (L 1)
                            (U 3)
                            (R 2)
                            (L 2)
                            (U 5)
                            (D 3)
                            (L 5)
                            (D 1)
                            (R 3)
                            (L 5)
                            (R 1)
                            (D 2)
                            (U 3)
                            (D 2)
                            (L 4)
                            (D 4)
                            (R 5)
                            (L 5)
                            (U 1)
                            (L 5)
                            (R 3)
                            (L 3)
                            (U 4)
                            (R 3)
                            (L 3)
                            (R 1)
                            (L 2)
                            (D 1)
                            (U 3)
                            (L 5)
                            (R 1)
                            (L 5)
                            (U 3)
                            (R 4)
                            (U 4)
                            (D 3)
                            (U 2)
                            (L 5)
                            (D 3)
                            (L 3)
                            (R 2)
                            (D 2)
                            (U 3)
                            (D 3)
                            (R 2)
                            (D 3)
                            (L 1)
                            (R 1)
                            (U 1)
                            (L 3)
                            (R 2)
                            (U 3)
                            (R 1)
                            (D 5)
                            (U 5)
                            (L 5)
                            (D 2)
                            (U 4)
                            (D 3)
                            (U 3)
                            (L 4)
                            (D 3)
                            (U 2)
                            (R 1)
                            (D 4)
                            (L 3)
                            (U 5)
                            (D 2)
                            (L 5)
                            (R 4)
                            (D 3)
                            (L 4)
                            (D 3)
                            (R 4)
                            (D 5)
                            (R 2)
                            (L 3)
                            (D 5)
                            (U 3)
                            (R 4)
                            (U 6)
                            (L 5)
                            (D 3)
                            (U 4)
                            (L 1)
                            (U 5)
                            (R 5)
                            (D 3)
                            (U 5)
                            (D 5)
                            (R 2)
                            (D 2)
                            (U 4)
                            (D 2)
                            (U 3)
                            (R 6)
                            (U 4)
                            (L 2)
                            (R 2)
                            (U 3)
                            (L 1)
                            (U 5)
                            (R 6)
                            (L 1)
                            (D 5)
                            (R 5)
                            (D 5)
                            (L 2)
                            (U 3)
                            (L 4)
                            (R 2)
                            (U 3)
                            (L 2)
                            (U 2)
                            (D 4)
                            (L 4)
                            (R 5)
                            (L 6)
                            (D 2)
                            (L 4)
                            (R 2)
                            (D 4)
                            (L 1)
                            (D 6)
                            (R 2)
                            (U 5)
                            (D 2)
                            (L 6)
                            (U 5)
                            (L 4)
                            (U 1)
                            (D 3)
                            (U 1)
                            (L 5)
                            (U 2)
                            (R 6)
                            (D 5)
                            (U 4)
                            (L 5)
                            (U 1)
                            (L 5)
                            (U 2)
                            (R 5)
                            (U 2)
                            (R 4)
                            (D 4)
                            (R 1)
                            (D 6)
                            (R 5)
                            (L 5)
                            (U 6)
                            (D 2)
                            (R 1)
                            (L 4)
                            (U 3)
                            (D 6)
                            (R 4)
                            (L 3)
                            (R 6)
                            (U 2)
                            (R 1)
                            (U 4)
                            (R 5)
                            (U 1)
                            (D 4)
                            (U 1)
                            (L 3)
                            (D 2)
                            (L 2)
                            (D 2)
                            (L 2)
                            (U 6)
                            (D 4)
                            (L 5)
                            (D 2)
                            (U 1)
                            (L 5)
                            (D 2)
                            (R 3)
                            (L 2)
                            (D 2)
                            (U 4)
                            (L 4)
                            (U 6)
                            (L 1)
                            (R 7)
                            (L 4)
                            (U 1)
                            (L 1)
                            (U 6)
                            (L 1)
                            (D 2)
                            (L 5)
                            (R 3)
                            (U 6)
                            (L 6)
                            (U 2)
                            (D 4)
                            (L 2)
                            (R 6)
                            (L 3)
                            (D 4)
                            (L 1)
                            (R 6)
                            (D 4)
                            (U 2)
                            (D 4)
                            (R 2)
                            (D 1)
                            (U 3)
                            (R 6)
                            (U 4)
                            (D 2)
                            (L 6)
                            (R 5)
                            (L 3)
                            (U 1)
                            (L 3)
                            (U 3)
                            (L 7)
                            (R 1)
                            (L 4)
                            (D 5)
                            (U 6)
                            (L 3)
                            (U 2)
                            (L 1)
                            (D 2)
                            (R 4)
                            (D 7)
                            (R 1)
                            (D 5)
                            (L 1)
                            (D 2)
                            (U 2)
                            (R 1)
                            (L 1)
                            (U 2)
                            (D 2)
                            (R 4)
                            (D 7)
                            (L 7)
                            (D 1)
                            (L 4)
                            (R 7)
                            (U 3)
                            (L 4)
                            (R 3)
                            (U 2)
                            (R 5)
                            (U 5)
                            (L 5)
                            (U 2)
                            (L 7)
                            (R 4)
                            (U 2)
                            (L 5)
                            (R 4)
                            (U 7)
                            (L 7)
                            (R 5)
                            (L 6)
                            (D 4)
                            (L 1)
                            (D 6)
                            (L 5)
                            (R 5)
                            (L 7)
                            (R 5)
                            (D 4)
                            (U 4)
                            (L 5)
                            (U 7)
                            (D 6)
                            (U 3)
                            (L 5)
                            (U 4)
                            (D 1)
                            (L 1)
                            (D 7)
                            (R 3)
                            (D 7)
                            (U 3)
                            (D 7)
                            (R 4)
                            (U 5)
                            (L 7)
                            (R 4)
                            (L 5)
                            (R 1)
                            (D 4)
                            (L 3)
                            (U 1)
                            (R 3)
                            (L 1)
                            (U 4)
                            (R 3)
                            (L 5)
                            (D 2)
                            (R 2)
                            (L 4)
                            (D 4)
                            (L 7)
                            (R 7)
                            (U 2)
                            (D 7)
                            (L 5)
                            (U 3)
                            (L 4)
                            (U 7)
                            (R 6)
                            (D 3)
                            (L 2)
                            (R 7)
                            (L 5)
                            (U 6)
                            (D 6)
                            (L 2)
                            (D 2)
                            (L 5)
                            (D 7)
                            (U 5)
                            (L 3)
                            (D 4)
                            (U 4)
                            (L 4)
                            (R 2)
                            (D 8)
                            (L 3)
                            (R 2)
                            (D 4)
                            (L 4)
                            (U 7)
                            (R 8)
                            (D 6)
                            (R 7)
                            (U 1)
                            (R 6)
                            (U 6)
                            (R 4)
                            (D 8)
                            (L 3)
                            (R 3)
                            (D 2)
                            (U 5)
                            (D 8)
                            (L 3)
                            (D 5)
                            (L 7)
                            (R 5)
                            (L 1)
                            (D 4)
                            (L 7)
                            (U 7)
                            (L 8)
                            (D 7)
                            (L 5)
                            (U 3)
                            (R 4)
                            (U 3)
                            (L 7)
                            (R 8)
                            (D 6)
                            (R 2)
                            (D 3)
                            (R 1)
                            (D 6)
                            (U 8)
                            (D 6)
                            (L 2)
                            (R 8)
                            (D 4)
                            (U 3)
                            (D 5)
                            (U 2)
                            (L 3)
                            (U 1)
                            (R 7)
                            (U 6)
                            (D 5)
                            (R 5)
                            (U 4)
                            (L 1)
                            (D 3)
                            (U 7)
                            (L 8)
                            (U 5)
                            (D 5)
                            (U 4)
                            (D 3)
                            (L 5)
                            (D 5)
                            (R 5)
                            (D 3)
                            (R 4)
                            (U 4)
                            (R 8)
                            (L 4)
                            (D 4)
                            (L 2)
                            (D 4)
                            (R 7)
                            (L 8)
                            (R 7)
                            (L 1)
                            (D 3)
                            (U 6)
                            (R 5)
                            (D 1)
                            (U 4)
                            (R 7)
                            (U 1)
                            (R 2)
                            (L 8)
                            (U 8)
                            (D 2)
                            (L 9)
                            (U 9)
                            (D 4)
                            (U 8)
                            (D 3)
                            (R 1)
                            (U 3)
                            (D 1)
                            (R 7)
                            (L 2)
                            (U 4)
                            (L 4)
                            (U 9)
                            (L 7)
                            (U 2)
                            (L 4)
                            (D 5)
                            (R 8)
                            (L 5)
                            (R 4)
                            (U 2)
                            (L 5)
                            (U 2)
                            (D 1)
                            (L 9)
                            (R 5)
                            (D 6)
                            (U 3)
                            (D 5)
                            (U 2)
                            (L 1)
                            (R 7)
                            (U 1)
                            (L 7)
                            (U 1)
                            (L 5)
                            (D 6)
                            (R 6)
                            (D 7)
                            (U 6)
                            (D 7)
                            (L 7)
                            (D 2)
                            (L 6)
                            (D 4)
                            (U 7)
                            (D 4)
                            (L 8)
                            (D 5)
                            (R 7)
                            (L 9)
                            (D 9)
                            (U 3)
                            (D 2)
                            (U 9)
                            (R 4)
                            (D 3)
                            (U 9)
                            (R 4)
                            (D 6)
                            (L 2)
                            (D 1)
                            (L 5)
                            (U 2)
                            (L 5)
                            (D 1)
                            (R 7)
                            (L 9)
                            (R 6)
                            (D 8)
                            (L 2)
                            (R 5)
                            (D 6)
                            (L 9)
                            (U 8)
                            (R 2)
                            (D 4)
                            (R 5)
                            (U 3)
                            (D 4)
                            (R 6)
                            (D 5)
                            (U 9)
                            (D 6)
                            (L 3)
                            (D 6)
                            (R 6)
                            (D 5)
                            (R 7)
                            (U 5)
                            (L 2)
                            (U 2)
                            (D 5)
                            (U 4)
                            (D 8)
                            (R 6)
                            (U 8)
                            (D 2)
                            (R 9)
                            (U 6)
                            (L 1)
                            (U 6)
                            (L 5)
                            (U 10)
                            (D 2)
                            (U 6)
                            (R 10)
                            (L 7)
                            (U 4)
                            (R 2)
                            (D 1)
                            (U 3)
                            (D 6)
                            (L 10)
                            (U 4)
                            (L 5)
                            (D 10)
                            (R 1)
                            (L 5)
                            (R 5)
                            (U 6)
                            (R 1)
                            (D 7)
                            (L 7)
                            (D 4)
                            (L 4)
                            (D 10)
                            (U 1)
                            (R 9)
                            (L 7)
                            (D 7)
                            (L 6)
                            (D 7)
                            (U 7)
                            (R 5)
                            (L 6)
                            (U 3)
                            (L 1)
                            (D 4)
                            (L 1)
                            (D 3)
                            (U 10)
                            (D 10)
                            (L 3)
                            (R 6)
                            (U 4)
                            (D 2)
                            (L 4)
                            (U 1)
                            (R 9)
                            (D 8)
                            (U 7)
                            (R 10)
                            (U 10)
                            (L 4)
                            (U 1)
                            (L 9)
                            (R 7)
                            (L 8)
                            (R 10)
                            (D 6)
                            (U 1)
                            (R 1)
                            (D 10)
                            (R 4)
                            (L 6)
                            (D 2)
                            (U 9)
                            (R 6)
                            (L 4)
                            (U 10)
                            (R 10)
                            (U 4)
                            (D 8)
                            (U 8)
                            (L 9)
                            (R 9)
                            (D 7)
                            (L 1)
                            (D 6)
                            (L 7)
                            (U 4)
                            (L 6)
                            (R 9)
                            (D 6)
                            (L 5)
                            (D 5)
                            (L 5)
                            (U 6)
                            (R 1)
                            (D 4)
                            (R 6)
                            (L 5)
                            (U 9)
                            (R 3)
                            (D 3)
                            (L 10)
                            (D 6)
                            (U 5)
                            (D 6)
                            (R 6)
                            (D 7)
                            (R 3)
                            (D 2)
                            (L 2)
                            (D 9)
                            (U 1)
                            (D 1)
                            (L 1)
                            (D 3)
                            (U 3)
                            (R 4)
                            (U 1)
                            (L 9)
                            (U 9)
                            (R 4)
                            (D 10)
                            (U 2)
                            (L 4)
                            (U 3)
                            (D 1)
                            (R 10)
                            (U 7)
                            (R 5)
                            (D 6)
                            (L 2)
                            (U 5)
                            (L 5)
                            (U 5)
                            (L 4)
                            (D 8)
                            (R 7)
                            (L 5)
                            (R 6)
                            (U 4)
                            (L 7)
                            (D 4)
                            (R 9)
                            (D 7)
                            (R 7)
                            (L 2)
                            (D 8)
                            (L 9)
                            (D 2)
                            (L 7)
                            (U 10)
                            (R 3)
                            (U 5)
                            (R 3)
                            (D 9)
                            (U 9)
                            (D 11)
                            (U 6)
                            (R 3)
                            (U 11)
                            (D 11)
                            (L 11)
                            (U 6)
                            (D 10)
                            (R 9)
                            (U 11)
                            (R 6)
                            (L 4)
                            (R 5)
                            (L 11)
                            (D 9)
                            (L 10)
                            (R 4)
                            (D 11)
                            (R 2)
                            (L 6)
                            (R 3)
                            (U 4)
                            (L 10)
                            (U 6)
                            (D 9)
                            (L 5)
                            (U 3)
                            (R 2)
                            (U 5)
                            (L 7)
                            (U 1)
                            (L 10)
                            (U 9)
                            (R 3)
                            (D 5)
                            (R 9)
                            (U 6)
                            (D 9)
                            (L 6)
                            (R 10)
                            (D 10)
                            (R 8)
                            (D 7)
                            (L 3)
                            (D 4)
                            (L 6)
                            (R 2)
                            (D 11)
                            (U 5)
                            (D 7)
                            (L 1)
                            (U 11)
                            (L 11)
                            (U 3)
                            (D 2)
                            (L 9)
                            (R 8)
                            (L 11)
                            (R 2)
                            (D 9)
                            (U 3)
                            (L 9)
                            (U 6)
                            (D 2)
                            (L 10)
                            (U 8)
                            (L 5)
                            (R 3)
                            (U 3)
                            (R 1)
                            (L 7)
                            (R 10)
                            (L 2)
                            (R 7)
                            (U 5)
                            (D 12)
                            (L 11)
                            (R 2)
                            (L 10)
                            (U 2)
                            (D 3)
                            (R 3)
                            (U 6)
                            (D 1)
                            (L 8)
                            (R 4)
                            (L 5)
                            (U 10)
                            (R 12)
                            (U 9)
                            (R 12)
                            (L 12)
                            (R 6)
                            (U 11)
                            (D 1)
                            (R 9)
                            (U 2)
                            (R 11)
                            (L 1)
                            (R 12)
                            (U 10)
                            (L 9)
                            (U 12)
                            (R 10)
                            (U 12)
                            (D 12)
                            (U 2)
                            (D 11)
                            (L 12)
                            (R 9)
                            (U 3)
                            (D 4)
                            (L 6)
                            (U 3)
                            (R 10)
                            (D 2)
                            (U 11)
                            (L 4)
                            (R 11)
                            (U 11)
                            (R 1)
                            (D 10)
                            (R 6)
                            (U 8)
                            (L 3)
                            (D 6)
                            (R 1)
                            (U 9)
                            (L 3)
                            (U 5)
                            (D 4)
                            (R 12)
                            (U 11)
                            (D 2)
                            (U 10)
                            (L 4)
                            (D 9)
                            (L 4)
                            (U 10)
                            (D 1)
                            (R 1)
                            (L 5)
                            (R 2)
                            (D 12)
                            (R 5)
                            (U 3)
                            (L 11)
                            (D 10)
                            (L 11)
                            (R 7)
                            (L 10)
                            (U 6)
                            (R 12)
                            (D 3)
                            (R 10)
                            (U 1)
                            (L 2)
                            (D 1)
                            (R 1)
                            (L 12)
                            (U 4)
                            (L 3)
                            (R 6)
                            (L 3)
                            (D 6)
                            (U 7)
                            (R 10)
                            (U 6)
                            (D 6)
                            (R 5)
                            (D 10)
                            (R 10)
                            (D 8)
                            (L 10)
                            (U 11)
                            (R 9)
                            (L 4)
                            (R 8)
                            (U 1)
                            (D 3)
                            (U 7)
                            (L 3)
                            (U 10)
                            (R 12)
                            (U 10)
                            (D 10)
                            (U 9)
                            (D 7)
                            (R 4)
                            (D 2)
                            (R 9)
                            (U 13)
                            (R 6)
                            (L 4)
                            (R 9)
                            (L 11)
                            (U 6)
                            (L 12)
                            (D 9)
                            (R 13)
                            (L 2)
                            (U 7)
                            (D 10)
                            (L 13)
                            (D 4)
                            (U 6)
                            (L 8)
                            (U 13)
                            (R 3)
                            (D 2)
                            (L 3)
                            (R 1)
                            (U 1)
                            (D 7)
                            (L 5)
                            (D 6)
                            (R 1)
                            (D 3)
                            (R 5)
                            (L 1)
                            (D 3)
                            (U 11)
                            (L 1)
                            (D 13)
                            (R 5)
                            (D 2)
                            (L 8)
                            (D 10)
                            (R 1)
                            (L 2)
                            (D 2)
                            (L 12)
                            (R 11)
                            (D 13)
                            (R 7)
                            (D 12)
                            (L 2)
                            (D 5)
                            (L 9)
                            (D 8)
                            (L 3)
                            (D 2)
                            (U 4)
                            (D 8)
                            (R 7)
                            (D 8)
                            (U 8)
                            (R 2)
                            (U 10)
                            (D 7)
                            (L 9)
                            (U 1)
                            (L 10)
                            (R 4)
                            (U 1)
                            (L 5)
                            (R 5)
                            (D 10)
                            (R 2)
                            (L 6)
                            (R 4)
                            (D 10)
                            (L 7)
                            (R 11)
                            (L 11)
                            (U 7)
                            (L 1)
                            (D 5)
                            (U 4)
                            (D 6)
                            (R 4)
                            (U 6)
                            (D 7)
                            (L 2)
                            (D 1)
                            (R 11)
                            (U 11)
                            (D 12)
                            (U 4)
                            (D 13)
                            (R 3)
                            (L 4)
                            (R 3)
                            (L 8)
                            (R 4)
                            (U 7)
                            (L 2)
                            (R 8)
                            (L 13)
                            (D 6)
                            (U 11)
                            (L 12)
                            (U 1)
                            (D 3)
                            (U 7)
                            (L 4)
                            (R 5)
                            (U 7)
                            (D 1)
                            (L 9)
                            (U 2)
                            (R 4)
                            (D 9)
                            (U 8)
                            (R 2)
                            (D 9)
                            (L 8)
                            (D 13)
                            (U 13)
                            (D 1)
                            (U 9)
                            (D 5)
                            (L 1)
                            (U 12)
                            (D 2)
                            (R 9)
                            (L 7)
                            (R 1)
                            (L 3)
                            (R 2)
                            (D 12)
                            (L 11)
                            (D 4)
                            (R 11)
                            (U 5)
                            (L 13)
                            (R 2)
                            (U 12)
                            (L 9)
                            (R 10)
                            (U 3)
                            (D 10)
                            (R 8)
                            (D 12)
                            (U 6)
                            (R 7)
                            (D 11)
                            (L 10)
                            (U 14)
                            (L 9)
                            (U 12)
                            (D 4)
                            (U 3)
                            (D 10)
                            (R 6)
                            (D 5)
                            (R 1)
                            (D 10)
                            (U 13)
                            (L 9)
                            (R 7)
                            (U 14)
                            (D 10)
                            (U 7)
                            (D 13)
                            (L 14)
                            (D 14)
                            (U 6)
                            (D 14)
                            (L 8)
                            (R 2)
                            (D 7)
                            (U 14)
                            (R 6)
                            (L 14)
                            (U 14)
                            (R 6)
                            (D 7)
                            (R 7)
                            (D 3)
                            (U 10)
                            (D 10)
                            (R 7)
                            (U 11)
                            (R 3)
                            (L 2)
                            (R 12)
                            (L 13)
                            (R 3)
                            (U 4)
                            (D 1)
                            (L 7)
                            (U 9)
                            (R 9)
                            (U 9)
                            (L 11)
                            (U 7)
                            (D 6)
                            (R 7)
                            (L 3)
                            (D 5)
                            (U 14)
                            (R 8)
                            (D 7)
                            (L 6)
                            (U 6)
                            (R 11)
                            (D 9)
                            (R 6)
                            (D 5)
                            (L 5)
                            (D 1)
                            (L 10)
                            (R 8)
                            (L 15)
                            (U 1)
                            (D 14)
                            (L 1)
                            (R 5)
                            (D 5)
                            (L 3)
                            (U 6)
                            (R 6)
                            (L 4)
                            (D 3)
                            (L 3)
                            (D 4)
                            (U 7)
                            (L 10)
                            (D 8)
                            (R 13)
                            (D 9)
                            (R 15)
                            (D 6)
                            (U 10)
                            (D 14)
                            (L 10)
                            (U 12)
                            (D 13)
                            (U 8)
                            (L 13)
                            (U 11)
                            (D 13)
                            (L 8)
                            (R 12)
                            (U 12)
                            (D 14)
                            (U 15)
                            (L 1)
                            (R 14)
                            (U 15)
                            (L 14)
                            (U 4)
                            (D 2)
                            (L 2)
                            (R 6)
                            (D 15)
                            (U 2)
                            (R 5)
                            (L 7)
                            (U 8)
                            (D 12)
                            (R 2)
                            (U 2)
                            (R 11)
                            (L 3)
                            (U 15)
                            (R 15)
                            (D 1)
                            (U 9)
                            (R 5)
                            (U 1)
                            (R 15)
                            (U 7)
                            (D 8)
                            (R 6)
                            (U 7)
                            (R 1)
                            (U 5)
                            (R 15)
                            (U 9)
                            (L 6)
                            (U 10)
                            (R 10)
                            (D 2)
                            (U 14)
                            (D 13)
                            (R 11)
                            (L 14)
                            (D 6)
                            (U 6)
                            (D 6)
                            (U 10)
                            (D 1)
                            (U 10)
                            (L 11)
                            (D 13)
                            (U 2)
                            (L 14)
                            (D 9)
                            (R 14)
                            (U 9)
                            (L 8)
                            (D 11)
                            (U 3)
                            (L 5)
                            (U 8)
                            (L 1)
                            (U 12)
                            (L 6)
                            (R 5)
                            (D 8)
                            (R 5)
                            (D 9)
                            (U 14)
                            (R 13)
                            (U 6)
                            (L 9)
                            (R 7)
                            (L 5)
                            (U 9)
                            (L 8)
                            (D 9)
                            (L 3)
                            (R 4)
                            (L 8)
                            (D 1)
                            (L 4)
                            (R 6)
                            (U 8)
                            (L 5)
                            (R 12)
                            (U 7)
                            (R 5)
                            (D 8)
                            (U 6)
                            (R 11)
                            (U 1)
                            (D 9)
                            (L 7)
                            (R 10)
                            (L 4)
                            (R 1)
                            (D 11)
                            (R 1)
                            (U 16)
                            (L 6)
                            (R 7)
                            (D 3)
                            (R 4)
                            (U 13)
                            (R 12)
                            (D 1)
                            (L 5)
                            (D 2)
                            (U 4)
                            (D 11)
                            (L 13)
                            (D 4)
                            (U 2)
                            (D 14)
                            (L 3)
                            (U 1)
                            (D 13)
                            (R 14)
                            (U 6)
                            (R 8)
                            (L 16)
                            (U 9)
                            (D 7)
                            (U 15)
                            (D 15)
                            (L 11)
                            (R 15)
                            (L 4)
                            (D 5)
                            (U 3)
                            (L 3)
                            (D 8)
                            (L 6)
                            (U 15)
                            (L 11)
                            (R 14)
                            (D 8)
                            (U 10)
                            (D 6)
                            (R 1)
                            (L 16)
                            (D 16)
                            (L 3)
                            (U 10)
                            (R 5)
                            (L 16)
                            (R 2)
                            (U 15)
                            (R 10)
                            (U 11)
                            (R 15)
                            (D 16)
                            (L 3)
                            (U 15)
                            (L 10)
                            (R 12)
                            (U 13)
                            (R 3)
                            (L 13)
                            (D 15)
                            (U 4)
                            (R 8)
                            (U 6)
                            (L 10)
                            (R 12)
                            (U 1)
                            (L 15)
                            (D 5)
                            (L 1)
                            (U 9)
                            (D 1)
                            (R 16)
                            (L 7)
                            (U 13)
                            (L 13)
                            (U 6)
                            (L 1)
                            (R 14)
                            (L 11)
                            (U 16)
                            (R 15)
                            (L 10)
                            (D 9)
                            (R 9)
                            (D 6)
                            (U 16)
                            (R 4)
                            (U 1)
                            (L 3)
                            (R 16)
                            (L 3)
                            (U 6)
                            (D 15)
                            (R 13)
                            (D 11)
                            (U 15)
                            (R 3)
                            (L 15)
                            (D 14)
                            (U 10)
                            (R 7)
                            (U 4)
                            (R 13)
                            (L 11)
                            (R 13)
                            (L 11)
                            (R 3)
                            (L 5)
                            (U 12)
                            (L 9)
                            (U 8)
                            (D 2)
                            (U 17)
                            (D 3)
                            (R 17)
                            (U 14)
                            (L 9)
                            (R 10)
                            (D 6)
                            (L 5)
                            (R 14)
                            (L 8)
                            (U 2)
                            (D 16)
                            (R 15)
                            (D 12)
                            (U 3)
                            (L 4)
                            (R 12)
                            (U 16)
                            (D 14)
                            (L 12)
                            (R 8)
                            (D 4)
                            (R 9)
                            (U 12)
                            (R 15)
                            (U 6)
                            (L 3)
                            (D 17)
                            (R 3)
                            (U 6)
                            (L 2)
                            (R 2)
                            (U 2)
                            (D 17)
                            (L 4)
                            (R 8)
                            (U 17)
                            (R 16)
                            (L 17)
                            (U 5)
                            (D 11)
                            (U 8)
                            (L 7)
                            (U 3)
                            (R 1)
                            (D 15)
                            (U 14)
                            (L 4)
                            (D 9)
                            (U 15)
                            (R 13)
                            (L 2)
                            (U 4)
                            (R 17)
                            (U 2)
                            (L 13)
                            (R 4)
                            (U 8)
                            (R 15)
                            (U 8)
                            (D 13)
                            (U 10)
                            (D 7)
                            (U 7)
                            (D 17)
                            (R 16)
                            (L 10)
                            (U 10)
                            (L 8)
                            (R 9)
                            (L 8)
                            (R 1)
                            (D 10)
                            (U 17)
                            (D 13)
                            (U 10)
                            (D 13)
                            (L 14)
                            (R 17)
                            (D 5)
                            (L 1)
                            (U 17)
                            (D 17)
                            (L 13)
                            (U 12)
                            (R 10)
                            (D 12)
                            (R 15)
                            (L 15)
                            (U 11)
                            (L 14)
                            (D 15)
                            (U 12)
                            (D 7)
                            (U 15)
                            (L 1)
                            (U 2)
                            (R 18)
                            (L 15)
                            (U 7)
                            (L 8)
                            (R 3)
                            (D 14)
                            (R 7)
                            (D 7)
                            (U 6)
                            (R 10)
                            (L 9)
                            (R 9)
                            (D 17)
                            (R 11)
                            (D 4)
                            (L 16)
                            (U 12)
                            (R 10)
                            (L 4)
                            (D 7)
                            (U 18)
                            (L 11)
                            (U 3)
                            (L 13)
                            (U 5)
                            (R 11)
                            (D 16)
                            (U 14)
                            (D 1)
                            (R 18)
                            (D 4)
                            (L 7)
                            (U 2)
                            (D 9)
                            (L 5)
                            (R 14)
                            (U 18)
                            (R 2)
                            (U 7)
                            (R 8)
                            (U 9)
                            (L 6)
                            (R 12)
                            (U 15)
                            (R 1)
                            (L 7)
                            (D 3)
                            (U 10)
                            (R 5)
                            (U 2)
                            (L 8)
                            (R 13)
                            (L 14)
                            (D 10)
                            (L 10)
                            (U 12)
                            (R 5)
                            (L 13)
                            (D 8)
                            (U 5)
                            (D 17)
                            (L 8)
                            (D 8)
                            (L 7)
                            (U 5)
                            (D 16)
                            (R 9)
                            (D 6)
                            (U 11)
                            (D 16)
                            (U 15)
                            (D 6)
                            (L 4)
                            (R 16)
                            (D 8)
                            (L 11)
                            (U 13)
                            (R 14)
                            (L 12)
                            (D 2)
                            (U 16)
                            (D 1)
                            (L 12)
                            (D 10)
                            (R 1)
                            (D 17)
                            (L 8)
                            (U 13)
                            (R 10)
                            (U 9)
                            (D 4)
                            (R 1)
                            (U 17)
                            (L 5)
                            (D 15)
                            (U 9)
                            (R 15)
                            (U 18)
                            (L 15)
                            (D 18)
                            (U 15)
                            (D 1)
                            (L 9)
                            (R 6)
                            (L 15)
                            (R 3)
                            (D 19)
                            (L 5)
                            (D 10)
                            (L 18)
                            (D 11)
                            (L 14)
                            (D 11)
                            (U 19)
                            (D 5)
                            (R 9)
                            (L 18)
                            (R 11)
                            (D 3)
                            (L 7)
                            (R 4)
                            (D 13)
                            (L 9)
                            (R 14)
                            (D 14)
                            (L 8)
                            (U 10)
                            (L 11)
                            (U 4)
                            (D 13)
                            (R 13)
                            (L 7)
                            (R 7)
                            (D 18)
                            (U 2)
                            (L 17)
                            (D 16)
                            (R 3)
                            (U 12)
                            (L 13)
                            (U 5)
                            (L 1)
                            (U 9)
                            (R 6)
                            (D 14)
                            (U 6)
                            (R 3)
                            (U 6)
                            (R 7)
                            (D 8)
                            (U 11)
                            (L 11)
                            (R 7)
                            (U 17)
                            (D 2)
                            (L 12)
                            (U 18)
                            (L 3)
                            (U 14)
                            (L 6)
                            (R 10)
                            (L 16)
                            (U 19)
                            (D 9)
                            (R 13)
                            (U 5)
                            (R 5)
                            (D 15)
                            (R 1)
                            (L 1)
                            (U 5)
                            (D 16)
                            (L 5)
                            (R 15)
                            (L 14)
                            (D 5)
                            (R 9)
                            (U 12)
                            (L 9)
                            (U 7)
                            (R 16)
                            (D 16)
                            (R 10)
                            (D 15)
                            (R 16)
                            (L 2)
                            (U 13)
                            (L 5)
                            (D 19)
                            (R 18)
                            (D 19)
                            (R 16)
                            (D 12)
                            (R 15)
                            (D 12)
                            (U 5)
                            (L 3)
                            (R 14)
                            (D 7)
                            (U 11)
                            (R 10)
                            (L 18)
                            (D 9)
                            (U 2)
                            (D 19)
                            (U 8)
                            (D 19)
                            (U 18)
                            (R 11)
                            (D 2)
                            (R 8)
                            (D 14)))

#+END_SRC

#+RESULTS: 2022-day9-input
: aoc22/day9input


#+NAME: 2022-day9-solution
#+BEGIN_SRC emacs-lisp :session "day9" :val x=2022-day9-input
;;; Code:

(defun aoc22/day9-part1 (instructions)
  "Follow the INSTRUCTIONS for head movement and the tail will follow.
After each move instruction the tail should be at most one unit
away (horizontally, vertically or diagonally).  If after the move
the tail is more than one unit away, it must move closer to the
head.  The places where tail moves need to be kept, and at the
end, I need to report all the places that the tail landed on."
  (let ((head '(0 0))
        (tail '(0 0))
        (dir '(0 0))
        (pos '((0 0))))
    (dolist (set instructions)
      (let ((to (car set))
            (times (cadr set)))
        (cond
         ((eq to 'R) (setq dir '(1 0)))
         ((eq to 'U) (setq dir '(0 1)))
         ((eq to 'L) (setq dir '(-1 0)))
         ((eq to 'D) (setq dir '(0 -1))))
        (dotimes (iteration times)
          (setq head (add-points head dir))
          (let ((move-it (tail-move head tail)))
            (if move-it
                (progn (setq tail (add-points tail move-it))
                       (if (not (member tail pos))
                           (push tail pos))))))))
    (length pos)))

(defun aoc22/day9-part2 (instructions)
  "Follow the INSTRUCTIONS for head movement and the 9 tails will follow.
After each move instruction the tails should be at most one unit
away (horizontally, vertically or diagonally) from the previous
tail (or head).  If after the move the tail is more than one unit
away, it must move closer to the head.  The places where the last
tail moves need to be kept, and at the end, I need to report all
the places that the last tail landed on."
  (let ((head '(0 0))
        (knots '((0 0) (0 0) (0 0) (0 0)
                 (0 0) (0 0) (0 0) (0 0)))
        (tail '(0 0))
        (dir '(0 0))
        (pos '((0 0))))
    (dolist (set instructions)
      (let ((to (car set))
            (times (cadr set)))
        (cond
         ((eq to 'R) (setq dir '(1 0)))
         ((eq to 'U) (setq dir '(0 1)))
         ((eq to 'L) (setq dir '(-1 0)))
         ((eq to 'D) (setq dir '(0 -1))))
        (dotimes (iteration times)
          (setq head (add-points head dir))
          (let ((move-it (tail-move head (car knots))))
            (if move-it
                (setf (car knots)
                      (add-points (car knots) move-it))))
          (dolist (knot (number-sequence 1 (1- (length knots))))
            (let ((move-it (tail-move (nth (1- knot) knots)
                                      (nth knot knots))))
              (if move-it
                  (setf (nth knot knots)
                        (add-points (nth knot knots) move-it)))))
          (let ((move-it (tail-move (nth (1- (length knots)) knots) tail)))
            (if move-it
                (progn (setf tail (add-points tail move-it))
                       (if (not (member tail pos))
                           (push tail pos))))))))
    (length pos)))

;;; Helper functions:
(defun add-points (p1 p2)
  "Add points P1 and P2 and return their sum."
  (list (+ (car p1) (car p2)) (+ (cadr p1) (cadr p2))))

(defun tail-move (head tail)
  "Find the distance between HEAD and TAIL.
If it's more than 1 unit on any axis, compute the distance TAIL
needs to travel to catch up with HEAD.  Otherwise, return
nil (tail need not travel)."

  (let* ((x-distance (- (car head) (car tail)))
         (y-distance (- (cadr head) (cadr tail)))
         (distance (list x-distance y-distance)))
    (cond
     ((member distance '((0 0)(0 1)(1 0)(1 1)(0 -1)(-1 0)(-1 1)(1 -1)(-1 -1)))
      nil)
     ((member distance '((2 0)(-2 0)(0 2)(0 -2)))
      (list (/ x-distance 2) (/ y-distance 2)))
     ((member distance '((2 1)(2 -1)(-2 1)(-2 -1)))
      (list (/ x-distance 2) y-distance))
     ((member distance '((1 2)(-1 2)(1 -2)(-1 -2)))
      (list x-distance (/ y-distance 2)))
     ((member distance '((2 2)(-2 2)(2 -2)(-2 -2)))
      (list (/ x-distance 2) (/ y-distance 2)))
     (t (prog1 nil (print (format "found special case %s" distance)) (error "Done")))
     )))


;;; Results vector

(vector ;(aoc22/day9-part1 aoc22/day9test)
        (aoc22/day9-part1 aoc22/day9input)
        ;(aoc22/day9-part2 aoc22/day9test)
        (aoc22/day9-part2 aoc22/day9input)
        )
#+END_SRC

#+RESULTS: 2022-day9-solution
: [6081 2487]
** day 10
#+NAME: 2022-day10-input
#+BEGIN_SRC emacs-lisp :session "day10"
(defconst aoc22/day10test '((addx 15)
                            (addx -11)
                            (addx 6)
                            (addx -3)
                            (addx 5)
                            (addx -1)
                            (addx -8)
                            (addx 13)
                            (addx 4)
                            (noop)
                            (addx -1)
                            (addx 5)
                            (addx -1)
                            (addx 5)
                            (addx -1)
                            (addx 5)
                            (addx -1)
                            (addx 5)
                            (addx -1)
                            (addx -35)
                            (addx 1)
                            (addx 24)
                            (addx -19)
                            (addx 1)
                            (addx 16)
                            (addx -11)
                            (noop)
                            (noop)
                            (addx 21)
                            (addx -15)
                            (noop)
                            (noop)
                            (addx -3)
                            (addx 9)
                            (addx 1)
                            (addx -3)
                            (addx 8)
                            (addx 1)
                            (addx 5)
                            (noop)
                            (noop)
                            (noop)
                            (noop)
                            (noop)
                            (addx -36)
                            (noop)
                            (addx 1)
                            (addx 7)
                            (noop)
                            (noop)
                            (noop)
                            (addx 2)
                            (addx 6)
                            (noop)
                            (noop)
                            (noop)
                            (noop)
                            (noop)
                            (addx 1)
                            (noop)
                            (noop)
                            (addx 7)
                            (addx 1)
                            (noop)
                            (addx -13)
                            (addx 13)
                            (addx 7)
                            (noop)
                            (addx 1)
                            (addx -33)
                            (noop)
                            (noop)
                            (noop)
                            (addx 2)
                            (noop)
                            (noop)
                            (noop)
                            (addx 8)
                            (noop)
                            (addx -1)
                            (addx 2)
                            (addx 1)
                            (noop)
                            (addx 17)
                            (addx -9)
                            (addx 1)
                            (addx 1)
                            (addx -3)
                            (addx 11)
                            (noop)
                            (noop)
                            (addx 1)
                            (noop)
                            (addx 1)
                            (noop)
                            (noop)
                            (addx -13)
                            (addx -19)
                            (addx 1)
                            (addx 3)
                            (addx 26)
                            (addx -30)
                            (addx 12)
                            (addx -1)
                            (addx 3)
                            (addx 1)
                            (noop)
                            (noop)
                            (noop)
                            (addx -9)
                            (addx 18)
                            (addx 1)
                            (addx 2)
                            (noop)
                            (noop)
                            (addx 9)
                            (noop)
                            (noop)
                            (noop)
                            (addx -1)
                            (addx 2)
                            (addx -37)
                            (addx 1)
                            (addx 3)
                            (noop)
                            (addx 15)
                            (addx -21)
                            (addx 22)
                            (addx -6)
                            (addx 1)
                            (noop)
                            (addx 2)
                            (addx 1)
                            (noop)
                            (addx -10)
                            (noop)
                            (noop)
                            (addx 20)
                            (addx 1)
                            (addx 2)
                            (addx 2)
                            (addx -6)
                            (addx -11)
                            (noop)
                            (noop)
                            (noop)))

(defconst aoc22/day10input '((addx 1)
                             (addx 4)
                             (noop)
                             (noop)
                             (noop)
                             (noop)
                             (addx 6)
                             (addx -1)
                             (noop)
                             (addx 5)
                             (noop)
                             (addx 5)
                             (noop)
                             (noop)
                             (noop)
                             (addx 1)
                             (addx 3)
                             (addx 1)
                             (addx 6)
                             (addx -1)
                             (noop)
                             (noop)
                             (noop)
                             (addx 7)
                             (noop)
                             (addx -39)
                             (noop)
                             (noop)
                             (noop)
                             (addx 7)
                             (addx 3)
                             (addx -2)
                             (addx 2)
                             (noop)
                             (addx 3)
                             (addx 2)
                             (addx 5)
                             (addx 2)
                             (addx -8)
                             (addx 13)
                             (noop)
                             (addx 3)
                             (addx -2)
                             (addx 2)
                             (addx 5)
                             (addx -31)
                             (addx 36)
                             (addx -2)
                             (addx -36)
                             (noop)
                             (noop)
                             (noop)
                             (addx 3)
                             (addx 5)
                             (addx 2)
                             (addx -7)
                             (addx 15)
                             (addx -5)
                             (addx 5)
                             (addx 2)
                             (addx 1)
                             (addx 4)
                             (noop)
                             (addx 3)
                             (noop)
                             (addx 2)
                             (addx -13)
                             (addx -16)
                             (addx 2)
                             (addx 35)
                             (addx -40)
                             (noop)
                             (noop)
                             (addx 7)
                             (noop)
                             (noop)
                             (noop)
                             (addx 5)
                             (noop)
                             (addx 5)
                             (addx 10)
                             (addx -10)
                             (noop)
                             (noop)
                             (noop)
                             (addx 3)
                             (noop)
                             (addx 16)
                             (addx -9)
                             (noop)
                             (noop)
                             (noop)
                             (addx 3)
                             (noop)
                             (addx 7)
                             (addx -32)
                             (addx 35)
                             (addx -38)
                             (addx 22)
                             (addx 10)
                             (addx -29)
                             (addx 2)
                             (noop)
                             (addx 3)
                             (addx 5)
                             (addx 2)
                             (addx 2)
                             (addx -12)
                             (addx 13)
                             (noop)
                             (noop)
                             (addx 7)
                             (addx 5)
                             (noop)
                             (noop)
                             (noop)
                             (addx 7)
                             (addx -6)
                             (addx 2)
                             (addx 5)
                             (addx -38)
                             (addx 1)
                             (noop)
                             (noop)
                             (addx 2)
                             (noop)
                             (addx 3)
                             (addx 5)
                             (noop)
                             (addx 4)
                             (addx -2)
                             (addx 5)
                             (addx 2)
                             (addx 1)
                             (noop)
                             (addx 4)
                             (addx 4)
                             (addx -14)
                             (addx 16)
                             (noop)
                             (addx -13)
                             (addx 18)
                             (addx -1)
                             (noop)
                             (noop)
                             (noop)))

#+END_SRC

#+RESULTS: 2022-day10-input
: aoc22/day10input

#+NAME: 2022-day10-solution
#+BEGIN_SRC emacs-lisp :session "day10" :val x=2022-day10-input
;;; Code:

(defun aoc22/day10-part1 (instructions)
  "Take a list of INSTRUCTIONS and compute signal stregth.
We have one register x, and two cpu commands.  noop take one
cycle and does nothing, while addx takes two cycles and at the
end of the second cycle, changes the value of the register x.  We
need to check the value of register every 20th cycle, and add it
up to find the final signal strength"
  (let ((programm (mapcar #'copy-sequence instructions))
        (regx 1)
        (preg nil)
        (signal-strength 0))
    (dolist (tick (number-sequence 0 220))
      (if (= (mod (+ tick 20) 40) 0)
          (cl-incf signal-strength (* tick regx)))
      (cond
       ((= tick 0) ;; reset value at start
        (setq preg (pop programm)))
       ((equal preg nil) ;; no more instructions?
        (princ (format "No more instructions\n")))
       ((equal (car preg) 'noop) ;; do nothing, just fetch next
        (setq preg (pop programm)))
       ((equal (car preg) 'addx) ;; fetched addx
        (setq preg (cdr preg)))
       ((numberp (car preg)) ;; the argument of addx
        (progn (cl-incf regx (car preg))
               (setq preg (pop programm))))
       ))
    signal-strength))

(defun aoc22/day10-part2 (instructions)
  "Take a list of INSTRUCTIONS and draws an image on the screen.
We keep the register adjustment from the previous function, but
add also functionality for the CRT.  Now we don't need to compute
the signal strength, but still we need the position of the
sprite, which is three pixels long and the x register gives us
the position of it's middle pixel.  The crt ray keeps going
forward until and if the sprite is in position is drawn (with a
hash #) or else it draws a point (.)."
  (with-current-buffer-window "*CRT Output*" nil nil
    (insert "\n")
    (let ((programm (mapcar #'copy-sequence instructions))
          (regx 1)
          (preg nil)
          (ray 0))
      (setq preg (pop programm))
      (dolist (tick (number-sequence 1 240))
        (let ((pixel-pos (list (1- regx) regx (1+ regx))))
          (if (member ray pixel-pos)
              (insert "#")
            (insert "."))
          (cl-incf ray)
          (if (= ray 40)
              (progn (setq ray 0)
                     (insert "\n"))))
        (cond
         ((equal preg nil) ;; no more instructions?
          (princ (format "No more instructions\n")))
         ((equal (car preg) 'noop) ;; do nothing, just fetch next
          (setq preg (pop programm)))
         ((equal (car preg) 'addx) ;; fetched addx
          (setq preg (cdr preg)))
         ((numberp (car preg)) ;; the argument of addx
          (progn (cl-incf regx (car preg))
                 (setq preg (pop programm)))))))
    (insert "\n")))

;;; Helper functions:

;;; Results vector

(vector (aoc22/day10-part1 aoc22/day10test)
        (aoc22/day10-part1 aoc22/day10input)
        (aoc22/day10-part2 aoc22/day10test)
        (aoc22/day10-part2 aoc22/day10input))
#+END_SRC

#+RESULTS: 2022-day10-solution
: [13140 11720 nil nil]
** day 11
#+NAME: 2022-day11-input
#+BEGIN_SRC emacs-lisp :session "day11"
(defconst aoc22/day11test '(((79 98)       (* old 19)  23 2 3 0)
                            ((54 65 75 74) (+ old 6)   19 2 0 0)
                            ((79 60 97)    (* old old) 13 1 3 0)
                            ((74)          (+ old 3)   17 0 1 0)))

(defconst aoc22/day11input '("TBD"))

#+END_SRC

#+RESULTS: 2022-day11-input
: aoc22/day11input

#+NAME: 2022-day11-solution
#+BEGIN_SRC emacs-lisp :session "day11" :val x=2022-day11-input
;;; Code:

(defun aoc22/day11-part1 (input)
  "Takes INPUT and solve the puzzle.
To be replaced with actual docstring."
  (let ((monkeys (mapcar #'copy-sequence input)))
    (dotimes (rounds 20)
      (dotimes (monkey (length monkeys))
        (let ((func (cadr (nth monkey monkeys)))
              (divisor (nth 2 (nth monkey monkeys)))
              (monkeyt (nth 3 (nth monkey monkeys)))
              (monkeyn (nth 4 (nth monkey monkeys)))
              (business (nth 5 (nth monkey monkeys)))
              (old nil))
          (setf (nth 5 (nth monkey monkeys))
                (+ business (length (car (nth monkey monkeys)))))
          (dolist (item (car (nth monkey monkeys)))
            (setq old item)
            (setq item (/ (eval func) 3))
            (if (= (mod item divisor) 0)
                (setf (car (nth monkeyt monkeys))
                      (append (car (nth monkeyt monkeys)) (list item)))
              (setf (car (nth monkeyn monkeys))
                    (append (car (nth monkeyn monkeys)) (list item))))
            )
          (setf (car (nth monkey monkeys)) '()))))
    monkeys))


(defun aoc22/day11-part2 (input)
  "Takes INPUT and solve the puzzle.
To be replaced with actual docstring."
  (car input))

;;; Helper functions:

;;; Results vector

(vector (aoc22/day11-part1 aoc22/day11test)
        (aoc22/day11-part1 aoc22/day11input)
        (aoc22/day11-part2 aoc22/day11test)
        (aoc22/day11-part2 aoc22/day11input))
#+END_SRC

#+RESULTS: 2022-day11-solution
: ["TBD" "TBD" "TBD" "TBD"]
